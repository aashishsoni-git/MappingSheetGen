2025-10-05 03:16:27 - utils.logging_config - INFO - Logging configured at INFO level
2025-10-05 03:16:30 - loaders.snowflake_loader - INFO - ‚úÖ Connected to Snowflake: INSURANCE.ETL_MAPPER with role ACCOUNTADMIN
2025-10-05 03:16:30 - utils.decorators - INFO - Starting run...
2025-10-05 03:16:30 - main - INFO - üîç Auto-detecting product type...
2025-10-05 03:16:30 - utils.product_detector - INFO - ‚úÖ Detected product: HO003 with 67.3% confidence
2025-10-05 03:16:30 - main - INFO - ‚úÖ Detected: HO003 with 67.3% confidence
2025-10-05 03:16:30 - main - INFO - üìä Extracting XML metadata...
2025-10-05 03:16:30 - main - INFO - ‚úÖ Extracted 319 XML nodes
2025-10-05 03:16:30 - main - INFO - ‚òÅÔ∏è Loading to Snowflake stage layer...
2025-10-05 03:16:31 - loaders.snowflake_loader - INFO - ‚úÖ Loaded XML data to ETL_MAPPER.STAGE_XML_HO003
2025-10-05 03:16:31 - main - INFO - ‚úÖ Loaded to ETL_MAPPER.STAGE_XML_HO003
2025-10-05 03:16:31 - main - INFO - üóÑÔ∏è Fetching Silver layer schema from Snowflake...
2025-10-05 03:16:31 - utils.schema_manager - INFO - Fetching schema from INSURANCE.SILVER
2025-10-05 03:16:32 - utils.schema_manager - INFO - ‚úÖ Fetched 137 columns from 7 tables
2025-10-05 03:16:32 - main - INFO - ‚úÖ Fetched 137 columns from 7 tables
2025-10-05 03:16:32 - main - INFO - üìö Finding and loading reference data with AI...
2025-10-05 03:16:32 - utils.document_loader - INFO - üîç Found 9 potential reference files
2025-10-05 03:16:34 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-05 03:16:34 - utils.document_loader - INFO - üìÑ historical_mappings_personal_auto.xlsx: historical_mapping (relevance: 85%)
2025-10-05 03:16:35 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-05 03:16:35 - utils.document_loader - INFO - üìÑ historical_mappings_commercial.xlsx: historical_mapping (relevance: 85%)
2025-10-05 03:16:36 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-05 03:16:36 - utils.document_loader - INFO - üìÑ old_mappings.csv: historical_mapping (relevance: 85%)
2025-10-05 03:16:37 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-05 03:16:37 - utils.document_loader - INFO - üìÑ historical_mappings_homeowners.xlsx: historical_mapping (relevance: 85%)
2025-10-05 03:16:39 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-05 03:16:39 - utils.document_loader - INFO - üìÑ old_mappings_homeowners.csv: historical_mapping (relevance: 85%)
2025-10-05 03:16:41 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-05 03:16:41 - utils.document_loader - INFO - üìÑ old_mappings_personal_auto.csv: historical_mapping (relevance: 85%)
2025-10-05 03:16:42 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-05 03:16:42 - utils.document_loader - INFO - üìÑ old_mappings_commercial.csv: historical_mapping (relevance: 85%)
2025-10-05 03:16:43 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-05 03:16:43 - utils.document_loader - INFO - üìÑ data_dictionary.csv: data_dictionary (relevance: 90%)
2025-10-05 03:16:45 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-05 03:16:45 - utils.document_loader - INFO - üìÑ data_dictionary_complete.xlsx: data_dictionary (relevance: 85%)
2025-10-05 03:16:45 - utils.document_loader - INFO - Loading file: reference_data/data_dictionary.csv (type: .csv)
2025-10-05 03:16:47 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-05 03:16:47 - utils.document_loader - ERROR - Error loading reference_data/data_dictionary.csv: name 'true' is not defined
2025-10-05 03:16:47 - utils.document_loader - INFO - Loading file: reference_data/historical_mappings_personal_auto.xlsx (type: .xlsx)
2025-10-05 03:16:47 - utils.document_loader - INFO - Found 2 sheets: ['Mappings', 'Metadata']
2025-10-05 03:16:50 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-05 03:16:50 - utils.document_loader - INFO - AI understands this as: historical_mappings
2025-10-05 03:16:50 - utils.document_loader - INFO - Loading file: reference_data/historical_mappings_commercial.xlsx (type: .xlsx)
2025-10-05 03:16:50 - utils.document_loader - INFO - Found 1 sheets: ['Mappings']
2025-10-05 03:16:53 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-05 03:16:53 - utils.document_loader - INFO - AI understands this as: historical_mappings
2025-10-05 03:16:53 - utils.document_loader - INFO - Loading file: reference_data/old_mappings.csv (type: .csv)
2025-10-05 03:16:54 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-05 03:16:54 - utils.document_loader - ERROR - Error loading reference_data/old_mappings.csv: name 'true' is not defined
2025-10-05 03:16:54 - utils.document_loader - INFO - Loading file: reference_data/historical_mappings_homeowners.xlsx (type: .xlsx)
2025-10-05 03:16:54 - utils.document_loader - INFO - Found 1 sheets: ['Mappings']
2025-10-05 03:16:56 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-05 03:16:56 - utils.document_loader - INFO - AI understands this as: historical_mappings
2025-10-05 03:16:56 - utils.document_loader - INFO - Loading file: reference_data/data_dictionary_complete.xlsx (type: .xlsx)
2025-10-05 03:16:57 - utils.document_loader - INFO - Found 3 sheets: ['DataDictionary', 'TableSummary', 'Metadata']
2025-10-05 03:16:59 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-05 03:16:59 - utils.document_loader - INFO - AI understands this as: data_dictionary
2025-10-05 03:16:59 - utils.document_loader - INFO - 
============================================================
2025-10-05 03:16:59 - utils.document_loader - INFO - ‚úÖ LOADED REFERENCE DATA SUMMARY:
2025-10-05 03:16:59 - utils.document_loader - INFO - ============================================================
2025-10-05 03:16:59 - utils.document_loader - INFO -   üìö Historical mappings: 3 files
2025-10-05 03:16:59 - utils.document_loader - INFO -      - historical_mappings_personal_auto.xlsx (51 rows)
2025-10-05 03:16:59 - utils.document_loader - INFO -      - historical_mappings_commercial.xlsx (9 rows)
2025-10-05 03:16:59 - utils.document_loader - INFO -      - historical_mappings_homeowners.xlsx (14 rows)
2025-10-05 03:16:59 - utils.document_loader - INFO -   üìñ Data dictionaries: 1 files
2025-10-05 03:16:59 - utils.document_loader - INFO -      - data_dictionary_complete.xlsx (104 rows)
2025-10-05 03:16:59 - utils.document_loader - INFO -   üóÑÔ∏è Schema definitions: 0 files
2025-10-05 03:16:59 - utils.document_loader - INFO -   üìä Reference data: 0 files
2025-10-05 03:16:59 - utils.document_loader - INFO - ============================================================

2025-10-05 03:16:59 - main - INFO - ü§ñ Predicting mappings with AI (flexible mode)...
2025-10-05 03:16:59 - utils.decorators - INFO - Starting wrapper...
2025-10-05 03:16:59 - utils.validators - INFO - XML metadata validation passed: 319 nodes
2025-10-05 03:16:59 - mapper.openai_mapper - INFO - ü§ñ Generating mappings with flexible reference data...
2025-10-05 03:16:59 - mapper.openai_mapper - INFO -    XML nodes: 319
2025-10-05 03:16:59 - mapper.openai_mapper - INFO -    Silver columns: 137
2025-10-05 03:16:59 - mapper.openai_mapper - INFO - üí∞ Estimated tokens: ~7,300
2025-10-05 03:17:28 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-05 03:17:28 - mapper.openai_mapper - INFO - ‚úÖ Actual cost: $0.0256
2025-10-05 03:17:28 - mapper.openai_mapper - INFO - üìä Cumulative cost: $0.0256
2025-10-05 03:17:28 - mapper.openai_mapper - INFO - ‚úÖ Generated 17 mappings
2025-10-05 03:17:28 - utils.decorators - INFO - wrapper completed in 28.88s
2025-10-05 03:17:28 - main - INFO - üíæ Saving results...
2025-10-05 03:17:28 - main - INFO - üìÅ Saved 17 mappings to output/mappings_HO003_20251005_031728.csv
2025-10-05 03:17:28 - main - INFO - ‚úÖ Pipeline completed successfully!
2025-10-05 03:17:28 - utils.decorators - INFO - run completed in 58.02s
2025-10-05 04:09:15 - utils.logging_config - INFO - Logging configured at INFO level
2025-10-05 04:09:18 - loaders.snowflake_loader - INFO - ‚úÖ Connected to Snowflake: INSURANCE.ETL_MAPPER with role ACCOUNTADMIN
2025-10-05 04:09:47 - loaders.snowflake_loader - INFO - ‚úÖ Connected to Snowflake: INSURANCE.ETL_MAPPER with role ACCOUNTADMIN
2025-10-05 04:09:47 - utils.decorators - INFO - Starting run...
2025-10-05 04:09:47 - main - INFO - üîç Auto-detecting product type...
2025-10-05 04:09:47 - utils.product_detector - INFO - ‚úÖ Detected product: CP001 with 36.8% confidence
2025-10-05 04:09:47 - main - INFO - ‚úÖ Detected: CP001 with 36.8% confidence
2025-10-05 04:09:47 - main - INFO - üìä Extracting XML metadata...
2025-10-05 04:09:47 - main - INFO - ‚úÖ Extracted 331 XML nodes
2025-10-05 04:09:47 - main - INFO - ‚òÅÔ∏è Loading to Snowflake stage layer...
2025-10-05 04:09:49 - loaders.snowflake_loader - INFO - ‚úÖ Loaded XML data to ETL_MAPPER.STAGE_XML_CP001
2025-10-05 04:09:49 - main - INFO - ‚úÖ Loaded to ETL_MAPPER.STAGE_XML_CP001
2025-10-05 04:09:49 - main - INFO - üóÑÔ∏è Fetching Silver layer schema from Snowflake...
2025-10-05 04:09:49 - utils.schema_manager - INFO - Fetching schema from INSURANCE.SILVER
2025-10-05 04:09:50 - utils.schema_manager - INFO - ‚úÖ Fetched 137 columns from 7 tables
2025-10-05 04:09:50 - main - INFO - ‚úÖ Fetched 137 columns from 7 tables
2025-10-05 04:09:50 - main - INFO - üìö Finding and loading reference data with AI...
2025-10-05 04:09:50 - utils.document_loader - INFO - üîç Found 9 potential reference files
2025-10-05 04:09:52 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-05 04:09:52 - utils.document_loader - INFO - üìÑ historical_mappings_personal_auto.xlsx: historical_mapping (relevance: 85%)
2025-10-05 04:09:54 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-05 04:09:54 - utils.document_loader - INFO - üìÑ historical_mappings_commercial.xlsx: historical_mapping (relevance: 85%)
2025-10-05 04:09:55 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-05 04:09:55 - utils.document_loader - INFO - üìÑ old_mappings.csv: historical_mapping (relevance: 85%)
2025-10-05 04:09:57 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-05 04:09:57 - utils.document_loader - INFO - üìÑ historical_mappings_homeowners.xlsx: historical_mapping (relevance: 85%)
2025-10-05 04:09:59 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-05 04:09:59 - utils.document_loader - INFO - üìÑ old_mappings_homeowners.csv: historical_mapping (relevance: 85%)
2025-10-05 04:10:00 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-05 04:10:00 - utils.document_loader - INFO - üìÑ old_mappings_personal_auto.csv: historical_mapping (relevance: 85%)
2025-10-05 04:10:03 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-05 04:10:03 - utils.document_loader - INFO - üìÑ old_mappings_commercial.csv: historical_mapping (relevance: 85%)
2025-10-05 04:10:04 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-05 04:10:04 - utils.document_loader - INFO - üìÑ data_dictionary.csv: data_dictionary (relevance: 90%)
2025-10-05 04:10:06 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-05 04:10:06 - utils.document_loader - INFO - üìÑ data_dictionary_complete.xlsx: data_dictionary (relevance: 90%)
2025-10-05 04:10:06 - utils.document_loader - INFO - Loading file: reference_data/data_dictionary.csv (type: .csv)
2025-10-05 04:10:07 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-05 04:10:07 - utils.document_loader - ERROR - Error loading reference_data/data_dictionary.csv: name 'true' is not defined
2025-10-05 04:10:07 - utils.document_loader - INFO - Loading file: reference_data/data_dictionary_complete.xlsx (type: .xlsx)
2025-10-05 04:10:07 - utils.document_loader - INFO - Found 3 sheets: ['DataDictionary', 'TableSummary', 'Metadata']
2025-10-05 04:10:09 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-05 04:10:09 - utils.document_loader - INFO - AI understands this as: data_dictionary
2025-10-05 04:10:09 - utils.document_loader - INFO - Loading file: reference_data/historical_mappings_personal_auto.xlsx (type: .xlsx)
2025-10-05 04:10:09 - utils.document_loader - INFO - Found 2 sheets: ['Mappings', 'Metadata']
2025-10-05 04:10:11 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-05 04:10:11 - utils.document_loader - INFO - AI understands this as: historical_mappings
2025-10-05 04:10:11 - utils.document_loader - INFO - Loading file: reference_data/historical_mappings_commercial.xlsx (type: .xlsx)
2025-10-05 04:10:11 - utils.document_loader - INFO - Found 1 sheets: ['Mappings']
2025-10-05 04:10:13 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-05 04:10:13 - utils.document_loader - INFO - AI understands this as: historical_mappings
2025-10-05 04:10:13 - utils.document_loader - INFO - Loading file: reference_data/old_mappings.csv (type: .csv)
2025-10-05 04:10:15 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-05 04:10:15 - utils.document_loader - ERROR - Error loading reference_data/old_mappings.csv: name 'true' is not defined
2025-10-05 04:10:15 - utils.document_loader - INFO - Loading file: reference_data/historical_mappings_homeowners.xlsx (type: .xlsx)
2025-10-05 04:10:15 - utils.document_loader - INFO - Found 1 sheets: ['Mappings']
2025-10-05 04:10:17 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-05 04:10:17 - utils.document_loader - INFO - AI understands this as: historical_mappings
2025-10-05 04:10:17 - utils.document_loader - INFO - 
============================================================
2025-10-05 04:10:17 - utils.document_loader - INFO - ‚úÖ LOADED REFERENCE DATA SUMMARY:
2025-10-05 04:10:17 - utils.document_loader - INFO - ============================================================
2025-10-05 04:10:17 - utils.document_loader - INFO -   üìö Historical mappings: 3 files
2025-10-05 04:10:17 - utils.document_loader - INFO -      - historical_mappings_personal_auto.xlsx (51 rows)
2025-10-05 04:10:17 - utils.document_loader - INFO -      - historical_mappings_commercial.xlsx (9 rows)
2025-10-05 04:10:17 - utils.document_loader - INFO -      - historical_mappings_homeowners.xlsx (14 rows)
2025-10-05 04:10:17 - utils.document_loader - INFO -   üìñ Data dictionaries: 1 files
2025-10-05 04:10:17 - utils.document_loader - INFO -      - data_dictionary_complete.xlsx (104 rows)
2025-10-05 04:10:17 - utils.document_loader - INFO -   üóÑÔ∏è Schema definitions: 0 files
2025-10-05 04:10:17 - utils.document_loader - INFO -   üìä Reference data: 0 files
2025-10-05 04:10:17 - utils.document_loader - INFO - ============================================================

2025-10-05 04:10:17 - main - INFO - ü§ñ Predicting mappings with AI (flexible mode)...
2025-10-05 04:10:17 - utils.decorators - INFO - Starting wrapper...
2025-10-05 04:10:17 - utils.validators - INFO - XML metadata validation passed: 331 nodes
2025-10-05 04:10:17 - mapper.openai_mapper - INFO - ü§ñ Generating mappings with flexible reference data...
2025-10-05 04:10:17 - mapper.openai_mapper - INFO -    XML nodes: 331
2025-10-05 04:10:17 - mapper.openai_mapper - INFO -    Silver columns: 137
2025-10-05 04:10:17 - mapper.openai_mapper - INFO - üí∞ Estimated tokens: ~7,746
2025-10-05 04:10:36 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-05 04:10:36 - mapper.openai_mapper - INFO - ‚úÖ Actual cost: $0.0226
2025-10-05 04:10:36 - mapper.openai_mapper - INFO - üìä Cumulative cost: $0.0226
2025-10-05 04:10:36 - mapper.openai_mapper - INFO - ‚úÖ Generated 12 mappings
2025-10-05 04:10:36 - utils.decorators - INFO - wrapper completed in 18.74s
2025-10-05 04:10:36 - main - INFO - üíæ Saving results...
2025-10-05 04:10:36 - main - INFO - üìÅ Saved 12 mappings to output/mappings_CP001_20251005_041036.csv
2025-10-05 04:10:36 - main - INFO - ‚úÖ Pipeline completed successfully!
2025-10-05 04:10:36 - utils.decorators - INFO - run completed in 49.28s
2025-10-05 04:10:39 - utils.database_helper - ERROR - Failed to save XML: 002014 (22000): SQL compilation error:
Invalid expression [PARSE_JSON('{"TransactionInfo": {"TransactionID": {"#text": "TXN-POL-20251005-003"}, "TransactionType": {"#text": "NewBusiness"}, "TransactionDate": {"#text": "2025-10-05T16:45:00"}, "TransactionStatus": {"#text": "Success"}, "SourceSystem": {"#text": "DuckCreek"}, "SourceVersion": {"#text": "7.5.2"}, "ProcessedBy": {"#text": "DCPOLICY_ENGINE"}}, "Data": {"PolicyData": {"ID": {"#text": "POL-CP-2025-00456"}, "Number": {"#text": "CP-2025-00456"}, "Version": {"#text": "1"}, "LineOfBusiness": {"#text": "Commercial Property"}, "StatusCode": {"#text": "Active"}, "StatusDescription": {"#text": "In Force"}, "ProductDetails": {"ProdCode": {"#text": "CP001"}, "ProdDescription": {"#text": "Commercial Property Insurance - Building and Contents"}, "ProdVersion": {"#text": "2024.5"}, "LOB": {"#text": "Commercial Lines"}, "Category": {"#text": "Property"}, "SubCategory": {"#text": "Building"}}, "PolicyDates": {"InceptionDate": {"#text": "2025-11-15"}, "TerminationDate": {"#text": "2026-11-15"}, "BindDate": {"#text": "2025-10-05"}, "QuoteDate": {"#text": "2025-10-01"}}, "TermLength": {"#text": "12"}, "TermLengthUnit": {"#text": "Months"}, "PremiumInfo": {"BasePremium": {"#text": "8500.00"}, "AnnualPremium": {"#text": "9250.00"}, "MinimumPremium": {"#text": "5000.00"}, "DepositPremium": {"#text": "2312.50"}, "TaxAmount": {"#text": "647.50"}, "SurchargeAmount": {"#text": "750.00"}, "DiscountAmount": {"#text": "0.00"}, "FeeAmount": {"#text": "100.00"}, "TotalPremium": {"#text": "9997.50"}, "CoveredAmount": {"#text": "2500000"}}, "UnderwritingInfo": {"Carrier": {"#text": "ABC Commercial Insurance"}, "UnderwritingCompany": {"#text": "ABC Commercial Underwriters LLC"}, "UnderwritingState": {"#text": "IL"}, "RiskTier": {"#text": "Preferred"}, "UnderwriterID": {"#text": "UW-COM-089"}, "UnderwriterName": {"#text": "Jennifer Lee"}, "UnderwriterAuthority": {"#text": "Senior"}, "InspectionRequired": {"#text": "true"}, "InspectionDate": {"#text": "2025-10-20"}}, "SalesChannel": {"ChannelName": {"#text": "Broker"}, "SubChannel": {"#text": "Commercial Broker"}, "Region": {"#text": "Midwest"}, "Territory": {"#text": "IL-COOK-COMM-001"}}}, "AccountData": {"AccountIdentifier": {"#text": "ACC-COMM-2025-789"}, "AccountNumber": {"#text": "COMM-789"}, "AccountName": {"#text": "TechStart Solutions LLC"}, "AccountType": {"#text": "Commercial"}, "AccountStatus": {"#text": "Active"}, "BusinessInfo": {"LegalName": {"#text": "TechStart Solutions LLC"}, "DBAName": {"#text": "TechStart"}, "BusinessType": {"#text": "Technology Services"}, "IndustryCode": {"#text": "NAICS-541512"}, "IndustryDescription": {"#text": "Computer Systems Design Services"}, "YearsInBusiness": {"#text": "5"}, "NumberOfEmployees": {"#text": "45"}, "AnnualRevenue": {"#text": "8500000"}, "FederalTaxID": {"#text": "**-***7890"}, "EntityType": {"#text": "LLC"}, "StateOfIncorporation": {"#text": "IL"}, "IncorporationDate": {"#text": "2020-03-15"}}, "PrimaryContact": {"ContactName": {"#text": "David Chen"}, "Title": {"#text": "CEO"}, "DateOfBirth": {"#text": "1978-11-10"}, "Email": {"#text": "dchen@techstart.com"}, "Phone": {"PhoneType": {"#text": "Business"}, "PhoneNumber": {"#text": "312-555-2000"}, "Extension": {"#text": "101"}}}, "BusinessAddress": {"AddressType": {"#text": "Principal"}, "AddressLine1": {"#text": "500 Technology Plaza"}, "AddressLine2": {"#text": "Suite 300"}, "City": {"#text": "Chicago"}, "State": {"#text": "IL"}, "ZipCode": {"#text": "60611"}, "County": {"#text": "Cook"}, "Country": {"#text": "USA"}}, "MailingAddress": {"IsSameAsBusiness": {"#text": "false"}, "AddressLine1": {"#text": "PO Box 12345"}, "City": {"#text": "Chicago"}, "State": {"#text": "IL"}, "ZipCode": {"#text": "60690"}}}, "BrokerData": {"BrokerID": {"#text": "BRK-COMM-050"}, "BrokerName": {"#text": "Jennifer Wilson"}, "BrokerType": {"#text": "Commercial Lines Broker"}, "BrokerageFirm": {"#text": "Wilson Commercial Insurance Brokers"}, "BrokerageCode": {"#text": "WCSB-IL-050"}, "BrokerEmail": {"#text": "jwilson@wilsonbrokers.com"}, "BrokerPhone": {"#text": "312-555-9000"}, "CommissionRate": {"#text": "12.0"}, "CommissionAmount": {"#text": "1199.70"}, "LicenseNumber": {"#text": "IL-BRK-11223344"}, "LicenseState": {"#text": "IL"}, "AppointedDate": {"#text": "2018-05-01"}}, "QuoteData": {"QuoteIdentifier": {"#text": "Q-CP-2025-00299"}, "QuoteNumber": {"#text": "QT-CP-00299"}, "QuoteDate": {"#text": "2025-10-01"}, "QuoteExpiryDate": {"#text": "2025-10-31"}, "ConversionDate": {"#text": "2025-10-05"}, "QuoteStatus": {"#text": "Bound"}}, "RiskData": {"RiskIdentifier": {"#text": "RSK-CP-001"}, "RiskSequence": {"#text": "1"}, "RiskClass": {"#text": "Building"}, "RiskSummary": {"#text": "Office Building - 5 Story Mixed Use"}, "LocationDetails": {"LocationNumber": {"#text": "001"}, "LocationName": {"#text": "TechStart HQ Building"}, "AddressLine1": {"#text": "500 Technology Plaza"}, "AddressLine2": {"#text": "Suite 300"}, "City": {"#text": "Chicago"}, "State": {"#text": "IL"}, "ZipCode": {"#text": "60611"}, "County": {"#text": "Cook"}, "Country": {"#text": "USA"}, "Latitude": {"#text": "41.8915"}, "Longitude": {"#text": "-87.6195"}, "FloodZone": {"#text": "X"}, "WindZone": {"#text": "Zone 2"}, "EarthquakeZone": {"#text": "Low"}, "TerrorismRiskZone": {"#text": "Tier 1"}}, "BuildingDetails": {"BuildingNumber": {"#text": "1"}, "BuildingType": {"#text": "Office"}, "ConstructionClass": {"#text": "1"}, "ConstructionType": {"#text": "Fire Resistive"}, "ConstructionMaterial": {"#text": "Steel and Concrete"}, "YearBuilt": {"#text": "2015"}, "YearRenovated": {"#text": "2022"}, "NumberOfStories": {"#text": "5"}, "TotalSquareFootage": {"#text": "50000"}, "OccupiedSquareFootage": {"#text": "45000"}, "VacantSquareFootage": {"#text": "5000"}, "RoofType": {"#text": "Built-Up"}, "RoofMaterial": {"#text": "Membrane"}, "RoofAge": {"#text": "3"}, "RoofCondition": {"#text": "Excellent"}, "ExteriorWalls": {"#text": "Curtain Wall Glass"}, "HasBasement": {"#text": "true"}, "BasementLevels": {"#text": "1"}, "ElevatorCount": {"#text": "2"}, "ParkingType": {"#text": "Underground Garage"}, "ParkingSpaces": {"#text": "100"}}, "OccupancyInfo": {"PrimaryOccupancy": {"#text": "Office - Professional"}, "OccupancyCode": {"#text": "OCC-431"}, "SecondaryOccupancy": {"#text": "Retail - Ground Floor"}, "TenantCount": {"#text": "8"}, "OwnerOccupiedPercent": {"#text": "60"}, "HasRestaurant": {"#text": "true"}, "HasRetail": {"#text": "true"}, "HasResidential": {"#text": "false"}, "HasHazardousMaterials": {"#text": "false"}, "AverageOccupancyHours": {"#text": "0800-1800"}, "WeekendOccupancy": {"#text": "Limited"}}, "ValuationInfo": {"BuildingValue": {"#text": "2000000"}, "ContentsValue": {"#text": "500000"}, "BusinessPersonalProperty": {"#text": "500000"}, "TenantImprovements": {"#text": "250000"}, "LandValue": {"#text": "800000"}, "TotalInsurableValue": {"#text": "2500000"}, "ReplacementCost": {"#text": "2200000"}, "ActualCashValue": {"#text": "1800000"}, "AppraisalDate": {"#text": "2025-09-15"}, "AppraisalCompany": {"#text": "ABC Appraisals Inc"}}, "ProtectionInfo": {"FireProtectionClass": {"#text": "3"}, "FireHydrantDistance": {"#text": "200"}, "FireStationDistance": {"#text": "1.5"}, "HasSprinklerSystem": {"#text": "true"}, "SprinklerType": {"#text": "Wet Pipe"}, "SprinklerCoverage": {"#text": "100"}, "HasFireAlarm": {"#text": "true"}, "FireAlarmType": {"#text": "Central Station"}, "HasBurglarAlarm": {"#text": "true"}, "BurglarAlarmType": {"#text": "Central Station"}, "HasSecurityGuard": {"#text": "true"}, "SecurityGuardHours": {"#text": "24/7"}, "HasCCTV": {"#text": "true"}, "HasAccessControl": {"#text": "true"}, "MonitoringCompany": {"#text": "SecureCom Commercial"}}, "MechanicalSystems": {"HVACType": {"#text": "Central"}, "HVACAge": {"#text": "3"}, "HeatingType": {"#text": "Gas"}, "CoolingType": {"#text": "Electric"}, "ElectricalCapacity": {"#text": "2000"}, "HasBackupGenerator": {"#text": "true"}, "GeneratorCapacity": {"#text": "500"}, "PlumbingType": {"#text": "Copper"}, "WaterHeaterType": {"#text": "Commercial Gas"}, "WaterHeaterAge": {"#text": "3"}}, "MortgageInfo": {"IsMortgaged": {"#text": "true"}, "MortgageHolder": {"#text": "First Commercial Bank"}, "LoanNumber": {"#text": "COMM-MTG-9876543"}, "OutstandingBalance": {"#text": "1500000"}, "LoanToValue": {"#text": "60"}, "MortgageAddress": {"AddressLine1": {"#text": "1000 Banking Center"}, "City": {"#text": "Chicago"}, "State": {"#text": "IL"}, "ZipCode": {"#text": "60603"}}}, "LossHistory": {"HasPriorLosses": {"#text": "true"}, "Loss": {"LossDate": {"#text": "2023-12-10"}, "LossType": {"#text": "Water Damage"}, "LossCause": {"#text": "Pipe Burst"}, "LossAmount": {"#text": "45000"}, "LossDescription": {"#text": "Frozen pipe burst on 3rd floor"}, "ClaimNumber": {"#text": "CLM-2023-98765"}, "ClaimStatus": {"#text": "Closed"}, "ClaimPaid": {"#text": "42000"}}}, "ComplianceInfo": {"BuildingCodeCompliant": {"#text": "true"}, "FireCodeCompliant": {"#text": "true"}, "ADACompliant": {"#text": "true"}, "EnvironmentalCompliant": {"#text": "true"}, "LastInspectionDate": {"#text": "2025-08-15"}, "InspectionAgency": {"#text": "City of Chicago Building Department"}, "ViolationsOutstanding": {"#text": "0"}}}, "CoverageData": {"CoverageRecord": [{"CoverageIdentifier": {"#text": "COV-CP-001"}, "RiskIdentifier": {"#text": "RSK-CP-001"}, "CoverageSymbol": {"#text": "BLD"}, "CoverageDescription": {"#text": "Building Coverage"}, "CoverageClass": {"#text": "Property"}, "MaxLimit": {"#text": "2000000"}, "CoverageDeductible": {"#text": "10000"}, "CoverageBasis": {"#text": "Replacement Cost"}, "CoinsurancePercent": {"#text": "90"}, "CoveragePremium": {"#text": "5200.00"}, "CoverageStartDate": {"#text": "2025-11-15"}, "CoverageEndDate": {"#text": "2026-11-15"}, "PerilsCovered": {"#text": "All Risk"}, "IsMandatory": {"#text": "true"}}, {"CoverageIdentifier": {"#text": "COV-CP-002"}, "RiskIdentifier": {"#text": "RSK-CP-001"}, "CoverageSymbol": {"#text": "BPP"}, "CoverageDescription": {"#text": "Business Personal Property"}, "CoverageClass": {"#text": "Property"}, "MaxLimit": {"#text": "500000"}, "CoverageDeductible": {"#text": "5000"}, "CoverageBasis": {"#text": "Replacement Cost"}, "CoinsurancePercent": {"#text": "90"}, "CoveragePremium": {"#text": "1800.00"}, "CoverageStartDate": {"#text": "2025-11-15"}, "CoverageEndDate": {"#text": "2026-11-15"}, "PerilsCovered": {"#text": "All Risk"}, "IsMandatory": {"#text": "true"}}, {"CoverageIdentifier": {"#text": "COV-CP-003"}, "RiskIdentifier": {"#text": "RSK-CP-001"}, "CoverageSymbol": {"#text": "BI"}, "CoverageDescription": {"#text": "Business Interruption"}, "CoverageClass": {"#text": "Income"}, "MaxLimit": {"#text": "1000000"}, "CoverageDeductible": {"#text": "72"}, "DeductibleUnit": {"#text": "Hours"}, "IndemnityPeriod": {"#text": "12"}, "IndemnityPeriodUnit": {"#text": "Months"}, "CoveragePremium": {"#text": "1250.00"}, "CoverageStartDate": {"#text": "2025-11-15"}, "CoverageEndDate": {"#text": "2026-11-15"}, "IsMandatory": {"#text": "false"}}, {"CoverageIdentifier": {"#text": "COV-CP-004"}, "RiskIdentifier": {"#text": "RSK-CP-001"}, "CoverageSymbol": {"#text": "EQ"}, "CoverageDescription": {"#text": "Equipment Breakdown"}, "CoverageClass": {"#text": "Property"}, "MaxLimit": {"#text": "250000"}, "CoverageDeductible": {"#text": "2500"}, "CoveragePremium": {"#text": "500.00"}, "CoverageStartDate": {"#text": "2025-11-15"}, "CoverageEndDate": {"#text": "2026-11-15"}, "CoveredEquipment": {"#text": "HVAC, Elevators, Electrical"}, "IsMandatory": {"#text": "false"}}]}, "PaymentData": {"PaymentIdentifier": {"#text": "PAY-CP-001"}, "PaymentNumber": {"#text": "PAY-CP-001-001"}, "TransactionType": {"#text": "New Business Deposit"}, "PaymentMode": {"#text": "Wire Transfer"}, "StatusDescription": {"#text": "Pending"}, "ScheduledDate": {"#text": "2025-11-15"}, "TransactionAmount": {"#text": "2312.50"}, "BillingPlan": {"#text": "Quarterly"}, "TotalInstallments": {"#text": "4"}, "InstallmentAmount": {"#text": "2499.38"}, "PaymentAccountInfo": {"NameOnAccount": {"#text": "TechStart Solutions LLC"}, "FinancialInstitution": {"#text": "First Commercial Bank"}, "AccountNumber": {"#text": "****9876"}, "RoutingNumber": {"#text": "987654321"}, "AccountType": {"#text": "Business Checking"}}}, "SystemData": {"EnteredBy": {"#text": "jwilson"}, "EntryTimestamp": {"#text": "2025-10-05T16:45:00"}, "UpdatedBy": {"#text": "underwriter.system"}, "UpdateTimestamp": {"#text": "2025-10-05T17:30:00"}, "IssuedBy": {"#text": "policy.system"}, "IssuedTimestamp": {"#text": "2025-10-05T17:35:00"}, "WorkflowStatus": {"#text": "Issued"}, "ApprovalRequired": {"#text": "true"}, "ApprovalStatus": {"#text": "Approved"}, "ApprovedBy": {"#text": "UW-COM-089"}, "ApprovedDate": {"#text": "2025-10-05T17:00:00"}}}}')] in VALUES clause
2025-10-05 04:14:01 - utils.logging_config - INFO - Logging configured at INFO level
2025-10-05 04:14:04 - loaders.snowflake_loader - INFO - ‚úÖ Connected to Snowflake: INSURANCE.ETL_MAPPER with role ACCOUNTADMIN
2025-10-05 04:14:11 - loaders.snowflake_loader - INFO - ‚úÖ Connected to Snowflake: INSURANCE.ETL_MAPPER with role ACCOUNTADMIN
2025-10-05 04:14:11 - utils.decorators - INFO - Starting run...
2025-10-05 04:14:11 - main - INFO - üîç Auto-detecting product type...
2025-10-05 04:14:11 - utils.product_detector - INFO - ‚úÖ Detected product: CP001 with 36.8% confidence
2025-10-05 04:14:11 - main - INFO - ‚úÖ Detected: CP001 with 36.8% confidence
2025-10-05 04:14:11 - main - INFO - üìä Extracting XML metadata...
2025-10-05 04:14:11 - main - INFO - ‚úÖ Extracted 331 XML nodes
2025-10-05 04:14:11 - main - INFO - ‚òÅÔ∏è Loading to Snowflake stage layer...
2025-10-05 04:14:12 - loaders.snowflake_loader - INFO - ‚úÖ Loaded XML data to ETL_MAPPER.STAGE_XML_CP001
2025-10-05 04:14:12 - main - INFO - ‚úÖ Loaded to ETL_MAPPER.STAGE_XML_CP001
2025-10-05 04:14:12 - main - INFO - üóÑÔ∏è Fetching Silver layer schema from Snowflake...
2025-10-05 04:14:12 - utils.schema_manager - INFO - Fetching schema from INSURANCE.SILVER
2025-10-05 04:14:13 - utils.schema_manager - INFO - ‚úÖ Fetched 137 columns from 7 tables
2025-10-05 04:14:13 - main - INFO - ‚úÖ Fetched 137 columns from 7 tables
2025-10-05 04:14:13 - main - INFO - üìö Finding and loading reference data with AI...
2025-10-05 04:14:13 - utils.document_loader - INFO - üîç Found 9 potential reference files
2025-10-05 04:14:15 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-05 04:14:15 - utils.document_loader - INFO - üìÑ historical_mappings_personal_auto.xlsx: historical_mapping (relevance: 85%)
2025-10-05 04:14:16 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-05 04:14:16 - utils.document_loader - INFO - üìÑ historical_mappings_commercial.xlsx: historical_mapping (relevance: 85%)
2025-10-05 04:14:17 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-05 04:14:17 - utils.document_loader - INFO - üìÑ old_mappings.csv: historical_mapping (relevance: 85%)
2025-10-05 04:14:18 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-05 04:14:18 - utils.document_loader - INFO - üìÑ historical_mappings_homeowners.xlsx: historical_mapping (relevance: 85%)
2025-10-05 04:14:20 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-05 04:14:20 - utils.document_loader - INFO - üìÑ old_mappings_homeowners.csv: historical_mapping (relevance: 85%)
2025-10-05 04:14:21 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-05 04:14:21 - utils.document_loader - INFO - üìÑ old_mappings_personal_auto.csv: historical_mapping (relevance: 85%)
2025-10-05 04:14:22 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-05 04:14:22 - utils.document_loader - INFO - üìÑ old_mappings_commercial.csv: historical_mapping (relevance: 85%)
2025-10-05 04:14:23 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-05 04:14:23 - utils.document_loader - INFO - üìÑ data_dictionary.csv: data_dictionary (relevance: 90%)
2025-10-05 04:14:24 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-05 04:14:24 - utils.document_loader - INFO - üìÑ data_dictionary_complete.xlsx: data_dictionary (relevance: 90%)
2025-10-05 04:14:24 - utils.document_loader - INFO - Loading file: reference_data/data_dictionary.csv (type: .csv)
2025-10-05 04:14:26 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-05 04:14:26 - utils.document_loader - ERROR - Error loading reference_data/data_dictionary.csv: name 'true' is not defined
2025-10-05 04:14:26 - utils.document_loader - INFO - Loading file: reference_data/data_dictionary_complete.xlsx (type: .xlsx)
2025-10-05 04:14:26 - utils.document_loader - INFO - Found 3 sheets: ['DataDictionary', 'TableSummary', 'Metadata']
2025-10-05 04:14:29 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-05 04:14:29 - utils.document_loader - INFO - AI understands this as: data_dictionary
2025-10-05 04:14:29 - utils.document_loader - INFO - Loading file: reference_data/historical_mappings_personal_auto.xlsx (type: .xlsx)
2025-10-05 04:14:29 - utils.document_loader - INFO - Found 2 sheets: ['Mappings', 'Metadata']
2025-10-05 04:14:31 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-05 04:14:31 - utils.document_loader - INFO - AI understands this as: historical_mappings
2025-10-05 04:14:31 - utils.document_loader - INFO - Loading file: reference_data/historical_mappings_commercial.xlsx (type: .xlsx)
2025-10-05 04:14:31 - utils.document_loader - INFO - Found 1 sheets: ['Mappings']
2025-10-05 04:14:34 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-05 04:14:34 - utils.document_loader - INFO - AI understands this as: historical_mappings
2025-10-05 04:14:34 - utils.document_loader - INFO - Loading file: reference_data/old_mappings.csv (type: .csv)
2025-10-05 04:14:35 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-05 04:14:35 - utils.document_loader - ERROR - Error loading reference_data/old_mappings.csv: name 'true' is not defined
2025-10-05 04:14:35 - utils.document_loader - INFO - Loading file: reference_data/historical_mappings_homeowners.xlsx (type: .xlsx)
2025-10-05 04:14:35 - utils.document_loader - INFO - Found 1 sheets: ['Mappings']
2025-10-05 04:14:38 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-05 04:14:38 - utils.document_loader - INFO - AI understands this as: historical_mappings
2025-10-05 04:14:38 - utils.document_loader - INFO - 
============================================================
2025-10-05 04:14:38 - utils.document_loader - INFO - ‚úÖ LOADED REFERENCE DATA SUMMARY:
2025-10-05 04:14:38 - utils.document_loader - INFO - ============================================================
2025-10-05 04:14:38 - utils.document_loader - INFO -   üìö Historical mappings: 3 files
2025-10-05 04:14:38 - utils.document_loader - INFO -      - historical_mappings_personal_auto.xlsx (51 rows)
2025-10-05 04:14:38 - utils.document_loader - INFO -      - historical_mappings_commercial.xlsx (9 rows)
2025-10-05 04:14:38 - utils.document_loader - INFO -      - historical_mappings_homeowners.xlsx (14 rows)
2025-10-05 04:14:38 - utils.document_loader - INFO -   üìñ Data dictionaries: 1 files
2025-10-05 04:14:38 - utils.document_loader - INFO -      - data_dictionary_complete.xlsx (104 rows)
2025-10-05 04:14:38 - utils.document_loader - INFO -   üóÑÔ∏è Schema definitions: 0 files
2025-10-05 04:14:38 - utils.document_loader - INFO -   üìä Reference data: 0 files
2025-10-05 04:14:38 - utils.document_loader - INFO - ============================================================

2025-10-05 04:14:38 - main - INFO - ü§ñ Predicting mappings with AI (flexible mode)...
2025-10-05 04:14:38 - utils.decorators - INFO - Starting wrapper...
2025-10-05 04:14:38 - utils.validators - INFO - XML metadata validation passed: 331 nodes
2025-10-05 04:14:38 - mapper.openai_mapper - INFO - ü§ñ Generating mappings with flexible reference data...
2025-10-05 04:14:38 - mapper.openai_mapper - INFO -    XML nodes: 331
2025-10-05 04:14:38 - mapper.openai_mapper - INFO -    Silver columns: 137
2025-10-05 04:14:38 - mapper.openai_mapper - INFO - üí∞ Estimated tokens: ~7,746
2025-10-05 04:14:46 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-05 04:14:46 - mapper.openai_mapper - INFO - ‚úÖ Actual cost: $0.0237
2025-10-05 04:14:46 - mapper.openai_mapper - INFO - üìä Cumulative cost: $0.0237
2025-10-05 04:14:46 - mapper.openai_mapper - INFO - ‚úÖ Generated 13 mappings
2025-10-05 04:14:46 - utils.decorators - INFO - wrapper completed in 7.89s
2025-10-05 04:14:46 - main - INFO - üíæ Saving results...
2025-10-05 04:14:46 - main - INFO - üìÅ Saved 13 mappings to output/mappings_CP001_20251005_041446.csv
2025-10-05 04:14:46 - main - INFO - ‚úÖ Pipeline completed successfully!
2025-10-05 04:14:46 - utils.decorators - INFO - run completed in 34.67s
2025-10-05 04:14:48 - utils.database_helper - ERROR - Failed to save XML: not all arguments converted during string formatting
2025-10-05 04:16:19 - utils.logging_config - INFO - Logging configured at INFO level
2025-10-05 04:16:22 - loaders.snowflake_loader - INFO - ‚úÖ Connected to Snowflake: INSURANCE.ETL_MAPPER with role ACCOUNTADMIN
2025-10-05 04:16:25 - loaders.snowflake_loader - INFO - ‚úÖ Connected to Snowflake: INSURANCE.ETL_MAPPER with role ACCOUNTADMIN
2025-10-05 04:16:25 - utils.decorators - INFO - Starting run...
2025-10-05 04:16:25 - main - INFO - üîç Auto-detecting product type...
2025-10-05 04:16:25 - utils.product_detector - INFO - ‚úÖ Detected product: CP001 with 36.8% confidence
2025-10-05 04:16:25 - main - INFO - ‚úÖ Detected: CP001 with 36.8% confidence
2025-10-05 04:16:25 - main - INFO - üìä Extracting XML metadata...
2025-10-05 04:16:25 - main - INFO - ‚úÖ Extracted 331 XML nodes
2025-10-05 04:16:25 - main - INFO - ‚òÅÔ∏è Loading to Snowflake stage layer...
2025-10-05 04:16:26 - loaders.snowflake_loader - INFO - ‚úÖ Loaded XML data to ETL_MAPPER.STAGE_XML_CP001
2025-10-05 04:16:26 - main - INFO - ‚úÖ Loaded to ETL_MAPPER.STAGE_XML_CP001
2025-10-05 04:16:26 - main - INFO - üóÑÔ∏è Fetching Silver layer schema from Snowflake...
2025-10-05 04:16:26 - utils.schema_manager - INFO - Fetching schema from INSURANCE.SILVER
2025-10-05 04:16:28 - utils.schema_manager - INFO - ‚úÖ Fetched 137 columns from 7 tables
2025-10-05 04:16:28 - main - INFO - ‚úÖ Fetched 137 columns from 7 tables
2025-10-05 04:16:28 - main - INFO - üìö Finding and loading reference data with AI...
2025-10-05 04:16:28 - utils.document_loader - INFO - üîç Found 9 potential reference files
2025-10-05 04:16:29 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-05 04:16:29 - utils.document_loader - INFO - üìÑ historical_mappings_personal_auto.xlsx: historical_mapping (relevance: 85%)
2025-10-05 04:16:30 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-05 04:16:30 - utils.document_loader - INFO - üìÑ historical_mappings_commercial.xlsx: historical_mapping (relevance: 85%)
2025-10-05 04:16:32 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-05 04:16:32 - utils.document_loader - INFO - üìÑ old_mappings.csv: historical_mapping (relevance: 85%)
2025-10-05 04:16:33 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-05 04:16:33 - utils.document_loader - INFO - üìÑ historical_mappings_homeowners.xlsx: historical_mapping (relevance: 85%)
2025-10-05 04:16:34 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-05 04:16:34 - utils.document_loader - INFO - üìÑ old_mappings_homeowners.csv: historical_mapping (relevance: 85%)
2025-10-05 04:16:35 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-05 04:16:35 - utils.document_loader - INFO - üìÑ old_mappings_personal_auto.csv: historical_mapping (relevance: 85%)
2025-10-05 04:16:36 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-05 04:16:36 - utils.document_loader - INFO - üìÑ old_mappings_commercial.csv: historical_mapping (relevance: 85%)
2025-10-05 04:16:38 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-05 04:16:38 - utils.document_loader - INFO - üìÑ data_dictionary.csv: data_dictionary (relevance: 90%)
2025-10-05 04:16:39 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-05 04:16:39 - utils.document_loader - INFO - üìÑ data_dictionary_complete.xlsx: data_dictionary (relevance: 80%)
2025-10-05 04:16:39 - utils.document_loader - INFO - Loading file: reference_data/data_dictionary.csv (type: .csv)
2025-10-05 04:16:41 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-05 04:16:41 - utils.document_loader - ERROR - Error loading reference_data/data_dictionary.csv: name 'true' is not defined
2025-10-05 04:16:41 - utils.document_loader - INFO - Loading file: reference_data/historical_mappings_personal_auto.xlsx (type: .xlsx)
2025-10-05 04:16:41 - utils.document_loader - INFO - Found 2 sheets: ['Mappings', 'Metadata']
2025-10-05 04:16:43 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-05 04:16:43 - utils.document_loader - INFO - AI understands this as: historical_mappings
2025-10-05 04:16:43 - utils.document_loader - INFO - Loading file: reference_data/historical_mappings_commercial.xlsx (type: .xlsx)
2025-10-05 04:16:43 - utils.document_loader - INFO - Found 1 sheets: ['Mappings']
2025-10-05 04:16:45 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-05 04:16:45 - utils.document_loader - INFO - AI understands this as: historical_mappings
2025-10-05 04:16:45 - utils.document_loader - INFO - Loading file: reference_data/old_mappings.csv (type: .csv)
2025-10-05 04:16:46 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-05 04:16:46 - utils.document_loader - ERROR - Error loading reference_data/old_mappings.csv: name 'true' is not defined
2025-10-05 04:16:46 - utils.document_loader - INFO - Loading file: reference_data/historical_mappings_homeowners.xlsx (type: .xlsx)
2025-10-05 04:16:46 - utils.document_loader - INFO - Found 1 sheets: ['Mappings']
2025-10-05 04:16:49 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-05 04:16:49 - utils.document_loader - INFO - AI understands this as: historical_mappings
2025-10-05 04:16:49 - utils.document_loader - INFO - Loading file: reference_data/data_dictionary_complete.xlsx (type: .xlsx)
2025-10-05 04:16:49 - utils.document_loader - INFO - Found 3 sheets: ['DataDictionary', 'TableSummary', 'Metadata']
2025-10-05 04:16:51 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-05 04:16:51 - utils.document_loader - INFO - AI understands this as: data_dictionary
2025-10-05 04:16:51 - utils.document_loader - INFO - 
============================================================
2025-10-05 04:16:51 - utils.document_loader - INFO - ‚úÖ LOADED REFERENCE DATA SUMMARY:
2025-10-05 04:16:51 - utils.document_loader - INFO - ============================================================
2025-10-05 04:16:51 - utils.document_loader - INFO -   üìö Historical mappings: 3 files
2025-10-05 04:16:51 - utils.document_loader - INFO -      - historical_mappings_personal_auto.xlsx (51 rows)
2025-10-05 04:16:51 - utils.document_loader - INFO -      - historical_mappings_commercial.xlsx (9 rows)
2025-10-05 04:16:51 - utils.document_loader - INFO -      - historical_mappings_homeowners.xlsx (14 rows)
2025-10-05 04:16:51 - utils.document_loader - INFO -   üìñ Data dictionaries: 1 files
2025-10-05 04:16:51 - utils.document_loader - INFO -      - data_dictionary_complete.xlsx (104 rows)
2025-10-05 04:16:51 - utils.document_loader - INFO -   üóÑÔ∏è Schema definitions: 0 files
2025-10-05 04:16:51 - utils.document_loader - INFO -   üìä Reference data: 0 files
2025-10-05 04:16:51 - utils.document_loader - INFO - ============================================================

2025-10-05 04:16:51 - main - INFO - ü§ñ Predicting mappings with AI (flexible mode)...
2025-10-05 04:16:51 - utils.decorators - INFO - Starting wrapper...
2025-10-05 04:16:51 - utils.validators - INFO - XML metadata validation passed: 331 nodes
2025-10-05 04:16:51 - mapper.openai_mapper - INFO - ü§ñ Generating mappings with flexible reference data...
2025-10-05 04:16:51 - mapper.openai_mapper - INFO -    XML nodes: 331
2025-10-05 04:16:51 - mapper.openai_mapper - INFO -    Silver columns: 137
2025-10-05 04:16:51 - mapper.openai_mapper - INFO - üí∞ Estimated tokens: ~7,746
2025-10-05 04:16:57 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-05 04:16:57 - mapper.openai_mapper - INFO - ‚úÖ Actual cost: $0.0239
2025-10-05 04:16:57 - mapper.openai_mapper - INFO - üìä Cumulative cost: $0.0239
2025-10-05 04:16:57 - mapper.openai_mapper - INFO - ‚úÖ Generated 14 mappings
2025-10-05 04:16:57 - utils.decorators - INFO - wrapper completed in 6.39s
2025-10-05 04:16:57 - main - INFO - üíæ Saving results...
2025-10-05 04:16:57 - main - INFO - üìÅ Saved 14 mappings to output/mappings_CP001_20251005_041657.csv
2025-10-05 04:16:57 - main - INFO - ‚úÖ Pipeline completed successfully!
2025-10-05 04:16:57 - utils.decorators - INFO - run completed in 32.03s
2025-10-05 04:17:00 - utils.database_helper - ERROR - Failed to save XML: 002014 (22000): SQL compilation error:
Invalid expression [PARSE_JSON('{"TransactionInfo": {"TransactionID": {"#text": "TXN-POL-20251005-003"}, "TransactionType": {"#text": "NewBusiness"}, "TransactionDate": {"#text": "2025-10-05T16:45:00"}, "TransactionStatus": {"#text": "Success"}, "SourceSystem": {"#text": "DuckCreek"}, "SourceVersion": {"#text": "7.5.2"}, "ProcessedBy": {"#text": "DCPOLICY_ENGINE"}}, "Data": {"PolicyData": {"ID": {"#text": "POL-CP-2025-00456"}, "Number": {"#text": "CP-2025-00456"}, "Version": {"#text": "1"}, "LineOfBusiness": {"#text": "Commercial Property"}, "StatusCode": {"#text": "Active"}, "StatusDescription": {"#text": "In Force"}, "ProductDetails": {"ProdCode": {"#text": "CP001"}, "ProdDescription": {"#text": "Commercial Property Insurance - Building and Contents"}, "ProdVersion": {"#text": "2024.5"}, "LOB": {"#text": "Commercial Lines"}, "Category": {"#text": "Property"}, "SubCategory": {"#text": "Building"}}, "PolicyDates": {"InceptionDate": {"#text": "2025-11-15"}, "TerminationDate": {"#text": "2026-11-15"}, "BindDate": {"#text": "2025-10-05"}, "QuoteDate": {"#text": "2025-10-01"}}, "TermLength": {"#text": "12"}, "TermLengthUnit": {"#text": "Months"}, "PremiumInfo": {"BasePremium": {"#text": "8500.00"}, "AnnualPremium": {"#text": "9250.00"}, "MinimumPremium": {"#text": "5000.00"}, "DepositPremium": {"#text": "2312.50"}, "TaxAmount": {"#text": "647.50"}, "SurchargeAmount": {"#text": "750.00"}, "DiscountAmount": {"#text": "0.00"}, "FeeAmount": {"#text": "100.00"}, "TotalPremium": {"#text": "9997.50"}, "CoveredAmount": {"#text": "2500000"}}, "UnderwritingInfo": {"Carrier": {"#text": "ABC Commercial Insurance"}, "UnderwritingCompany": {"#text": "ABC Commercial Underwriters LLC"}, "UnderwritingState": {"#text": "IL"}, "RiskTier": {"#text": "Preferred"}, "UnderwriterID": {"#text": "UW-COM-089"}, "UnderwriterName": {"#text": "Jennifer Lee"}, "UnderwriterAuthority": {"#text": "Senior"}, "InspectionRequired": {"#text": "true"}, "InspectionDate": {"#text": "2025-10-20"}}, "SalesChannel": {"ChannelName": {"#text": "Broker"}, "SubChannel": {"#text": "Commercial Broker"}, "Region": {"#text": "Midwest"}, "Territory": {"#text": "IL-COOK-COMM-001"}}}, "AccountData": {"AccountIdentifier": {"#text": "ACC-COMM-2025-789"}, "AccountNumber": {"#text": "COMM-789"}, "AccountName": {"#text": "TechStart Solutions LLC"}, "AccountType": {"#text": "Commercial"}, "AccountStatus": {"#text": "Active"}, "BusinessInfo": {"LegalName": {"#text": "TechStart Solutions LLC"}, "DBAName": {"#text": "TechStart"}, "BusinessType": {"#text": "Technology Services"}, "IndustryCode": {"#text": "NAICS-541512"}, "IndustryDescription": {"#text": "Computer Systems Design Services"}, "YearsInBusiness": {"#text": "5"}, "NumberOfEmployees": {"#text": "45"}, "AnnualRevenue": {"#text": "8500000"}, "FederalTaxID": {"#text": "**-***7890"}, "EntityType": {"#text": "LLC"}, "StateOfIncorporation": {"#text": "IL"}, "IncorporationDate": {"#text": "2020-03-15"}}, "PrimaryContact": {"ContactName": {"#text": "David Chen"}, "Title": {"#text": "CEO"}, "DateOfBirth": {"#text": "1978-11-10"}, "Email": {"#text": "dchen@techstart.com"}, "Phone": {"PhoneType": {"#text": "Business"}, "PhoneNumber": {"#text": "312-555-2000"}, "Extension": {"#text": "101"}}}, "BusinessAddress": {"AddressType": {"#text": "Principal"}, "AddressLine1": {"#text": "500 Technology Plaza"}, "AddressLine2": {"#text": "Suite 300"}, "City": {"#text": "Chicago"}, "State": {"#text": "IL"}, "ZipCode": {"#text": "60611"}, "County": {"#text": "Cook"}, "Country": {"#text": "USA"}}, "MailingAddress": {"IsSameAsBusiness": {"#text": "false"}, "AddressLine1": {"#text": "PO Box 12345"}, "City": {"#text": "Chicago"}, "State": {"#text": "IL"}, "ZipCode": {"#text": "60690"}}}, "BrokerData": {"BrokerID": {"#text": "BRK-COMM-050"}, "BrokerName": {"#text": "Jennifer Wilson"}, "BrokerType": {"#text": "Commercial Lines Broker"}, "BrokerageFirm": {"#text": "Wilson Commercial Insurance Brokers"}, "BrokerageCode": {"#text": "WCSB-IL-050"}, "BrokerEmail": {"#text": "jwilson@wilsonbrokers.com"}, "BrokerPhone": {"#text": "312-555-9000"}, "CommissionRate": {"#text": "12.0"}, "CommissionAmount": {"#text": "1199.70"}, "LicenseNumber": {"#text": "IL-BRK-11223344"}, "LicenseState": {"#text": "IL"}, "AppointedDate": {"#text": "2018-05-01"}}, "QuoteData": {"QuoteIdentifier": {"#text": "Q-CP-2025-00299"}, "QuoteNumber": {"#text": "QT-CP-00299"}, "QuoteDate": {"#text": "2025-10-01"}, "QuoteExpiryDate": {"#text": "2025-10-31"}, "ConversionDate": {"#text": "2025-10-05"}, "QuoteStatus": {"#text": "Bound"}}, "RiskData": {"RiskIdentifier": {"#text": "RSK-CP-001"}, "RiskSequence": {"#text": "1"}, "RiskClass": {"#text": "Building"}, "RiskSummary": {"#text": "Office Building - 5 Story Mixed Use"}, "LocationDetails": {"LocationNumber": {"#text": "001"}, "LocationName": {"#text": "TechStart HQ Building"}, "AddressLine1": {"#text": "500 Technology Plaza"}, "AddressLine2": {"#text": "Suite 300"}, "City": {"#text": "Chicago"}, "State": {"#text": "IL"}, "ZipCode": {"#text": "60611"}, "County": {"#text": "Cook"}, "Country": {"#text": "USA"}, "Latitude": {"#text": "41.8915"}, "Longitude": {"#text": "-87.6195"}, "FloodZone": {"#text": "X"}, "WindZone": {"#text": "Zone 2"}, "EarthquakeZone": {"#text": "Low"}, "TerrorismRiskZone": {"#text": "Tier 1"}}, "BuildingDetails": {"BuildingNumber": {"#text": "1"}, "BuildingType": {"#text": "Office"}, "ConstructionClass": {"#text": "1"}, "ConstructionType": {"#text": "Fire Resistive"}, "ConstructionMaterial": {"#text": "Steel and Concrete"}, "YearBuilt": {"#text": "2015"}, "YearRenovated": {"#text": "2022"}, "NumberOfStories": {"#text": "5"}, "TotalSquareFootage": {"#text": "50000"}, "OccupiedSquareFootage": {"#text": "45000"}, "VacantSquareFootage": {"#text": "5000"}, "RoofType": {"#text": "Built-Up"}, "RoofMaterial": {"#text": "Membrane"}, "RoofAge": {"#text": "3"}, "RoofCondition": {"#text": "Excellent"}, "ExteriorWalls": {"#text": "Curtain Wall Glass"}, "HasBasement": {"#text": "true"}, "BasementLevels": {"#text": "1"}, "ElevatorCount": {"#text": "2"}, "ParkingType": {"#text": "Underground Garage"}, "ParkingSpaces": {"#text": "100"}}, "OccupancyInfo": {"PrimaryOccupancy": {"#text": "Office - Professional"}, "OccupancyCode": {"#text": "OCC-431"}, "SecondaryOccupancy": {"#text": "Retail - Ground Floor"}, "TenantCount": {"#text": "8"}, "OwnerOccupiedPercent": {"#text": "60"}, "HasRestaurant": {"#text": "true"}, "HasRetail": {"#text": "true"}, "HasResidential": {"#text": "false"}, "HasHazardousMaterials": {"#text": "false"}, "AverageOccupancyHours": {"#text": "0800-1800"}, "WeekendOccupancy": {"#text": "Limited"}}, "ValuationInfo": {"BuildingValue": {"#text": "2000000"}, "ContentsValue": {"#text": "500000"}, "BusinessPersonalProperty": {"#text": "500000"}, "TenantImprovements": {"#text": "250000"}, "LandValue": {"#text": "800000"}, "TotalInsurableValue": {"#text": "2500000"}, "ReplacementCost": {"#text": "2200000"}, "ActualCashValue": {"#text": "1800000"}, "AppraisalDate": {"#text": "2025-09-15"}, "AppraisalCompany": {"#text": "ABC Appraisals Inc"}}, "ProtectionInfo": {"FireProtectionClass": {"#text": "3"}, "FireHydrantDistance": {"#text": "200"}, "FireStationDistance": {"#text": "1.5"}, "HasSprinklerSystem": {"#text": "true"}, "SprinklerType": {"#text": "Wet Pipe"}, "SprinklerCoverage": {"#text": "100"}, "HasFireAlarm": {"#text": "true"}, "FireAlarmType": {"#text": "Central Station"}, "HasBurglarAlarm": {"#text": "true"}, "BurglarAlarmType": {"#text": "Central Station"}, "HasSecurityGuard": {"#text": "true"}, "SecurityGuardHours": {"#text": "24/7"}, "HasCCTV": {"#text": "true"}, "HasAccessControl": {"#text": "true"}, "MonitoringCompany": {"#text": "SecureCom Commercial"}}, "MechanicalSystems": {"HVACType": {"#text": "Central"}, "HVACAge": {"#text": "3"}, "HeatingType": {"#text": "Gas"}, "CoolingType": {"#text": "Electric"}, "ElectricalCapacity": {"#text": "2000"}, "HasBackupGenerator": {"#text": "true"}, "GeneratorCapacity": {"#text": "500"}, "PlumbingType": {"#text": "Copper"}, "WaterHeaterType": {"#text": "Commercial Gas"}, "WaterHeaterAge": {"#text": "3"}}, "MortgageInfo": {"IsMortgaged": {"#text": "true"}, "MortgageHolder": {"#text": "First Commercial Bank"}, "LoanNumber": {"#text": "COMM-MTG-9876543"}, "OutstandingBalance": {"#text": "1500000"}, "LoanToValue": {"#text": "60"}, "MortgageAddress": {"AddressLine1": {"#text": "1000 Banking Center"}, "City": {"#text": "Chicago"}, "State": {"#text": "IL"}, "ZipCode": {"#text": "60603"}}}, "LossHistory": {"HasPriorLosses": {"#text": "true"}, "Loss": {"LossDate": {"#text": "2023-12-10"}, "LossType": {"#text": "Water Damage"}, "LossCause": {"#text": "Pipe Burst"}, "LossAmount": {"#text": "45000"}, "LossDescription": {"#text": "Frozen pipe burst on 3rd floor"}, "ClaimNumber": {"#text": "CLM-2023-98765"}, "ClaimStatus": {"#text": "Closed"}, "ClaimPaid": {"#text": "42000"}}}, "ComplianceInfo": {"BuildingCodeCompliant": {"#text": "true"}, "FireCodeCompliant": {"#text": "true"}, "ADACompliant": {"#text": "true"}, "EnvironmentalCompliant": {"#text": "true"}, "LastInspectionDate": {"#text": "2025-08-15"}, "InspectionAgency": {"#text": "City of Chicago Building Department"}, "ViolationsOutstanding": {"#text": "0"}}}, "CoverageData": {"CoverageRecord": [{"CoverageIdentifier": {"#text": "COV-CP-001"}, "RiskIdentifier": {"#text": "RSK-CP-001"}, "CoverageSymbol": {"#text": "BLD"}, "CoverageDescription": {"#text": "Building Coverage"}, "CoverageClass": {"#text": "Property"}, "MaxLimit": {"#text": "2000000"}, "CoverageDeductible": {"#text": "10000"}, "CoverageBasis": {"#text": "Replacement Cost"}, "CoinsurancePercent": {"#text": "90"}, "CoveragePremium": {"#text": "5200.00"}, "CoverageStartDate": {"#text": "2025-11-15"}, "CoverageEndDate": {"#text": "2026-11-15"}, "PerilsCovered": {"#text": "All Risk"}, "IsMandatory": {"#text": "true"}}, {"CoverageIdentifier": {"#text": "COV-CP-002"}, "RiskIdentifier": {"#text": "RSK-CP-001"}, "CoverageSymbol": {"#text": "BPP"}, "CoverageDescription": {"#text": "Business Personal Property"}, "CoverageClass": {"#text": "Property"}, "MaxLimit": {"#text": "500000"}, "CoverageDeductible": {"#text": "5000"}, "CoverageBasis": {"#text": "Replacement Cost"}, "CoinsurancePercent": {"#text": "90"}, "CoveragePremium": {"#text": "1800.00"}, "CoverageStartDate": {"#text": "2025-11-15"}, "CoverageEndDate": {"#text": "2026-11-15"}, "PerilsCovered": {"#text": "All Risk"}, "IsMandatory": {"#text": "true"}}, {"CoverageIdentifier": {"#text": "COV-CP-003"}, "RiskIdentifier": {"#text": "RSK-CP-001"}, "CoverageSymbol": {"#text": "BI"}, "CoverageDescription": {"#text": "Business Interruption"}, "CoverageClass": {"#text": "Income"}, "MaxLimit": {"#text": "1000000"}, "CoverageDeductible": {"#text": "72"}, "DeductibleUnit": {"#text": "Hours"}, "IndemnityPeriod": {"#text": "12"}, "IndemnityPeriodUnit": {"#text": "Months"}, "CoveragePremium": {"#text": "1250.00"}, "CoverageStartDate": {"#text": "2025-11-15"}, "CoverageEndDate": {"#text": "2026-11-15"}, "IsMandatory": {"#text": "false"}}, {"CoverageIdentifier": {"#text": "COV-CP-004"}, "RiskIdentifier": {"#text": "RSK-CP-001"}, "CoverageSymbol": {"#text": "EQ"}, "CoverageDescription": {"#text": "Equipment Breakdown"}, "CoverageClass": {"#text": "Property"}, "MaxLimit": {"#text": "250000"}, "CoverageDeductible": {"#text": "2500"}, "CoveragePremium": {"#text": "500.00"}, "CoverageStartDate": {"#text": "2025-11-15"}, "CoverageEndDate": {"#text": "2026-11-15"}, "CoveredEquipment": {"#text": "HVAC, Elevators, Electrical"}, "IsMandatory": {"#text": "false"}}]}, "PaymentData": {"PaymentIdentifier": {"#text": "PAY-CP-001"}, "PaymentNumber": {"#text": "PAY-CP-001-001"}, "TransactionType": {"#text": "New Business Deposit"}, "PaymentMode": {"#text": "Wire Transfer"}, "StatusDescription": {"#text": "Pending"}, "ScheduledDate": {"#text": "2025-11-15"}, "TransactionAmount": {"#text": "2312.50"}, "BillingPlan": {"#text": "Quarterly"}, "TotalInstallments": {"#text": "4"}, "InstallmentAmount": {"#text": "2499.38"}, "PaymentAccountInfo": {"NameOnAccount": {"#text": "TechStart Solutions LLC"}, "FinancialInstitution": {"#text": "First Commercial Bank"}, "AccountNumber": {"#text": "****9876"}, "RoutingNumber": {"#text": "987654321"}, "AccountType": {"#text": "Business Checking"}}}, "SystemData": {"EnteredBy": {"#text": "jwilson"}, "EntryTimestamp": {"#text": "2025-10-05T16:45:00"}, "UpdatedBy": {"#text": "underwriter.system"}, "UpdateTimestamp": {"#text": "2025-10-05T17:30:00"}, "IssuedBy": {"#text": "policy.system"}, "IssuedTimestamp": {"#text": "2025-10-05T17:35:00"}, "WorkflowStatus": {"#text": "Issued"}, "ApprovalRequired": {"#text": "true"}, "ApprovalStatus": {"#text": "Approved"}, "ApprovedBy": {"#text": "UW-COM-089"}, "ApprovedDate": {"#text": "2025-10-05T17:00:00"}}}}')] in VALUES clause
2025-10-05 23:35:15 - utils.logging_config - INFO - Logging configured at INFO level
2025-10-05 23:35:17 - loaders.snowflake_loader - INFO - ‚úÖ Connected to Snowflake: INSURANCE.ETL_MAPPER with role ACCOUNTADMIN
2025-10-05 23:35:27 - loaders.snowflake_loader - INFO - ‚úÖ Connected to Snowflake: INSURANCE.ETL_MAPPER with role ACCOUNTADMIN
2025-10-05 23:35:27 - utils.decorators - INFO - Starting run...
2025-10-05 23:35:27 - main - INFO - üîç Auto-detecting product type...
2025-10-05 23:35:27 - utils.product_detector - INFO - ‚úÖ Detected product: CP001 with 36.8% confidence
2025-10-05 23:35:27 - main - INFO - ‚úÖ Detected: CP001 with 36.8% confidence
2025-10-05 23:35:27 - main - INFO - üìä Extracting XML metadata...
2025-10-05 23:35:27 - main - INFO - ‚úÖ Extracted 331 XML nodes
2025-10-05 23:35:27 - main - INFO - ‚òÅÔ∏è Loading to Snowflake stage layer...
2025-10-05 23:35:29 - loaders.snowflake_loader - INFO - ‚úÖ Loaded XML data to ETL_MAPPER.STAGE_XML_CP001
2025-10-05 23:35:29 - main - INFO - ‚úÖ Loaded to ETL_MAPPER.STAGE_XML_CP001
2025-10-05 23:35:29 - main - INFO - üóÑÔ∏è Fetching Silver layer schema from Snowflake...
2025-10-05 23:35:29 - utils.schema_manager - INFO - Fetching schema from INSURANCE.SILVER
2025-10-05 23:35:31 - utils.schema_manager - INFO - ‚úÖ Fetched 137 columns from 7 tables
2025-10-05 23:35:31 - main - INFO - ‚úÖ Fetched 137 columns from 7 tables
2025-10-05 23:35:31 - main - INFO - üìö Finding and loading reference data with AI...
2025-10-05 23:35:31 - utils.document_loader - INFO - üîç Found 9 potential reference files
2025-10-05 23:35:35 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-05 23:35:35 - utils.document_loader - INFO - üìÑ historical_mappings_personal_auto.xlsx: historical_mapping (relevance: 85%)
2025-10-05 23:35:40 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-05 23:35:40 - utils.document_loader - INFO - üìÑ historical_mappings_commercial.xlsx: historical_mapping (relevance: 90%)
2025-10-05 23:35:42 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-05 23:35:42 - utils.document_loader - INFO - üìÑ old_mappings.csv: historical_mapping (relevance: 85%)
2025-10-05 23:35:49 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-05 23:35:49 - utils.document_loader - INFO - üìÑ historical_mappings_homeowners.xlsx: historical_mapping (relevance: 85%)
2025-10-05 23:35:51 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-05 23:35:51 - utils.document_loader - INFO - üìÑ old_mappings_homeowners.csv: historical_mapping (relevance: 85%)
2025-10-05 23:35:53 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-05 23:35:53 - utils.document_loader - INFO - üìÑ old_mappings_personal_auto.csv: historical_mapping (relevance: 85%)
2025-10-05 23:35:55 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-05 23:35:55 - utils.document_loader - INFO - üìÑ old_mappings_commercial.csv: historical_mapping (relevance: 85%)
2025-10-05 23:35:57 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-05 23:35:57 - utils.document_loader - INFO - üìÑ data_dictionary.csv: data_dictionary (relevance: 90%)
2025-10-05 23:35:59 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-05 23:35:59 - utils.document_loader - INFO - üìÑ data_dictionary_complete.xlsx: data_dictionary (relevance: 85%)
2025-10-05 23:35:59 - utils.document_loader - INFO - Loading file: reference_data/historical_mappings_commercial.xlsx (type: .xlsx)
2025-10-05 23:35:59 - utils.document_loader - INFO - Found 1 sheets: ['Mappings']
2025-10-05 23:36:04 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-05 23:36:04 - utils.document_loader - INFO - AI understands this as: historical_mappings
2025-10-05 23:36:04 - utils.document_loader - INFO - Loading file: reference_data/data_dictionary.csv (type: .csv)
2025-10-05 23:36:06 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-05 23:36:06 - utils.document_loader - ERROR - Error loading reference_data/data_dictionary.csv: name 'true' is not defined
2025-10-05 23:36:06 - utils.document_loader - INFO - Loading file: reference_data/historical_mappings_personal_auto.xlsx (type: .xlsx)
2025-10-05 23:36:06 - utils.document_loader - INFO - Found 2 sheets: ['Mappings', 'Metadata']
2025-10-05 23:36:09 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-05 23:36:09 - utils.document_loader - INFO - AI understands this as: historical_mappings
2025-10-05 23:36:09 - utils.document_loader - INFO - Loading file: reference_data/old_mappings.csv (type: .csv)
2025-10-05 23:36:12 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-05 23:36:12 - utils.document_loader - ERROR - Error loading reference_data/old_mappings.csv: name 'true' is not defined
2025-10-05 23:36:12 - utils.document_loader - INFO - Loading file: reference_data/historical_mappings_homeowners.xlsx (type: .xlsx)
2025-10-05 23:36:12 - utils.document_loader - INFO - Found 1 sheets: ['Mappings']
2025-10-05 23:36:14 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-05 23:36:14 - utils.document_loader - INFO - AI understands this as: historical_mappings
2025-10-05 23:36:14 - utils.document_loader - INFO - Loading file: reference_data/data_dictionary_complete.xlsx (type: .xlsx)
2025-10-05 23:36:14 - utils.document_loader - INFO - Found 3 sheets: ['DataDictionary', 'TableSummary', 'Metadata']
2025-10-05 23:36:17 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-05 23:36:17 - utils.document_loader - INFO - AI understands this as: data_dictionary
2025-10-05 23:36:17 - utils.document_loader - INFO - 
============================================================
2025-10-05 23:36:17 - utils.document_loader - INFO - ‚úÖ LOADED REFERENCE DATA SUMMARY:
2025-10-05 23:36:17 - utils.document_loader - INFO - ============================================================
2025-10-05 23:36:17 - utils.document_loader - INFO -   üìö Historical mappings: 3 files
2025-10-05 23:36:17 - utils.document_loader - INFO -      - historical_mappings_commercial.xlsx (9 rows)
2025-10-05 23:36:17 - utils.document_loader - INFO -      - historical_mappings_personal_auto.xlsx (51 rows)
2025-10-05 23:36:17 - utils.document_loader - INFO -      - historical_mappings_homeowners.xlsx (14 rows)
2025-10-05 23:36:17 - utils.document_loader - INFO -   üìñ Data dictionaries: 1 files
2025-10-05 23:36:17 - utils.document_loader - INFO -      - data_dictionary_complete.xlsx (104 rows)
2025-10-05 23:36:17 - utils.document_loader - INFO -   üóÑÔ∏è Schema definitions: 0 files
2025-10-05 23:36:17 - utils.document_loader - INFO -   üìä Reference data: 0 files
2025-10-05 23:36:17 - utils.document_loader - INFO - ============================================================

2025-10-05 23:36:17 - main - INFO - ü§ñ Predicting mappings with AI (flexible mode)...
2025-10-05 23:36:17 - utils.decorators - INFO - Starting wrapper...
2025-10-05 23:36:17 - utils.validators - INFO - XML metadata validation passed: 331 nodes
2025-10-05 23:36:17 - mapper.openai_mapper - INFO - ü§ñ Generating mappings with flexible reference data...
2025-10-05 23:36:17 - mapper.openai_mapper - INFO -    XML nodes: 331
2025-10-05 23:36:17 - mapper.openai_mapper - INFO -    Silver columns: 137
2025-10-05 23:36:17 - mapper.openai_mapper - INFO - üí∞ Estimated tokens: ~7,746
2025-10-05 23:36:38 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-05 23:36:38 - mapper.openai_mapper - INFO - ‚úÖ Actual cost: $0.0232
2025-10-05 23:36:38 - mapper.openai_mapper - INFO - üìä Cumulative cost: $0.0232
2025-10-05 23:36:38 - mapper.openai_mapper - INFO - ‚úÖ Generated 12 mappings
2025-10-05 23:36:38 - utils.decorators - INFO - wrapper completed in 20.25s
2025-10-05 23:36:38 - main - INFO - üíæ Saving results...
2025-10-05 23:36:38 - main - INFO - üìÅ Saved 12 mappings to output/mappings_CP001_20251005_233638.csv
2025-10-05 23:36:38 - main - INFO - ‚úÖ Pipeline completed successfully!
2025-10-05 23:36:38 - utils.decorators - INFO - run completed in 70.56s
2025-10-05 23:36:40 - utils.database_helper - ERROR - Failed to save XML: 002014 (22000): SQL compilation error:
Invalid expression [PARSE_JSON('{"filename": "policy_commercial_property_001.xml", "product_code": "PA001", "size_bytes": 18601, "upload_time": "2025-10-05T23:36:40.610052", "uploaded_by": "streamlit_user", "source": "streamlit_app"}')] in VALUES clause
2025-10-05 23:38:48 - utils.logging_config - INFO - Logging configured at INFO level
2025-10-05 23:38:51 - loaders.snowflake_loader - INFO - ‚úÖ Connected to Snowflake: INSURANCE.ETL_MAPPER with role ACCOUNTADMIN
2025-10-05 23:38:57 - loaders.snowflake_loader - INFO - ‚úÖ Connected to Snowflake: INSURANCE.ETL_MAPPER with role ACCOUNTADMIN
2025-10-05 23:38:57 - utils.decorators - INFO - Starting run...
2025-10-05 23:38:57 - main - INFO - üîç Auto-detecting product type...
2025-10-05 23:38:57 - utils.product_detector - INFO - ‚úÖ Detected product: CP001 with 36.8% confidence
2025-10-05 23:38:57 - main - INFO - ‚úÖ Detected: CP001 with 36.8% confidence
2025-10-05 23:38:57 - main - INFO - üìä Extracting XML metadata...
2025-10-05 23:38:57 - main - INFO - ‚úÖ Extracted 331 XML nodes
2025-10-05 23:38:57 - main - INFO - ‚òÅÔ∏è Loading to Snowflake stage layer...
2025-10-05 23:38:58 - loaders.snowflake_loader - INFO - ‚úÖ Loaded XML data to ETL_MAPPER.STAGE_XML_CP001
2025-10-05 23:38:58 - main - INFO - ‚úÖ Loaded to ETL_MAPPER.STAGE_XML_CP001
2025-10-05 23:38:58 - main - INFO - üóÑÔ∏è Fetching Silver layer schema from Snowflake...
2025-10-05 23:38:58 - utils.schema_manager - INFO - Fetching schema from INSURANCE.SILVER
2025-10-05 23:38:59 - utils.schema_manager - INFO - ‚úÖ Fetched 137 columns from 7 tables
2025-10-05 23:38:59 - main - INFO - ‚úÖ Fetched 137 columns from 7 tables
2025-10-05 23:38:59 - main - INFO - üìö Finding and loading reference data with AI...
2025-10-05 23:38:59 - utils.document_loader - INFO - üîç Found 9 potential reference files
2025-10-05 23:39:01 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-05 23:39:01 - utils.document_loader - INFO - üìÑ historical_mappings_personal_auto.xlsx: historical_mapping (relevance: 85%)
2025-10-05 23:39:03 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-05 23:39:03 - utils.document_loader - INFO - üìÑ historical_mappings_commercial.xlsx: historical_mapping (relevance: 85%)
2025-10-05 23:39:05 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-05 23:39:05 - utils.document_loader - INFO - üìÑ old_mappings.csv: historical_mapping (relevance: 85%)
2025-10-05 23:39:07 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-05 23:39:07 - utils.document_loader - INFO - üìÑ historical_mappings_homeowners.xlsx: historical_mapping (relevance: 85%)
2025-10-05 23:39:08 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-05 23:39:08 - utils.document_loader - INFO - üìÑ old_mappings_homeowners.csv: historical_mapping (relevance: 85%)
2025-10-05 23:39:10 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-05 23:39:10 - utils.document_loader - INFO - üìÑ old_mappings_personal_auto.csv: historical_mapping (relevance: 85%)
2025-10-05 23:39:11 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-05 23:39:11 - utils.document_loader - INFO - üìÑ old_mappings_commercial.csv: historical_mapping (relevance: 80%)
2025-10-05 23:39:13 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-05 23:39:13 - utils.document_loader - INFO - üìÑ data_dictionary.csv: data_dictionary (relevance: 90%)
2025-10-05 23:39:14 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-05 23:39:14 - utils.document_loader - INFO - üìÑ data_dictionary_complete.xlsx: data_dictionary (relevance: 90%)
2025-10-05 23:39:14 - utils.document_loader - INFO - Loading file: reference_data/data_dictionary.csv (type: .csv)
2025-10-05 23:39:15 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-05 23:39:15 - utils.document_loader - ERROR - Error loading reference_data/data_dictionary.csv: name 'true' is not defined
2025-10-05 23:39:15 - utils.document_loader - INFO - Loading file: reference_data/data_dictionary_complete.xlsx (type: .xlsx)
2025-10-05 23:39:15 - utils.document_loader - INFO - Found 3 sheets: ['DataDictionary', 'TableSummary', 'Metadata']
2025-10-05 23:39:19 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-05 23:39:19 - utils.document_loader - INFO - AI understands this as: data_dictionary
2025-10-05 23:39:19 - utils.document_loader - INFO - Loading file: reference_data/historical_mappings_personal_auto.xlsx (type: .xlsx)
2025-10-05 23:39:19 - utils.document_loader - INFO - Found 2 sheets: ['Mappings', 'Metadata']
2025-10-05 23:39:22 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-05 23:39:22 - utils.document_loader - INFO - AI understands this as: historical_mappings
2025-10-05 23:39:22 - utils.document_loader - INFO - Loading file: reference_data/historical_mappings_commercial.xlsx (type: .xlsx)
2025-10-05 23:39:22 - utils.document_loader - INFO - Found 1 sheets: ['Mappings']
2025-10-05 23:39:27 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-05 23:39:27 - utils.document_loader - INFO - AI understands this as: historical_mappings
2025-10-05 23:39:27 - utils.document_loader - INFO - Loading file: reference_data/old_mappings.csv (type: .csv)
2025-10-05 23:39:30 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-05 23:39:30 - utils.document_loader - ERROR - Error loading reference_data/old_mappings.csv: name 'true' is not defined
2025-10-05 23:39:30 - utils.document_loader - INFO - Loading file: reference_data/historical_mappings_homeowners.xlsx (type: .xlsx)
2025-10-05 23:39:30 - utils.document_loader - INFO - Found 1 sheets: ['Mappings']
2025-10-05 23:39:32 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-05 23:39:32 - utils.document_loader - INFO - AI understands this as: historical_mappings
2025-10-05 23:39:32 - utils.document_loader - INFO - 
============================================================
2025-10-05 23:39:32 - utils.document_loader - INFO - ‚úÖ LOADED REFERENCE DATA SUMMARY:
2025-10-05 23:39:32 - utils.document_loader - INFO - ============================================================
2025-10-05 23:39:32 - utils.document_loader - INFO -   üìö Historical mappings: 3 files
2025-10-05 23:39:32 - utils.document_loader - INFO -      - historical_mappings_personal_auto.xlsx (51 rows)
2025-10-05 23:39:32 - utils.document_loader - INFO -      - historical_mappings_commercial.xlsx (9 rows)
2025-10-05 23:39:32 - utils.document_loader - INFO -      - historical_mappings_homeowners.xlsx (14 rows)
2025-10-05 23:39:32 - utils.document_loader - INFO -   üìñ Data dictionaries: 1 files
2025-10-05 23:39:32 - utils.document_loader - INFO -      - data_dictionary_complete.xlsx (104 rows)
2025-10-05 23:39:32 - utils.document_loader - INFO -   üóÑÔ∏è Schema definitions: 0 files
2025-10-05 23:39:32 - utils.document_loader - INFO -   üìä Reference data: 0 files
2025-10-05 23:39:32 - utils.document_loader - INFO - ============================================================

2025-10-05 23:39:32 - main - INFO - ü§ñ Predicting mappings with AI (flexible mode)...
2025-10-05 23:39:32 - utils.decorators - INFO - Starting wrapper...
2025-10-05 23:39:32 - utils.validators - INFO - XML metadata validation passed: 331 nodes
2025-10-05 23:39:32 - mapper.openai_mapper - INFO - ü§ñ Generating mappings with flexible reference data...
2025-10-05 23:39:32 - mapper.openai_mapper - INFO -    XML nodes: 331
2025-10-05 23:39:32 - mapper.openai_mapper - INFO -    Silver columns: 137
2025-10-05 23:39:32 - mapper.openai_mapper - INFO - üí∞ Estimated tokens: ~7,746
2025-10-05 23:39:46 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-05 23:39:46 - mapper.openai_mapper - INFO - ‚úÖ Actual cost: $0.0214
2025-10-05 23:39:46 - mapper.openai_mapper - INFO - üìä Cumulative cost: $0.0214
2025-10-05 23:39:46 - mapper.openai_mapper - INFO - ‚úÖ Generated 10 mappings
2025-10-05 23:39:46 - utils.decorators - INFO - wrapper completed in 14.08s
2025-10-05 23:39:46 - main - INFO - üíæ Saving results...
2025-10-05 23:39:46 - main - INFO - üìÅ Saved 10 mappings to output/mappings_CP001_20251005_233946.csv
2025-10-05 23:39:46 - main - INFO - ‚úÖ Pipeline completed successfully!
2025-10-05 23:39:46 - utils.decorators - INFO - run completed in 49.89s
2025-10-05 23:39:50 - utils.database_helper - INFO - ‚úÖ Saved XML to stage: XML-20251005233949
2025-10-05 23:39:58 - utils.database_helper - INFO - ‚úÖ Saved 10 mappings
2025-10-05 23:53:47 - utils.logging_config - INFO - Logging configured at INFO level
2025-10-05 23:53:49 - loaders.snowflake_loader - INFO - ‚úÖ Connected to Snowflake: INSURANCE.ETL_MAPPER with role ACCOUNTADMIN
2025-10-05 23:53:57 - loaders.snowflake_loader - INFO - ‚úÖ Connected to Snowflake: INSURANCE.ETL_MAPPER with role ACCOUNTADMIN
2025-10-05 23:59:09 - utils.logging_config - INFO - Logging configured at INFO level
2025-10-05 23:59:12 - loaders.snowflake_loader - INFO - ‚úÖ Connected to Snowflake: INSURANCE.ETL_MAPPER with role ACCOUNTADMIN
2025-10-05 23:59:19 - loaders.snowflake_loader - INFO - ‚úÖ Connected to Snowflake: INSURANCE.ETL_MAPPER with role ACCOUNTADMIN
2025-10-05 23:59:19 - utils.decorators - INFO - Starting run...
2025-10-05 23:59:19 - main - INFO - üîç Auto-detecting product type...
2025-10-05 23:59:19 - utils.product_detector - INFO - ‚úÖ Detected product: CP001 with 36.8% confidence
2025-10-05 23:59:19 - main - INFO - ‚úÖ Detected: CP001 with 36.8% confidence
2025-10-05 23:59:19 - main - INFO - üìä Extracting XML metadata...
2025-10-05 23:59:19 - main - INFO - ‚úÖ Extracted 331 XML nodes
2025-10-05 23:59:19 - main - INFO - ‚òÅÔ∏è Loading to Snowflake stage layer...
2025-10-05 23:59:20 - loaders.snowflake_loader - INFO - ‚úÖ Loaded XML data to ETL_MAPPER.STAGE_XML_CP001
2025-10-05 23:59:20 - main - INFO - ‚úÖ Loaded to ETL_MAPPER.STAGE_XML_CP001
2025-10-05 23:59:20 - main - INFO - üóÑÔ∏è Fetching Silver layer schema from Snowflake...
2025-10-05 23:59:20 - utils.schema_manager - INFO - Fetching schema from INSURANCE.SILVER
2025-10-05 23:59:21 - utils.schema_manager - INFO - ‚úÖ Fetched 137 columns from 7 tables
2025-10-05 23:59:21 - main - INFO - ‚úÖ Fetched 137 columns from 7 tables
2025-10-05 23:59:21 - main - INFO - üìö Finding and loading reference data with AI...
2025-10-05 23:59:21 - utils.document_loader - INFO - üîç Found 9 potential reference files
2025-10-05 23:59:23 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-05 23:59:23 - utils.document_loader - INFO - üìÑ historical_mappings_personal_auto.xlsx: historical_mapping (relevance: 85%)
2025-10-05 23:59:24 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-05 23:59:24 - utils.document_loader - INFO - üìÑ historical_mappings_commercial.xlsx: historical_mapping (relevance: 85%)
2025-10-05 23:59:26 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-05 23:59:26 - utils.document_loader - INFO - üìÑ old_mappings.csv: historical_mapping (relevance: 85%)
2025-10-05 23:59:27 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-05 23:59:27 - utils.document_loader - INFO - üìÑ historical_mappings_homeowners.xlsx: historical_mapping (relevance: 85%)
2025-10-05 23:59:29 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-05 23:59:29 - utils.document_loader - INFO - üìÑ old_mappings_homeowners.csv: historical_mapping (relevance: 85%)
2025-10-05 23:59:30 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-05 23:59:30 - utils.document_loader - INFO - üìÑ old_mappings_personal_auto.csv: historical_mapping (relevance: 85%)
2025-10-05 23:59:32 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-05 23:59:32 - utils.document_loader - INFO - üìÑ old_mappings_commercial.csv: historical_mapping (relevance: 85%)
2025-10-05 23:59:34 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-05 23:59:34 - utils.document_loader - INFO - üìÑ data_dictionary.csv: data_dictionary (relevance: 85%)
2025-10-05 23:59:36 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-05 23:59:36 - utils.document_loader - INFO - üìÑ data_dictionary_complete.xlsx: data_dictionary (relevance: 85%)
2025-10-05 23:59:36 - utils.document_loader - INFO - Loading file: reference_data/historical_mappings_personal_auto.xlsx (type: .xlsx)
2025-10-05 23:59:36 - utils.document_loader - INFO - Found 2 sheets: ['Mappings', 'Metadata']
2025-10-05 23:59:39 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-05 23:59:39 - utils.document_loader - INFO - AI understands this as: historical_mappings
2025-10-05 23:59:39 - utils.document_loader - INFO - Loading file: reference_data/historical_mappings_commercial.xlsx (type: .xlsx)
2025-10-05 23:59:39 - utils.document_loader - INFO - Found 1 sheets: ['Mappings']
2025-10-05 23:59:44 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-05 23:59:44 - utils.document_loader - INFO - AI understands this as: historical_mappings
2025-10-05 23:59:44 - utils.document_loader - INFO - Loading file: reference_data/old_mappings.csv (type: .csv)
2025-10-05 23:59:46 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-05 23:59:46 - utils.document_loader - ERROR - Error loading reference_data/old_mappings.csv: name 'true' is not defined
2025-10-05 23:59:46 - utils.document_loader - INFO - Loading file: reference_data/historical_mappings_homeowners.xlsx (type: .xlsx)
2025-10-05 23:59:46 - utils.document_loader - INFO - Found 1 sheets: ['Mappings']
2025-10-05 23:59:48 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-05 23:59:48 - utils.document_loader - INFO - AI understands this as: historical_mappings
2025-10-05 23:59:48 - utils.document_loader - INFO - Loading file: reference_data/data_dictionary.csv (type: .csv)
2025-10-05 23:59:51 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-05 23:59:51 - utils.document_loader - ERROR - Error loading reference_data/data_dictionary.csv: name 'true' is not defined
2025-10-05 23:59:51 - utils.document_loader - INFO - Loading file: reference_data/data_dictionary_complete.xlsx (type: .xlsx)
2025-10-05 23:59:51 - utils.document_loader - INFO - Found 3 sheets: ['DataDictionary', 'TableSummary', 'Metadata']
2025-10-05 23:59:53 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-05 23:59:53 - utils.document_loader - INFO - AI understands this as: data_dictionary
2025-10-05 23:59:53 - utils.document_loader - INFO - 
============================================================
2025-10-05 23:59:53 - utils.document_loader - INFO - ‚úÖ LOADED REFERENCE DATA SUMMARY:
2025-10-05 23:59:53 - utils.document_loader - INFO - ============================================================
2025-10-05 23:59:53 - utils.document_loader - INFO -   üìö Historical mappings: 3 files
2025-10-05 23:59:53 - utils.document_loader - INFO -      - historical_mappings_personal_auto.xlsx (51 rows)
2025-10-05 23:59:53 - utils.document_loader - INFO -      - historical_mappings_commercial.xlsx (9 rows)
2025-10-05 23:59:53 - utils.document_loader - INFO -      - historical_mappings_homeowners.xlsx (14 rows)
2025-10-05 23:59:53 - utils.document_loader - INFO -   üìñ Data dictionaries: 1 files
2025-10-05 23:59:53 - utils.document_loader - INFO -      - data_dictionary_complete.xlsx (104 rows)
2025-10-05 23:59:53 - utils.document_loader - INFO -   üóÑÔ∏è Schema definitions: 0 files
2025-10-05 23:59:53 - utils.document_loader - INFO -   üìä Reference data: 0 files
2025-10-05 23:59:53 - utils.document_loader - INFO - ============================================================

2025-10-05 23:59:53 - main - INFO - ü§ñ Predicting mappings with AI (flexible mode)...
2025-10-05 23:59:53 - utils.decorators - INFO - Starting wrapper...
2025-10-05 23:59:53 - utils.validators - INFO - XML metadata validation passed: 331 nodes
2025-10-05 23:59:53 - mapper.openai_mapper - INFO - ü§ñ Generating mappings with flexible reference data...
2025-10-05 23:59:53 - mapper.openai_mapper - INFO -    XML nodes: 331
2025-10-05 23:59:53 - mapper.openai_mapper - INFO -    Silver columns: 137
2025-10-05 23:59:53 - mapper.openai_mapper - INFO - üí∞ Estimated tokens: ~7,746
2025-10-05 23:59:58 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-05 23:59:58 - mapper.openai_mapper - INFO - ‚úÖ Actual cost: $0.0212
2025-10-05 23:59:58 - mapper.openai_mapper - INFO - üìä Cumulative cost: $0.0212
2025-10-05 23:59:58 - mapper.openai_mapper - INFO - ‚úÖ Generated 10 mappings
2025-10-05 23:59:58 - utils.decorators - INFO - wrapper completed in 4.40s
2025-10-05 23:59:58 - main - INFO - üíæ Saving results...
2025-10-05 23:59:58 - main - INFO - üìÅ Saved 10 mappings to output/mappings_CP001_20251005_235958.csv
2025-10-05 23:59:58 - main - INFO - ‚úÖ Pipeline completed successfully!
2025-10-05 23:59:58 - utils.decorators - INFO - run completed in 38.74s
2025-10-06 00:00:01 - utils.database_helper - INFO - ‚úÖ Saved XML to stage: XML-20251006000000
2025-10-06 00:00:08 - utils.database_helper - INFO - ‚úÖ Saved 10 mappings
2025-10-06 00:23:01 - utils.logging_config - INFO - Logging configured at INFO level
2025-10-06 00:23:04 - loaders.snowflake_loader - INFO - ‚úÖ Connected to Snowflake: INSURANCE.ETL_MAPPER with role ACCOUNTADMIN
2025-10-06 00:23:04 - mapper.openai_mapper - WARNING - ‚ö†Ô∏è No Snowflake config, using defaults
2025-10-06 00:23:04 - mapper.openai_mapper - INFO - ‚úÖ Loaded 7 Silver layer tables from Snowflake
2025-10-06 00:23:29 - loaders.snowflake_loader - INFO - ‚úÖ Connected to Snowflake: INSURANCE.ETL_MAPPER with role ACCOUNTADMIN
2025-10-06 00:23:29 - mapper.openai_mapper - WARNING - ‚ö†Ô∏è No Snowflake config, using defaults
2025-10-06 00:23:29 - mapper.openai_mapper - INFO - ‚úÖ Loaded 7 Silver layer tables from Snowflake
2025-10-06 00:23:29 - utils.decorators - INFO - Starting run...
2025-10-06 00:23:29 - main - INFO - üîç Auto-detecting product type...
2025-10-06 00:23:29 - utils.product_detector - INFO - ‚úÖ Detected product: CP001 with 36.8% confidence
2025-10-06 00:23:29 - main - INFO - ‚úÖ Detected: CP001 with 36.8% confidence
2025-10-06 00:23:29 - main - INFO - üìä Extracting XML metadata...
2025-10-06 00:23:29 - main - INFO - ‚úÖ Extracted 331 XML nodes
2025-10-06 00:23:29 - main - INFO - ‚òÅÔ∏è Loading to Snowflake stage layer...
2025-10-06 00:23:31 - loaders.snowflake_loader - INFO - ‚úÖ Loaded XML data to ETL_MAPPER.STAGE_XML_CP001
2025-10-06 00:23:31 - main - INFO - ‚úÖ Loaded to ETL_MAPPER.STAGE_XML_CP001
2025-10-06 00:23:31 - main - INFO - üóÑÔ∏è Fetching Silver layer schema from Snowflake...
2025-10-06 00:23:31 - utils.schema_manager - INFO - Fetching schema from INSURANCE.SILVER
2025-10-06 00:23:32 - utils.schema_manager - INFO - ‚úÖ Fetched 137 columns from 7 tables
2025-10-06 00:23:32 - main - INFO - ‚úÖ Fetched 137 columns from 7 tables
2025-10-06 00:23:32 - main - INFO - üìö Finding and loading reference data with AI...
2025-10-06 00:23:32 - utils.document_loader - INFO - üîç Found 9 potential reference files
2025-10-06 00:23:35 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 00:23:35 - utils.document_loader - INFO - üìÑ historical_mappings_personal_auto.xlsx: historical_mapping (relevance: 85%)
2025-10-06 00:23:39 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 00:23:39 - utils.document_loader - INFO - üìÑ historical_mappings_commercial.xlsx: historical_mapping (relevance: 85%)
2025-10-06 00:23:41 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 00:23:41 - utils.document_loader - INFO - üìÑ old_mappings.csv: historical_mapping (relevance: 85%)
2025-10-06 00:23:46 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 00:23:46 - utils.document_loader - INFO - üìÑ historical_mappings_homeowners.xlsx: historical_mapping (relevance: 85%)
2025-10-06 00:23:48 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 00:23:48 - utils.document_loader - INFO - üìÑ old_mappings_homeowners.csv: historical_mapping (relevance: 85%)
2025-10-06 00:23:49 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 00:23:49 - utils.document_loader - INFO - üìÑ old_mappings_personal_auto.csv: historical_mapping (relevance: 85%)
2025-10-06 00:23:51 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 00:23:51 - utils.document_loader - INFO - üìÑ old_mappings_commercial.csv: historical_mapping (relevance: 85%)
2025-10-06 00:23:54 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 00:23:54 - utils.document_loader - INFO - üìÑ data_dictionary.csv: data_dictionary (relevance: 90%)
2025-10-06 00:23:56 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 00:23:56 - utils.document_loader - INFO - üìÑ data_dictionary_complete.xlsx: data_dictionary (relevance: 90%)
2025-10-06 00:23:56 - utils.document_loader - INFO - Loading file: reference_data/data_dictionary.csv (type: .csv)
2025-10-06 00:23:57 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 00:23:57 - utils.document_loader - ERROR - Error loading reference_data/data_dictionary.csv: name 'true' is not defined
2025-10-06 00:23:57 - utils.document_loader - INFO - Loading file: reference_data/data_dictionary_complete.xlsx (type: .xlsx)
2025-10-06 00:23:57 - utils.document_loader - INFO - Found 3 sheets: ['DataDictionary', 'TableSummary', 'Metadata']
2025-10-06 00:24:00 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 00:24:00 - utils.document_loader - INFO - AI understands this as: data_dictionary
2025-10-06 00:24:00 - utils.document_loader - INFO - Loading file: reference_data/historical_mappings_personal_auto.xlsx (type: .xlsx)
2025-10-06 00:24:00 - utils.document_loader - INFO - Found 2 sheets: ['Mappings', 'Metadata']
2025-10-06 00:24:03 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 00:24:03 - utils.document_loader - INFO - AI understands this as: historical_mappings
2025-10-06 00:24:03 - utils.document_loader - INFO - Loading file: reference_data/historical_mappings_commercial.xlsx (type: .xlsx)
2025-10-06 00:24:03 - utils.document_loader - INFO - Found 1 sheets: ['Mappings']
2025-10-06 00:24:06 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 00:24:06 - utils.document_loader - INFO - AI understands this as: historical_mappings
2025-10-06 00:24:06 - utils.document_loader - INFO - Loading file: reference_data/old_mappings.csv (type: .csv)
2025-10-06 00:24:08 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 00:24:08 - utils.document_loader - ERROR - Error loading reference_data/old_mappings.csv: name 'true' is not defined
2025-10-06 00:24:08 - utils.document_loader - INFO - Loading file: reference_data/historical_mappings_homeowners.xlsx (type: .xlsx)
2025-10-06 00:24:08 - utils.document_loader - INFO - Found 1 sheets: ['Mappings']
2025-10-06 00:24:11 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 00:24:11 - utils.document_loader - INFO - AI understands this as: historical_mappings
2025-10-06 00:24:11 - utils.document_loader - INFO - 
============================================================
2025-10-06 00:24:11 - utils.document_loader - INFO - ‚úÖ LOADED REFERENCE DATA SUMMARY:
2025-10-06 00:24:11 - utils.document_loader - INFO - ============================================================
2025-10-06 00:24:11 - utils.document_loader - INFO -   üìö Historical mappings: 3 files
2025-10-06 00:24:11 - utils.document_loader - INFO -      - historical_mappings_personal_auto.xlsx (51 rows)
2025-10-06 00:24:11 - utils.document_loader - INFO -      - historical_mappings_commercial.xlsx (9 rows)
2025-10-06 00:24:11 - utils.document_loader - INFO -      - historical_mappings_homeowners.xlsx (14 rows)
2025-10-06 00:24:11 - utils.document_loader - INFO -   üìñ Data dictionaries: 1 files
2025-10-06 00:24:11 - utils.document_loader - INFO -      - data_dictionary_complete.xlsx (104 rows)
2025-10-06 00:24:11 - utils.document_loader - INFO -   üóÑÔ∏è Schema definitions: 0 files
2025-10-06 00:24:11 - utils.document_loader - INFO -   üìä Reference data: 0 files
2025-10-06 00:24:11 - utils.document_loader - INFO - ============================================================

2025-10-06 00:24:11 - main - INFO - ü§ñ Predicting mappings with AI (flexible mode)...
2025-10-06 00:24:11 - utils.decorators - ERROR - run failed after 42.43s: 'AIETLMapper' object has no attribute 'predict_mappings_flexible'
2025-10-06 00:26:46 - utils.logging_config - INFO - Logging configured at INFO level
2025-10-06 00:26:48 - loaders.snowflake_loader - INFO - ‚úÖ Connected to Snowflake: INSURANCE.ETL_MAPPER with role ACCOUNTADMIN
2025-10-06 00:26:48 - mapper.openai_mapper - WARNING - ‚ö†Ô∏è No Snowflake config, using defaults
2025-10-06 00:26:48 - mapper.openai_mapper - INFO - ‚úÖ Loaded 7 Silver layer tables
2025-10-06 00:26:54 - loaders.snowflake_loader - INFO - ‚úÖ Connected to Snowflake: INSURANCE.ETL_MAPPER with role ACCOUNTADMIN
2025-10-06 00:26:54 - mapper.openai_mapper - WARNING - ‚ö†Ô∏è No Snowflake config, using defaults
2025-10-06 00:26:54 - mapper.openai_mapper - INFO - ‚úÖ Loaded 7 Silver layer tables
2025-10-06 00:26:54 - utils.decorators - INFO - Starting run...
2025-10-06 00:26:54 - main - INFO - üîç Auto-detecting product type...
2025-10-06 00:26:54 - utils.product_detector - INFO - ‚úÖ Detected product: CP001 with 36.8% confidence
2025-10-06 00:26:54 - main - INFO - ‚úÖ Detected: CP001 with 36.8% confidence
2025-10-06 00:26:54 - main - INFO - üìä Extracting XML metadata...
2025-10-06 00:26:54 - main - INFO - ‚úÖ Extracted 331 XML nodes
2025-10-06 00:26:54 - main - INFO - ‚òÅÔ∏è Loading to Snowflake stage layer...
2025-10-06 00:26:56 - loaders.snowflake_loader - INFO - ‚úÖ Loaded XML data to ETL_MAPPER.STAGE_XML_CP001
2025-10-06 00:26:56 - main - INFO - ‚úÖ Loaded to ETL_MAPPER.STAGE_XML_CP001
2025-10-06 00:26:56 - main - INFO - üóÑÔ∏è Fetching Silver layer schema from Snowflake...
2025-10-06 00:26:56 - utils.schema_manager - INFO - Fetching schema from INSURANCE.SILVER
2025-10-06 00:26:57 - utils.schema_manager - INFO - ‚úÖ Fetched 137 columns from 7 tables
2025-10-06 00:26:57 - main - INFO - ‚úÖ Fetched 137 columns from 7 tables
2025-10-06 00:26:57 - main - INFO - üìö Finding and loading reference data with AI...
2025-10-06 00:26:57 - utils.document_loader - INFO - üîç Found 9 potential reference files
2025-10-06 00:26:59 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 00:26:59 - utils.document_loader - INFO - üìÑ historical_mappings_personal_auto.xlsx: historical_mapping (relevance: 85%)
2025-10-06 00:27:00 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 00:27:00 - utils.document_loader - INFO - üìÑ historical_mappings_commercial.xlsx: historical_mapping (relevance: 85%)
2025-10-06 00:27:02 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 00:27:02 - utils.document_loader - INFO - üìÑ old_mappings.csv: historical_mapping (relevance: 85%)
2025-10-06 00:27:03 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 00:27:03 - utils.document_loader - INFO - üìÑ historical_mappings_homeowners.xlsx: historical_mapping (relevance: 85%)
2025-10-06 00:27:05 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 00:27:05 - utils.document_loader - INFO - üìÑ old_mappings_homeowners.csv: historical_mapping (relevance: 85%)
2025-10-06 00:27:06 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 00:27:06 - utils.document_loader - INFO - üìÑ old_mappings_personal_auto.csv: historical_mapping (relevance: 85%)
2025-10-06 00:27:07 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 00:27:07 - utils.document_loader - INFO - üìÑ old_mappings_commercial.csv: historical_mapping (relevance: 85%)
2025-10-06 00:27:09 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 00:27:09 - utils.document_loader - INFO - üìÑ data_dictionary.csv: data_dictionary (relevance: 90%)
2025-10-06 00:27:10 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 00:27:10 - utils.document_loader - INFO - üìÑ data_dictionary_complete.xlsx: data_dictionary (relevance: 85%)
2025-10-06 00:27:10 - utils.document_loader - INFO - Loading file: reference_data/data_dictionary.csv (type: .csv)
2025-10-06 00:27:12 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 00:27:12 - utils.document_loader - ERROR - Error loading reference_data/data_dictionary.csv: name 'true' is not defined
2025-10-06 00:27:12 - utils.document_loader - INFO - Loading file: reference_data/historical_mappings_personal_auto.xlsx (type: .xlsx)
2025-10-06 00:27:12 - utils.document_loader - INFO - Found 2 sheets: ['Mappings', 'Metadata']
2025-10-06 00:27:15 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 00:27:15 - utils.document_loader - INFO - AI understands this as: historical_mappings
2025-10-06 00:27:15 - utils.document_loader - INFO - Loading file: reference_data/historical_mappings_commercial.xlsx (type: .xlsx)
2025-10-06 00:27:15 - utils.document_loader - INFO - Found 1 sheets: ['Mappings']
2025-10-06 00:27:17 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 00:27:17 - utils.document_loader - INFO - AI understands this as: historical_mappings
2025-10-06 00:27:17 - utils.document_loader - INFO - Loading file: reference_data/old_mappings.csv (type: .csv)
2025-10-06 00:27:19 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 00:27:19 - utils.document_loader - ERROR - Error loading reference_data/old_mappings.csv: name 'true' is not defined
2025-10-06 00:27:19 - utils.document_loader - INFO - Loading file: reference_data/historical_mappings_homeowners.xlsx (type: .xlsx)
2025-10-06 00:27:19 - utils.document_loader - INFO - Found 1 sheets: ['Mappings']
2025-10-06 00:27:20 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 00:27:20 - utils.document_loader - INFO - AI understands this as: historical_mappings
2025-10-06 00:27:20 - utils.document_loader - INFO - Loading file: reference_data/data_dictionary_complete.xlsx (type: .xlsx)
2025-10-06 00:27:20 - utils.document_loader - INFO - Found 3 sheets: ['DataDictionary', 'TableSummary', 'Metadata']
2025-10-06 00:27:23 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 00:27:23 - utils.document_loader - INFO - AI understands this as: data_dictionary
2025-10-06 00:27:23 - utils.document_loader - INFO - 
============================================================
2025-10-06 00:27:23 - utils.document_loader - INFO - ‚úÖ LOADED REFERENCE DATA SUMMARY:
2025-10-06 00:27:23 - utils.document_loader - INFO - ============================================================
2025-10-06 00:27:23 - utils.document_loader - INFO -   üìö Historical mappings: 3 files
2025-10-06 00:27:23 - utils.document_loader - INFO -      - historical_mappings_personal_auto.xlsx (51 rows)
2025-10-06 00:27:23 - utils.document_loader - INFO -      - historical_mappings_commercial.xlsx (9 rows)
2025-10-06 00:27:23 - utils.document_loader - INFO -      - historical_mappings_homeowners.xlsx (14 rows)
2025-10-06 00:27:23 - utils.document_loader - INFO -   üìñ Data dictionaries: 1 files
2025-10-06 00:27:23 - utils.document_loader - INFO -      - data_dictionary_complete.xlsx (104 rows)
2025-10-06 00:27:23 - utils.document_loader - INFO -   üóÑÔ∏è Schema definitions: 0 files
2025-10-06 00:27:23 - utils.document_loader - INFO -   üìä Reference data: 0 files
2025-10-06 00:27:23 - utils.document_loader - INFO - ============================================================

2025-10-06 00:27:23 - main - INFO - ü§ñ Predicting mappings with AI (flexible mode)...
2025-10-06 00:27:23 - utils.decorators - ERROR - run failed after 28.96s: 'nodes'
2025-10-06 00:29:40 - utils.logging_config - INFO - Logging configured at INFO level
2025-10-06 00:29:43 - loaders.snowflake_loader - INFO - ‚úÖ Connected to Snowflake: INSURANCE.ETL_MAPPER with role ACCOUNTADMIN
2025-10-06 00:29:43 - mapper.openai_mapper - INFO - ‚úÖ Loaded 7 Silver layer tables
2025-10-06 00:29:48 - loaders.snowflake_loader - INFO - ‚úÖ Connected to Snowflake: INSURANCE.ETL_MAPPER with role ACCOUNTADMIN
2025-10-06 00:29:48 - mapper.openai_mapper - INFO - ‚úÖ Loaded 7 Silver layer tables
2025-10-06 00:29:48 - utils.decorators - INFO - Starting run...
2025-10-06 00:29:48 - main - INFO - üîç Auto-detecting product type...
2025-10-06 00:29:48 - utils.product_detector - INFO - ‚úÖ Detected product: CP001 with 36.8% confidence
2025-10-06 00:29:48 - main - INFO - ‚úÖ Detected: CP001 with 36.8% confidence
2025-10-06 00:29:48 - main - INFO - üìä Extracting XML metadata...
2025-10-06 00:29:48 - main - INFO - ‚úÖ Extracted 331 XML nodes
2025-10-06 00:29:48 - main - INFO - ‚òÅÔ∏è Loading to Snowflake stage layer...
2025-10-06 00:29:48 - loaders.snowflake_loader - INFO - ‚úÖ Loaded XML data to ETL_MAPPER.STAGE_XML_CP001
2025-10-06 00:29:48 - main - INFO - ‚úÖ Loaded to ETL_MAPPER.STAGE_XML_CP001
2025-10-06 00:29:48 - main - INFO - üóÑÔ∏è Fetching Silver layer schema from Snowflake...
2025-10-06 00:29:48 - utils.schema_manager - INFO - Fetching schema from INSURANCE.SILVER
2025-10-06 00:29:49 - utils.schema_manager - INFO - ‚úÖ Fetched 137 columns from 7 tables
2025-10-06 00:29:49 - main - INFO - ‚úÖ Fetched 137 columns from 7 tables
2025-10-06 00:29:49 - main - INFO - üìö Finding and loading reference data with AI...
2025-10-06 00:29:49 - utils.document_loader - INFO - üîç Found 9 potential reference files
2025-10-06 00:29:51 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 00:29:51 - utils.document_loader - INFO - üìÑ historical_mappings_personal_auto.xlsx: historical_mapping (relevance: 85%)
2025-10-06 00:29:53 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 00:29:53 - utils.document_loader - INFO - üìÑ historical_mappings_commercial.xlsx: historical_mapping (relevance: 85%)
2025-10-06 00:29:55 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 00:29:55 - utils.document_loader - INFO - üìÑ old_mappings.csv: historical_mapping (relevance: 85%)
2025-10-06 00:29:58 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 00:29:58 - utils.document_loader - INFO - üìÑ historical_mappings_homeowners.xlsx: historical_mapping (relevance: 85%)
2025-10-06 00:29:59 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 00:29:59 - utils.document_loader - INFO - üìÑ old_mappings_homeowners.csv: historical_mapping (relevance: 85%)
2025-10-06 00:30:01 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 00:30:01 - utils.document_loader - INFO - üìÑ old_mappings_personal_auto.csv: historical_mapping (relevance: 85%)
2025-10-06 00:30:02 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 00:30:02 - utils.document_loader - INFO - üìÑ old_mappings_commercial.csv: historical_mapping (relevance: 85%)
2025-10-06 00:30:04 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 00:30:04 - utils.document_loader - INFO - üìÑ data_dictionary.csv: data_dictionary (relevance: 90%)
2025-10-06 00:30:05 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 00:30:05 - utils.document_loader - INFO - üìÑ data_dictionary_complete.xlsx: data_dictionary (relevance: 85%)
2025-10-06 00:30:05 - utils.document_loader - INFO - Loading file: reference_data/data_dictionary.csv (type: .csv)
2025-10-06 00:30:07 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 00:30:07 - utils.document_loader - ERROR - Error loading reference_data/data_dictionary.csv: name 'true' is not defined
2025-10-06 00:30:07 - utils.document_loader - INFO - Loading file: reference_data/historical_mappings_personal_auto.xlsx (type: .xlsx)
2025-10-06 00:30:07 - utils.document_loader - INFO - Found 2 sheets: ['Mappings', 'Metadata']
2025-10-06 00:30:11 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 00:30:11 - utils.document_loader - INFO - AI understands this as: historical_mappings
2025-10-06 00:30:11 - utils.document_loader - INFO - Loading file: reference_data/historical_mappings_commercial.xlsx (type: .xlsx)
2025-10-06 00:30:11 - utils.document_loader - INFO - Found 1 sheets: ['Mappings']
2025-10-06 00:30:14 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 00:30:14 - utils.document_loader - INFO - AI understands this as: historical_mappings
2025-10-06 00:30:14 - utils.document_loader - INFO - Loading file: reference_data/old_mappings.csv (type: .csv)
2025-10-06 00:30:17 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 00:30:17 - utils.document_loader - ERROR - Error loading reference_data/old_mappings.csv: name 'true' is not defined
2025-10-06 00:30:17 - utils.document_loader - INFO - Loading file: reference_data/historical_mappings_homeowners.xlsx (type: .xlsx)
2025-10-06 00:30:17 - utils.document_loader - INFO - Found 1 sheets: ['Mappings']
2025-10-06 00:30:19 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 00:30:19 - utils.document_loader - INFO - AI understands this as: historical_mappings
2025-10-06 00:30:19 - utils.document_loader - INFO - Loading file: reference_data/data_dictionary_complete.xlsx (type: .xlsx)
2025-10-06 00:30:19 - utils.document_loader - INFO - Found 3 sheets: ['DataDictionary', 'TableSummary', 'Metadata']
2025-10-06 00:30:23 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 00:30:23 - utils.document_loader - INFO - AI understands this as: data_dictionary
2025-10-06 00:30:23 - utils.document_loader - INFO - 
============================================================
2025-10-06 00:30:23 - utils.document_loader - INFO - ‚úÖ LOADED REFERENCE DATA SUMMARY:
2025-10-06 00:30:23 - utils.document_loader - INFO - ============================================================
2025-10-06 00:30:23 - utils.document_loader - INFO -   üìö Historical mappings: 3 files
2025-10-06 00:30:23 - utils.document_loader - INFO -      - historical_mappings_personal_auto.xlsx (51 rows)
2025-10-06 00:30:23 - utils.document_loader - INFO -      - historical_mappings_commercial.xlsx (9 rows)
2025-10-06 00:30:23 - utils.document_loader - INFO -      - historical_mappings_homeowners.xlsx (14 rows)
2025-10-06 00:30:23 - utils.document_loader - INFO -   üìñ Data dictionaries: 1 files
2025-10-06 00:30:23 - utils.document_loader - INFO -      - data_dictionary_complete.xlsx (104 rows)
2025-10-06 00:30:23 - utils.document_loader - INFO -   üóÑÔ∏è Schema definitions: 0 files
2025-10-06 00:30:23 - utils.document_loader - INFO -   üìä Reference data: 0 files
2025-10-06 00:30:23 - utils.document_loader - INFO - ============================================================

2025-10-06 00:30:23 - main - INFO - ü§ñ Predicting mappings with AI (flexible mode)...
2025-10-06 00:30:23 - mapper.openai_mapper - INFO - üìä Grouped into 7 sections: ['General', 'PolicyData', 'AccountData', 'QuoteData', 'RiskData', 'CoverageData', 'PaymentData']
2025-10-06 00:30:23 - mapper.openai_mapper - WARNING - ‚ö†Ô∏è 'General' ‚Üí SILVER.POLICY (default)
2025-10-06 00:30:23 - mapper.openai_mapper - WARNING - ‚ö†Ô∏è No schema for SILVER.POLICY
2025-10-06 00:30:23 - mapper.openai_mapper - INFO - ‚úÖ 'PolicyData' ‚Üí SILVER.POLICY
2025-10-06 00:30:23 - mapper.openai_mapper - WARNING - ‚ö†Ô∏è No schema for SILVER.POLICY
2025-10-06 00:30:23 - mapper.openai_mapper - INFO - ‚úÖ 'AccountData' ‚Üí SILVER.ACCOUNT
2025-10-06 00:30:23 - mapper.openai_mapper - WARNING - ‚ö†Ô∏è No schema for SILVER.ACCOUNT
2025-10-06 00:30:23 - mapper.openai_mapper - INFO - ‚úÖ 'QuoteData' ‚Üí SILVER.QUOTE
2025-10-06 00:30:23 - mapper.openai_mapper - WARNING - ‚ö†Ô∏è No schema for SILVER.QUOTE
2025-10-06 00:30:23 - mapper.openai_mapper - INFO - ‚úÖ 'RiskData' ‚Üí SILVER.RISK
2025-10-06 00:30:23 - mapper.openai_mapper - WARNING - ‚ö†Ô∏è No schema for SILVER.RISK
2025-10-06 00:30:23 - mapper.openai_mapper - INFO - ‚úÖ 'CoverageData' ‚Üí SILVER.COVERAGE
2025-10-06 00:30:23 - mapper.openai_mapper - WARNING - ‚ö†Ô∏è No schema for SILVER.COVERAGE
2025-10-06 00:30:23 - mapper.openai_mapper - INFO - ‚úÖ 'PaymentData' ‚Üí SILVER.PAYMENT
2025-10-06 00:30:23 - mapper.openai_mapper - WARNING - ‚ö†Ô∏è No schema for SILVER.PAYMENT
2025-10-06 00:30:23 - main - INFO - üíæ Saving results...
2025-10-06 00:30:23 - main - INFO - üìÅ Saved 0 mappings to output/mappings_CP001_20251006_003023.csv
2025-10-06 00:30:23 - utils.decorators - ERROR - run failed after 35.06s: 'confidence_score'
2025-10-06 00:33:38 - utils.logging_config - INFO - Logging configured at INFO level
2025-10-06 00:33:40 - loaders.snowflake_loader - INFO - ‚úÖ Connected to Snowflake: INSURANCE.ETL_MAPPER with role ACCOUNTADMIN
2025-10-06 00:33:40 - mapper.openai_mapper - INFO - ‚úÖ Loaded 7 Silver layer tables
2025-10-06 00:33:45 - loaders.snowflake_loader - INFO - ‚úÖ Connected to Snowflake: INSURANCE.ETL_MAPPER with role ACCOUNTADMIN
2025-10-06 00:33:45 - mapper.openai_mapper - INFO - ‚úÖ Loaded 7 Silver layer tables
2025-10-06 00:33:45 - utils.decorators - INFO - Starting run...
2025-10-06 00:33:45 - main - INFO - üîç Auto-detecting product type...
2025-10-06 00:33:45 - utils.product_detector - INFO - ‚úÖ Detected product: CP001 with 36.8% confidence
2025-10-06 00:33:45 - main - INFO - ‚úÖ Detected: CP001 with 36.8% confidence
2025-10-06 00:33:45 - main - INFO - üìä Extracting XML metadata...
2025-10-06 00:33:45 - main - INFO - ‚úÖ Extracted 331 XML nodes
2025-10-06 00:33:45 - main - INFO - ‚òÅÔ∏è Loading to Snowflake stage layer...
2025-10-06 00:33:46 - loaders.snowflake_loader - INFO - ‚úÖ Loaded XML data to ETL_MAPPER.STAGE_XML_CP001
2025-10-06 00:33:46 - main - INFO - ‚úÖ Loaded to ETL_MAPPER.STAGE_XML_CP001
2025-10-06 00:33:46 - main - INFO - üóÑÔ∏è Fetching Silver layer schema from Snowflake...
2025-10-06 00:33:46 - utils.schema_manager - INFO - Fetching schema from INSURANCE.SILVER
2025-10-06 00:33:47 - utils.schema_manager - INFO - ‚úÖ Fetched 137 columns from 7 tables
2025-10-06 00:33:47 - main - INFO - ‚úÖ Fetched 137 columns from 7 tables
2025-10-06 00:33:47 - main - INFO - üìö Finding and loading reference data with AI...
2025-10-06 00:33:47 - utils.document_loader - INFO - üîç Found 9 potential reference files
2025-10-06 00:33:49 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 00:33:49 - utils.document_loader - INFO - üìÑ historical_mappings_personal_auto.xlsx: historical_mapping (relevance: 85%)
2025-10-06 00:33:50 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 00:33:50 - utils.document_loader - INFO - üìÑ historical_mappings_commercial.xlsx: historical_mapping (relevance: 85%)
2025-10-06 00:33:52 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 00:33:52 - utils.document_loader - INFO - üìÑ old_mappings.csv: historical_mapping (relevance: 85%)
2025-10-06 00:33:53 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 00:33:53 - utils.document_loader - INFO - üìÑ historical_mappings_homeowners.xlsx: historical_mapping (relevance: 85%)
2025-10-06 00:33:54 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 00:33:54 - utils.document_loader - INFO - üìÑ old_mappings_homeowners.csv: historical_mapping (relevance: 85%)
2025-10-06 00:33:56 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 00:33:56 - utils.document_loader - INFO - üìÑ old_mappings_personal_auto.csv: historical_mapping (relevance: 85%)
2025-10-06 00:33:57 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 00:33:57 - utils.document_loader - INFO - üìÑ old_mappings_commercial.csv: historical_mapping (relevance: 85%)
2025-10-06 00:33:59 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 00:33:59 - utils.document_loader - INFO - üìÑ data_dictionary.csv: data_dictionary (relevance: 90%)
2025-10-06 00:33:59 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 00:33:59 - utils.document_loader - INFO - üìÑ data_dictionary_complete.xlsx: data_dictionary (relevance: 90%)
2025-10-06 00:33:59 - utils.document_loader - INFO - Loading file: reference_data/data_dictionary.csv (type: .csv)
2025-10-06 00:34:01 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 00:34:01 - utils.document_loader - ERROR - Error loading reference_data/data_dictionary.csv: name 'true' is not defined
2025-10-06 00:34:01 - utils.document_loader - INFO - Loading file: reference_data/data_dictionary_complete.xlsx (type: .xlsx)
2025-10-06 00:34:01 - utils.document_loader - INFO - Found 3 sheets: ['DataDictionary', 'TableSummary', 'Metadata']
2025-10-06 00:34:05 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 00:34:05 - utils.document_loader - INFO - AI understands this as: data_dictionary
2025-10-06 00:34:05 - utils.document_loader - INFO - Loading file: reference_data/historical_mappings_personal_auto.xlsx (type: .xlsx)
2025-10-06 00:34:05 - utils.document_loader - INFO - Found 2 sheets: ['Mappings', 'Metadata']
2025-10-06 00:34:07 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 00:34:07 - utils.document_loader - INFO - AI understands this as: historical_mappings
2025-10-06 00:34:07 - utils.document_loader - INFO - Loading file: reference_data/historical_mappings_commercial.xlsx (type: .xlsx)
2025-10-06 00:34:07 - utils.document_loader - INFO - Found 1 sheets: ['Mappings']
2025-10-06 00:34:10 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 00:34:10 - utils.document_loader - INFO - AI understands this as: historical_mappings
2025-10-06 00:34:10 - utils.document_loader - INFO - Loading file: reference_data/old_mappings.csv (type: .csv)
2025-10-06 00:34:12 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 00:34:12 - utils.document_loader - ERROR - Error loading reference_data/old_mappings.csv: name 'true' is not defined
2025-10-06 00:34:12 - utils.document_loader - INFO - Loading file: reference_data/historical_mappings_homeowners.xlsx (type: .xlsx)
2025-10-06 00:34:12 - utils.document_loader - INFO - Found 1 sheets: ['Mappings']
2025-10-06 00:34:14 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 00:34:14 - utils.document_loader - INFO - AI understands this as: historical_mappings
2025-10-06 00:34:14 - utils.document_loader - INFO - 
============================================================
2025-10-06 00:34:14 - utils.document_loader - INFO - ‚úÖ LOADED REFERENCE DATA SUMMARY:
2025-10-06 00:34:14 - utils.document_loader - INFO - ============================================================
2025-10-06 00:34:14 - utils.document_loader - INFO -   üìö Historical mappings: 3 files
2025-10-06 00:34:14 - utils.document_loader - INFO -      - historical_mappings_personal_auto.xlsx (51 rows)
2025-10-06 00:34:14 - utils.document_loader - INFO -      - historical_mappings_commercial.xlsx (9 rows)
2025-10-06 00:34:14 - utils.document_loader - INFO -      - historical_mappings_homeowners.xlsx (14 rows)
2025-10-06 00:34:14 - utils.document_loader - INFO -   üìñ Data dictionaries: 1 files
2025-10-06 00:34:14 - utils.document_loader - INFO -      - data_dictionary_complete.xlsx (104 rows)
2025-10-06 00:34:14 - utils.document_loader - INFO -   üóÑÔ∏è Schema definitions: 0 files
2025-10-06 00:34:14 - utils.document_loader - INFO -   üìä Reference data: 0 files
2025-10-06 00:34:14 - utils.document_loader - INFO - ============================================================

2025-10-06 00:34:14 - main - INFO - ü§ñ Predicting mappings with AI (flexible mode)...
2025-10-06 00:34:14 - mapper.openai_mapper - INFO - üìä Grouped into 7 sections: ['General', 'PolicyData', 'AccountData', 'QuoteData', 'RiskData', 'CoverageData', 'PaymentData']
2025-10-06 00:34:14 - mapper.openai_mapper - WARNING - ‚ö†Ô∏è 'General' ‚Üí SILVER.POLICY (default)
2025-10-06 00:34:14 - mapper.openai_mapper - WARNING - ‚ö†Ô∏è No schema for SILVER.POLICY
2025-10-06 00:34:14 - mapper.openai_mapper - INFO - ‚úÖ 'PolicyData' ‚Üí SILVER.POLICY
2025-10-06 00:34:14 - mapper.openai_mapper - WARNING - ‚ö†Ô∏è No schema for SILVER.POLICY
2025-10-06 00:34:14 - mapper.openai_mapper - INFO - ‚úÖ 'AccountData' ‚Üí SILVER.ACCOUNT
2025-10-06 00:34:14 - mapper.openai_mapper - WARNING - ‚ö†Ô∏è No schema for SILVER.ACCOUNT
2025-10-06 00:34:14 - mapper.openai_mapper - INFO - ‚úÖ 'QuoteData' ‚Üí SILVER.QUOTE
2025-10-06 00:34:14 - mapper.openai_mapper - WARNING - ‚ö†Ô∏è No schema for SILVER.QUOTE
2025-10-06 00:34:14 - mapper.openai_mapper - INFO - ‚úÖ 'RiskData' ‚Üí SILVER.RISK
2025-10-06 00:34:14 - mapper.openai_mapper - WARNING - ‚ö†Ô∏è No schema for SILVER.RISK
2025-10-06 00:34:14 - mapper.openai_mapper - INFO - ‚úÖ 'CoverageData' ‚Üí SILVER.COVERAGE
2025-10-06 00:34:14 - mapper.openai_mapper - WARNING - ‚ö†Ô∏è No schema for SILVER.COVERAGE
2025-10-06 00:34:14 - mapper.openai_mapper - INFO - ‚úÖ 'PaymentData' ‚Üí SILVER.PAYMENT
2025-10-06 00:34:14 - mapper.openai_mapper - WARNING - ‚ö†Ô∏è No schema for SILVER.PAYMENT
2025-10-06 00:34:14 - main - INFO - üíæ Saving results...
2025-10-06 00:34:14 - main - INFO - üìÅ Saved 0 mappings to output/mappings_CP001_20251006_003414.csv
2025-10-06 00:34:14 - utils.decorators - ERROR - run failed after 28.67s: 'confidence_score'
2025-10-06 00:38:59 - utils.logging_config - INFO - Logging configured at INFO level
2025-10-06 00:39:01 - loaders.snowflake_loader - INFO - ‚úÖ Connected to Snowflake: INSURANCE.ETL_MAPPER with role ACCOUNTADMIN
2025-10-06 00:39:01 - mapper.openai_mapper - INFO - ‚úÖ Loaded 7 Silver layer tables
2025-10-06 00:39:04 - loaders.snowflake_loader - INFO - ‚úÖ Connected to Snowflake: INSURANCE.ETL_MAPPER with role ACCOUNTADMIN
2025-10-06 00:39:04 - mapper.openai_mapper - INFO - ‚úÖ Loaded 7 Silver layer tables
2025-10-06 00:39:04 - utils.decorators - INFO - Starting run...
2025-10-06 00:39:04 - main - INFO - üîç Auto-detecting product type...
2025-10-06 00:39:04 - utils.product_detector - INFO - ‚úÖ Detected product: CP001 with 36.8% confidence
2025-10-06 00:39:04 - main - INFO - ‚úÖ Detected: CP001 with 36.8% confidence
2025-10-06 00:39:04 - main - INFO - üìä Extracting XML metadata...
2025-10-06 00:39:04 - main - INFO - ‚úÖ Extracted 331 XML nodes
2025-10-06 00:39:04 - main - INFO - ‚òÅÔ∏è Loading to Snowflake stage layer...
2025-10-06 00:39:05 - loaders.snowflake_loader - INFO - ‚úÖ Loaded XML data to ETL_MAPPER.STAGE_XML_CP001
2025-10-06 00:39:05 - main - INFO - ‚úÖ Loaded to ETL_MAPPER.STAGE_XML_CP001
2025-10-06 00:39:05 - main - INFO - üóÑÔ∏è Fetching Silver layer schema from Snowflake...
2025-10-06 00:39:05 - utils.schema_manager - INFO - Fetching schema from INSURANCE.SILVER
2025-10-06 00:39:06 - utils.schema_manager - INFO - ‚úÖ Fetched 137 columns from 7 tables
2025-10-06 00:39:06 - main - INFO - ‚úÖ Fetched 137 columns from 7 tables
2025-10-06 00:39:06 - main - INFO - üìö Finding and loading reference data with AI...
2025-10-06 00:39:06 - utils.document_loader - INFO - üîç Found 9 potential reference files
2025-10-06 00:39:08 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 00:39:08 - utils.document_loader - INFO - üìÑ historical_mappings_personal_auto.xlsx: historical_mapping (relevance: 85%)
2025-10-06 00:39:09 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 00:39:09 - utils.document_loader - INFO - üìÑ historical_mappings_commercial.xlsx: historical_mapping (relevance: 85%)
2025-10-06 00:39:10 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 00:39:10 - utils.document_loader - INFO - üìÑ old_mappings.csv: historical_mapping (relevance: 85%)
2025-10-06 00:39:11 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 00:39:11 - utils.document_loader - INFO - üìÑ historical_mappings_homeowners.xlsx: historical_mapping (relevance: 85%)
2025-10-06 00:39:13 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 00:39:13 - utils.document_loader - INFO - üìÑ old_mappings_homeowners.csv: historical_mapping (relevance: 85%)
2025-10-06 00:39:14 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 00:39:14 - utils.document_loader - INFO - üìÑ old_mappings_personal_auto.csv: historical_mapping (relevance: 85%)
2025-10-06 00:39:15 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 00:39:15 - utils.document_loader - INFO - üìÑ old_mappings_commercial.csv: historical_mapping (relevance: 85%)
2025-10-06 00:39:17 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 00:39:17 - utils.document_loader - INFO - üìÑ data_dictionary.csv: data_dictionary (relevance: 90%)
2025-10-06 00:39:18 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 00:39:18 - utils.document_loader - INFO - üìÑ data_dictionary_complete.xlsx: data_dictionary (relevance: 90%)
2025-10-06 00:39:18 - utils.document_loader - INFO - Loading file: reference_data/data_dictionary.csv (type: .csv)
2025-10-06 00:39:20 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 00:39:20 - utils.document_loader - ERROR - Error loading reference_data/data_dictionary.csv: name 'true' is not defined
2025-10-06 00:39:20 - utils.document_loader - INFO - Loading file: reference_data/data_dictionary_complete.xlsx (type: .xlsx)
2025-10-06 00:39:20 - utils.document_loader - INFO - Found 3 sheets: ['DataDictionary', 'TableSummary', 'Metadata']
2025-10-06 00:39:22 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 00:39:22 - utils.document_loader - INFO - AI understands this as: data_dictionary
2025-10-06 00:39:22 - utils.document_loader - INFO - Loading file: reference_data/historical_mappings_personal_auto.xlsx (type: .xlsx)
2025-10-06 00:39:22 - utils.document_loader - INFO - Found 2 sheets: ['Mappings', 'Metadata']
2025-10-06 00:39:26 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 00:39:26 - utils.document_loader - INFO - AI understands this as: historical_mappings
2025-10-06 00:39:26 - utils.document_loader - INFO - Loading file: reference_data/historical_mappings_commercial.xlsx (type: .xlsx)
2025-10-06 00:39:26 - utils.document_loader - INFO - Found 1 sheets: ['Mappings']
2025-10-06 00:39:29 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 00:39:29 - utils.document_loader - INFO - AI understands this as: historical_mappings
2025-10-06 00:39:29 - utils.document_loader - INFO - Loading file: reference_data/old_mappings.csv (type: .csv)
2025-10-06 00:39:30 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 00:39:30 - utils.document_loader - ERROR - Error loading reference_data/old_mappings.csv: name 'true' is not defined
2025-10-06 00:39:30 - utils.document_loader - INFO - Loading file: reference_data/historical_mappings_homeowners.xlsx (type: .xlsx)
2025-10-06 00:39:30 - utils.document_loader - INFO - Found 1 sheets: ['Mappings']
2025-10-06 00:39:32 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 00:39:32 - utils.document_loader - INFO - AI understands this as: historical_mappings
2025-10-06 00:39:32 - utils.document_loader - INFO - 
============================================================
2025-10-06 00:39:32 - utils.document_loader - INFO - ‚úÖ LOADED REFERENCE DATA SUMMARY:
2025-10-06 00:39:32 - utils.document_loader - INFO - ============================================================
2025-10-06 00:39:32 - utils.document_loader - INFO -   üìö Historical mappings: 3 files
2025-10-06 00:39:32 - utils.document_loader - INFO -      - historical_mappings_personal_auto.xlsx (51 rows)
2025-10-06 00:39:32 - utils.document_loader - INFO -      - historical_mappings_commercial.xlsx (9 rows)
2025-10-06 00:39:32 - utils.document_loader - INFO -      - historical_mappings_homeowners.xlsx (14 rows)
2025-10-06 00:39:32 - utils.document_loader - INFO -   üìñ Data dictionaries: 1 files
2025-10-06 00:39:32 - utils.document_loader - INFO -      - data_dictionary_complete.xlsx (104 rows)
2025-10-06 00:39:32 - utils.document_loader - INFO -   üóÑÔ∏è Schema definitions: 0 files
2025-10-06 00:39:32 - utils.document_loader - INFO -   üìä Reference data: 0 files
2025-10-06 00:39:32 - utils.document_loader - INFO - ============================================================

2025-10-06 00:39:32 - main - INFO - ü§ñ Predicting mappings with AI (flexible mode)...
2025-10-06 00:39:32 - mapper.openai_mapper - INFO - üìä Grouped into 7 sections: ['General', 'PolicyData', 'AccountData', 'QuoteData', 'RiskData', 'CoverageData', 'PaymentData']
2025-10-06 00:39:32 - mapper.openai_mapper - WARNING - ‚ö†Ô∏è 'General' ‚Üí SILVER.POLICY (default)
2025-10-06 00:39:32 - mapper.openai_mapper - WARNING - ‚ö†Ô∏è No schema for SILVER.POLICY
2025-10-06 00:39:32 - mapper.openai_mapper - INFO - ‚úÖ 'PolicyData' ‚Üí SILVER.POLICY
2025-10-06 00:39:32 - mapper.openai_mapper - WARNING - ‚ö†Ô∏è No schema for SILVER.POLICY
2025-10-06 00:39:32 - mapper.openai_mapper - INFO - ‚úÖ 'AccountData' ‚Üí SILVER.ACCOUNT
2025-10-06 00:39:32 - mapper.openai_mapper - WARNING - ‚ö†Ô∏è No schema for SILVER.ACCOUNT
2025-10-06 00:39:32 - mapper.openai_mapper - INFO - ‚úÖ 'QuoteData' ‚Üí SILVER.QUOTE
2025-10-06 00:39:32 - mapper.openai_mapper - WARNING - ‚ö†Ô∏è No schema for SILVER.QUOTE
2025-10-06 00:39:32 - mapper.openai_mapper - INFO - ‚úÖ 'RiskData' ‚Üí SILVER.RISK
2025-10-06 00:39:32 - mapper.openai_mapper - WARNING - ‚ö†Ô∏è No schema for SILVER.RISK
2025-10-06 00:39:32 - mapper.openai_mapper - INFO - ‚úÖ 'CoverageData' ‚Üí SILVER.COVERAGE
2025-10-06 00:39:32 - mapper.openai_mapper - WARNING - ‚ö†Ô∏è No schema for SILVER.COVERAGE
2025-10-06 00:39:32 - mapper.openai_mapper - INFO - ‚úÖ 'PaymentData' ‚Üí SILVER.PAYMENT
2025-10-06 00:39:32 - mapper.openai_mapper - WARNING - ‚ö†Ô∏è No schema for SILVER.PAYMENT
2025-10-06 00:39:32 - main - INFO - üíæ Saving results...
2025-10-06 00:39:32 - utils.decorators - ERROR - run failed after 28.20s: name 'datetime' is not defined
2025-10-06 00:41:39 - utils.logging_config - INFO - Logging configured at INFO level
2025-10-06 00:41:42 - loaders.snowflake_loader - INFO - ‚úÖ Connected to Snowflake: INSURANCE.ETL_MAPPER with role ACCOUNTADMIN
2025-10-06 00:41:42 - mapper.openai_mapper - INFO - ‚úÖ Loaded 7 Silver layer tables
2025-10-06 00:41:48 - loaders.snowflake_loader - INFO - ‚úÖ Connected to Snowflake: INSURANCE.ETL_MAPPER with role ACCOUNTADMIN
2025-10-06 00:41:49 - mapper.openai_mapper - INFO - ‚úÖ Loaded 7 Silver layer tables
2025-10-06 00:41:49 - utils.decorators - INFO - Starting run...
2025-10-06 00:41:49 - main - INFO - üîç Auto-detecting product type...
2025-10-06 00:41:49 - utils.product_detector - INFO - ‚úÖ Detected product: CP001 with 36.8% confidence
2025-10-06 00:41:49 - main - INFO - ‚úÖ Detected: CP001 with 36.8% confidence
2025-10-06 00:41:49 - main - INFO - üìä Extracting XML metadata...
2025-10-06 00:41:49 - main - INFO - ‚úÖ Extracted 331 XML nodes
2025-10-06 00:41:49 - main - INFO - ‚òÅÔ∏è Loading to Snowflake stage layer...
2025-10-06 00:41:49 - loaders.snowflake_loader - INFO - ‚úÖ Loaded XML data to ETL_MAPPER.STAGE_XML_CP001
2025-10-06 00:41:49 - main - INFO - ‚úÖ Loaded to ETL_MAPPER.STAGE_XML_CP001
2025-10-06 00:41:49 - main - INFO - üóÑÔ∏è Fetching Silver layer schema from Snowflake...
2025-10-06 00:41:49 - utils.schema_manager - INFO - Fetching schema from INSURANCE.SILVER
2025-10-06 00:41:51 - utils.schema_manager - INFO - ‚úÖ Fetched 137 columns from 7 tables
2025-10-06 00:41:51 - main - INFO - ‚úÖ Fetched 137 columns from 7 tables
2025-10-06 00:41:51 - main - INFO - üìö Finding and loading reference data with AI...
2025-10-06 00:41:51 - utils.document_loader - INFO - üîç Found 9 potential reference files
2025-10-06 00:41:52 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 00:41:52 - utils.document_loader - INFO - üìÑ historical_mappings_personal_auto.xlsx: historical_mapping (relevance: 85%)
2025-10-06 00:41:55 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 00:41:55 - utils.document_loader - INFO - üìÑ historical_mappings_commercial.xlsx: historical_mapping (relevance: 85%)
2025-10-06 00:41:57 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 00:41:57 - utils.document_loader - INFO - üìÑ old_mappings.csv: historical_mapping (relevance: 85%)
2025-10-06 00:42:00 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 00:42:00 - utils.document_loader - INFO - üìÑ historical_mappings_homeowners.xlsx: historical_mapping (relevance: 85%)
2025-10-06 00:42:02 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 00:42:02 - utils.document_loader - INFO - üìÑ old_mappings_homeowners.csv: historical_mapping (relevance: 85%)
2025-10-06 00:42:04 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 00:42:04 - utils.document_loader - INFO - üìÑ old_mappings_personal_auto.csv: historical_mapping (relevance: 85%)
2025-10-06 00:42:07 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 00:42:07 - utils.document_loader - INFO - üìÑ old_mappings_commercial.csv: historical_mapping (relevance: 85%)
2025-10-06 00:42:09 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 00:42:09 - utils.document_loader - INFO - üìÑ data_dictionary.csv: data_dictionary (relevance: 90%)
2025-10-06 00:42:12 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 00:42:12 - utils.document_loader - INFO - üìÑ data_dictionary_complete.xlsx: data_dictionary (relevance: 90%)
2025-10-06 00:42:12 - utils.document_loader - INFO - Loading file: reference_data/data_dictionary.csv (type: .csv)
2025-10-06 00:42:14 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 00:42:14 - utils.document_loader - ERROR - Error loading reference_data/data_dictionary.csv: name 'true' is not defined
2025-10-06 00:42:14 - utils.document_loader - INFO - Loading file: reference_data/data_dictionary_complete.xlsx (type: .xlsx)
2025-10-06 00:42:14 - utils.document_loader - INFO - Found 3 sheets: ['DataDictionary', 'TableSummary', 'Metadata']
2025-10-06 00:42:16 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 00:42:16 - utils.document_loader - INFO - AI understands this as: data_dictionary
2025-10-06 00:42:16 - utils.document_loader - INFO - Loading file: reference_data/historical_mappings_personal_auto.xlsx (type: .xlsx)
2025-10-06 00:42:16 - utils.document_loader - INFO - Found 2 sheets: ['Mappings', 'Metadata']
2025-10-06 00:42:19 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 00:42:19 - utils.document_loader - INFO - AI understands this as: historical_mappings
2025-10-06 00:42:19 - utils.document_loader - INFO - Loading file: reference_data/historical_mappings_commercial.xlsx (type: .xlsx)
2025-10-06 00:42:19 - utils.document_loader - INFO - Found 1 sheets: ['Mappings']
2025-10-06 00:42:21 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 00:42:21 - utils.document_loader - INFO - AI understands this as: historical_mappings
2025-10-06 00:42:21 - utils.document_loader - INFO - Loading file: reference_data/old_mappings.csv (type: .csv)
2025-10-06 00:42:22 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 00:42:22 - utils.document_loader - ERROR - Error loading reference_data/old_mappings.csv: name 'true' is not defined
2025-10-06 00:42:22 - utils.document_loader - INFO - Loading file: reference_data/historical_mappings_homeowners.xlsx (type: .xlsx)
2025-10-06 00:42:22 - utils.document_loader - INFO - Found 1 sheets: ['Mappings']
2025-10-06 00:42:26 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 00:42:26 - utils.document_loader - INFO - AI understands this as: historical_mappings
2025-10-06 00:42:26 - utils.document_loader - INFO - 
============================================================
2025-10-06 00:42:26 - utils.document_loader - INFO - ‚úÖ LOADED REFERENCE DATA SUMMARY:
2025-10-06 00:42:26 - utils.document_loader - INFO - ============================================================
2025-10-06 00:42:26 - utils.document_loader - INFO -   üìö Historical mappings: 3 files
2025-10-06 00:42:26 - utils.document_loader - INFO -      - historical_mappings_personal_auto.xlsx (51 rows)
2025-10-06 00:42:26 - utils.document_loader - INFO -      - historical_mappings_commercial.xlsx (9 rows)
2025-10-06 00:42:26 - utils.document_loader - INFO -      - historical_mappings_homeowners.xlsx (14 rows)
2025-10-06 00:42:26 - utils.document_loader - INFO -   üìñ Data dictionaries: 1 files
2025-10-06 00:42:26 - utils.document_loader - INFO -      - data_dictionary_complete.xlsx (104 rows)
2025-10-06 00:42:26 - utils.document_loader - INFO -   üóÑÔ∏è Schema definitions: 0 files
2025-10-06 00:42:26 - utils.document_loader - INFO -   üìä Reference data: 0 files
2025-10-06 00:42:26 - utils.document_loader - INFO - ============================================================

2025-10-06 00:42:26 - main - INFO - ü§ñ Predicting mappings with AI (flexible mode)...
2025-10-06 00:42:26 - mapper.openai_mapper - INFO - üìä Grouped into 7 sections: ['General', 'PolicyData', 'AccountData', 'QuoteData', 'RiskData', 'CoverageData', 'PaymentData']
2025-10-06 00:42:26 - mapper.openai_mapper - WARNING - ‚ö†Ô∏è 'General' ‚Üí SILVER.POLICY (default)
2025-10-06 00:42:26 - mapper.openai_mapper - WARNING - ‚ö†Ô∏è No schema for SILVER.POLICY
2025-10-06 00:42:26 - mapper.openai_mapper - INFO - ‚úÖ 'PolicyData' ‚Üí SILVER.POLICY
2025-10-06 00:42:26 - mapper.openai_mapper - WARNING - ‚ö†Ô∏è No schema for SILVER.POLICY
2025-10-06 00:42:26 - mapper.openai_mapper - INFO - ‚úÖ 'AccountData' ‚Üí SILVER.ACCOUNT
2025-10-06 00:42:26 - mapper.openai_mapper - WARNING - ‚ö†Ô∏è No schema for SILVER.ACCOUNT
2025-10-06 00:42:26 - mapper.openai_mapper - INFO - ‚úÖ 'QuoteData' ‚Üí SILVER.QUOTE
2025-10-06 00:42:26 - mapper.openai_mapper - WARNING - ‚ö†Ô∏è No schema for SILVER.QUOTE
2025-10-06 00:42:26 - mapper.openai_mapper - INFO - ‚úÖ 'RiskData' ‚Üí SILVER.RISK
2025-10-06 00:42:26 - mapper.openai_mapper - WARNING - ‚ö†Ô∏è No schema for SILVER.RISK
2025-10-06 00:42:26 - mapper.openai_mapper - INFO - ‚úÖ 'CoverageData' ‚Üí SILVER.COVERAGE
2025-10-06 00:42:26 - mapper.openai_mapper - WARNING - ‚ö†Ô∏è No schema for SILVER.COVERAGE
2025-10-06 00:42:26 - mapper.openai_mapper - INFO - ‚úÖ 'PaymentData' ‚Üí SILVER.PAYMENT
2025-10-06 00:42:26 - mapper.openai_mapper - WARNING - ‚ö†Ô∏è No schema for SILVER.PAYMENT
2025-10-06 00:42:26 - main - INFO - üíæ Saving results...
2025-10-06 00:42:26 - main - INFO - ‚úÖ Saved 0 mappings to output/mappings_CP001_20251006_004226.csv
2025-10-06 00:42:26 - main - INFO - ‚úÖ Pipeline completed successfully!
2025-10-06 00:42:26 - utils.decorators - INFO - run completed in 37.26s
2025-10-06 00:42:29 - utils.database_helper - INFO - ‚úÖ Saved XML to stage: XML-20251006004228
2025-10-06 00:42:31 - utils.database_helper - INFO - ‚úÖ Saved 0 mappings
2025-10-06 00:44:51 - utils.logging_config - INFO - Logging configured at INFO level
2025-10-06 00:44:53 - loaders.snowflake_loader - INFO - ‚úÖ Connected to Snowflake: INSURANCE.ETL_MAPPER with role ACCOUNTADMIN
2025-10-06 00:44:53 - mapper.openai_mapper - INFO - ‚úÖ Loaded 7 Silver layer tables
2025-10-06 00:44:57 - loaders.snowflake_loader - INFO - ‚úÖ Connected to Snowflake: INSURANCE.ETL_MAPPER with role ACCOUNTADMIN
2025-10-06 00:44:57 - mapper.openai_mapper - INFO - ‚úÖ Loaded 7 Silver layer tables
2025-10-06 00:44:57 - utils.decorators - INFO - Starting run...
2025-10-06 00:44:57 - main - INFO - üîç Auto-detecting product type...
2025-10-06 00:44:57 - utils.product_detector - INFO - ‚úÖ Detected product: CP001 with 36.8% confidence
2025-10-06 00:44:57 - main - INFO - ‚úÖ Detected: CP001 with 36.8% confidence
2025-10-06 00:44:57 - main - INFO - üìä Extracting XML metadata...
2025-10-06 00:44:57 - main - INFO - ‚úÖ Extracted 331 XML nodes
2025-10-06 00:44:57 - main - INFO - ‚òÅÔ∏è Loading to Snowflake stage layer...
2025-10-06 00:44:58 - loaders.snowflake_loader - INFO - ‚úÖ Loaded XML data to ETL_MAPPER.STAGE_XML_CP001
2025-10-06 00:44:58 - main - INFO - ‚úÖ Loaded to ETL_MAPPER.STAGE_XML_CP001
2025-10-06 00:44:58 - main - INFO - üóÑÔ∏è Fetching Silver layer schema from Snowflake...
2025-10-06 00:44:58 - utils.schema_manager - INFO - Fetching schema from INSURANCE.SILVER
2025-10-06 00:44:59 - utils.schema_manager - INFO - ‚úÖ Fetched 137 columns from 7 tables
2025-10-06 00:44:59 - main - INFO - ‚úÖ Fetched 137 columns from 7 tables
2025-10-06 00:44:59 - main - INFO - üìö Finding and loading reference data with AI...
2025-10-06 00:44:59 - utils.document_loader - INFO - üîç Found 9 potential reference files
2025-10-06 00:45:00 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 00:45:00 - utils.document_loader - INFO - üìÑ historical_mappings_personal_auto.xlsx: historical_mapping (relevance: 85%)
2025-10-06 00:45:02 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 00:45:02 - utils.document_loader - INFO - üìÑ historical_mappings_commercial.xlsx: historical_mapping (relevance: 85%)
2025-10-06 00:45:04 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 00:45:04 - utils.document_loader - INFO - üìÑ old_mappings.csv: historical_mapping (relevance: 85%)
2025-10-06 00:45:05 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 00:45:05 - utils.document_loader - INFO - üìÑ historical_mappings_homeowners.xlsx: historical_mapping (relevance: 85%)
2025-10-06 00:45:06 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 00:45:06 - utils.document_loader - INFO - üìÑ old_mappings_homeowners.csv: historical_mapping (relevance: 85%)
2025-10-06 00:45:08 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 00:45:08 - utils.document_loader - INFO - üìÑ old_mappings_personal_auto.csv: historical_mapping (relevance: 85%)
2025-10-06 00:45:11 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 00:45:11 - utils.document_loader - INFO - üìÑ old_mappings_commercial.csv: historical_mapping (relevance: 85%)
2025-10-06 00:45:12 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 00:45:12 - utils.document_loader - INFO - üìÑ data_dictionary.csv: data_dictionary (relevance: 90%)
2025-10-06 00:45:15 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 00:45:15 - utils.document_loader - INFO - üìÑ data_dictionary_complete.xlsx: data_dictionary (relevance: 90%)
2025-10-06 00:45:15 - utils.document_loader - INFO - Loading file: reference_data/data_dictionary.csv (type: .csv)
2025-10-06 00:45:17 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 00:45:17 - utils.document_loader - ERROR - Error loading reference_data/data_dictionary.csv: name 'true' is not defined
2025-10-06 00:45:17 - utils.document_loader - INFO - Loading file: reference_data/data_dictionary_complete.xlsx (type: .xlsx)
2025-10-06 00:45:18 - utils.document_loader - INFO - Found 3 sheets: ['DataDictionary', 'TableSummary', 'Metadata']
2025-10-06 00:45:20 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 00:45:20 - utils.document_loader - INFO - AI understands this as: data_dictionary
2025-10-06 00:45:20 - utils.document_loader - INFO - Loading file: reference_data/historical_mappings_personal_auto.xlsx (type: .xlsx)
2025-10-06 00:45:20 - utils.document_loader - INFO - Found 2 sheets: ['Mappings', 'Metadata']
2025-10-06 00:45:23 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 00:45:23 - utils.document_loader - INFO - AI understands this as: historical_mappings
2025-10-06 00:45:23 - utils.document_loader - INFO - Loading file: reference_data/historical_mappings_commercial.xlsx (type: .xlsx)
2025-10-06 00:45:23 - utils.document_loader - INFO - Found 1 sheets: ['Mappings']
2025-10-06 00:45:25 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 00:45:25 - utils.document_loader - INFO - AI understands this as: historical_mappings
2025-10-06 00:45:25 - utils.document_loader - INFO - Loading file: reference_data/old_mappings.csv (type: .csv)
2025-10-06 00:45:26 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 00:45:26 - utils.document_loader - ERROR - Error loading reference_data/old_mappings.csv: name 'true' is not defined
2025-10-06 00:45:26 - utils.document_loader - INFO - Loading file: reference_data/historical_mappings_homeowners.xlsx (type: .xlsx)
2025-10-06 00:45:26 - utils.document_loader - INFO - Found 1 sheets: ['Mappings']
2025-10-06 00:45:30 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 00:45:30 - utils.document_loader - INFO - AI understands this as: historical_mappings
2025-10-06 00:45:30 - utils.document_loader - INFO - 
============================================================
2025-10-06 00:45:30 - utils.document_loader - INFO - ‚úÖ LOADED REFERENCE DATA SUMMARY:
2025-10-06 00:45:30 - utils.document_loader - INFO - ============================================================
2025-10-06 00:45:30 - utils.document_loader - INFO -   üìö Historical mappings: 3 files
2025-10-06 00:45:30 - utils.document_loader - INFO -      - historical_mappings_personal_auto.xlsx (51 rows)
2025-10-06 00:45:30 - utils.document_loader - INFO -      - historical_mappings_commercial.xlsx (9 rows)
2025-10-06 00:45:30 - utils.document_loader - INFO -      - historical_mappings_homeowners.xlsx (14 rows)
2025-10-06 00:45:30 - utils.document_loader - INFO -   üìñ Data dictionaries: 1 files
2025-10-06 00:45:30 - utils.document_loader - INFO -      - data_dictionary_complete.xlsx (104 rows)
2025-10-06 00:45:30 - utils.document_loader - INFO -   üóÑÔ∏è Schema definitions: 0 files
2025-10-06 00:45:30 - utils.document_loader - INFO -   üìä Reference data: 0 files
2025-10-06 00:45:30 - utils.document_loader - INFO - ============================================================

2025-10-06 00:45:30 - main - INFO - ü§ñ Predicting mappings with AI (flexible mode)...
2025-10-06 00:45:30 - mapper.openai_mapper - INFO - üìä Grouped into 7 sections: ['General', 'PolicyData', 'AccountData', 'QuoteData', 'RiskData', 'CoverageData', 'PaymentData']
2025-10-06 00:45:30 - mapper.openai_mapper - WARNING - ‚ö†Ô∏è 'General' ‚Üí SILVER.POLICY (default)
2025-10-06 00:45:30 - mapper.openai_mapper - WARNING - ‚ö†Ô∏è No schema for SILVER.POLICY
2025-10-06 00:45:30 - mapper.openai_mapper - INFO - ‚úÖ 'PolicyData' ‚Üí SILVER.POLICY
2025-10-06 00:45:30 - mapper.openai_mapper - WARNING - ‚ö†Ô∏è No schema for SILVER.POLICY
2025-10-06 00:45:30 - mapper.openai_mapper - INFO - ‚úÖ 'AccountData' ‚Üí SILVER.ACCOUNT
2025-10-06 00:45:30 - mapper.openai_mapper - WARNING - ‚ö†Ô∏è No schema for SILVER.ACCOUNT
2025-10-06 00:45:30 - mapper.openai_mapper - INFO - ‚úÖ 'QuoteData' ‚Üí SILVER.QUOTE
2025-10-06 00:45:30 - mapper.openai_mapper - WARNING - ‚ö†Ô∏è No schema for SILVER.QUOTE
2025-10-06 00:45:30 - mapper.openai_mapper - INFO - ‚úÖ 'RiskData' ‚Üí SILVER.RISK
2025-10-06 00:45:30 - mapper.openai_mapper - WARNING - ‚ö†Ô∏è No schema for SILVER.RISK
2025-10-06 00:45:30 - mapper.openai_mapper - INFO - ‚úÖ 'CoverageData' ‚Üí SILVER.COVERAGE
2025-10-06 00:45:30 - mapper.openai_mapper - WARNING - ‚ö†Ô∏è No schema for SILVER.COVERAGE
2025-10-06 00:45:30 - mapper.openai_mapper - INFO - ‚úÖ 'PaymentData' ‚Üí SILVER.PAYMENT
2025-10-06 00:45:30 - mapper.openai_mapper - WARNING - ‚ö†Ô∏è No schema for SILVER.PAYMENT
2025-10-06 00:45:30 - main - INFO - üíæ Saving results...
2025-10-06 00:45:30 - main - INFO - ‚úÖ Saved 0 mappings to output/mappings_CP001_20251006_004530.csv
2025-10-06 00:45:30 - main - INFO - ‚úÖ Pipeline completed successfully!
2025-10-06 00:45:30 - utils.decorators - INFO - run completed in 33.33s
2025-10-06 00:51:07 - utils.logging_config - INFO - Logging configured at INFO level
2025-10-06 00:51:10 - loaders.snowflake_loader - INFO - ‚úÖ Connected to Snowflake: INSURANCE.ETL_MAPPER with role ACCOUNTADMIN
2025-10-06 00:51:10 - mapper.openai_mapper - INFO - ‚úÖ Loaded 7 Silver layer tables
2025-10-06 00:51:23 - loaders.snowflake_loader - INFO - ‚úÖ Connected to Snowflake: INSURANCE.ETL_MAPPER with role ACCOUNTADMIN
2025-10-06 00:51:23 - mapper.openai_mapper - INFO - ‚úÖ Loaded 7 Silver layer tables
2025-10-06 00:51:23 - utils.decorators - INFO - Starting run...
2025-10-06 00:51:23 - main - INFO - üîç Auto-detecting product type...
2025-10-06 00:51:23 - utils.product_detector - INFO - ‚úÖ Detected product: CP001 with 36.8% confidence
2025-10-06 00:51:23 - main - INFO - ‚úÖ Detected: CP001 with 36.8% confidence
2025-10-06 00:51:23 - main - INFO - üìä Extracting XML metadata...
2025-10-06 00:51:23 - main - INFO - ‚úÖ Extracted 331 XML nodes
2025-10-06 00:51:23 - main - INFO - ‚òÅÔ∏è Loading to Snowflake stage layer...
2025-10-06 00:51:24 - loaders.snowflake_loader - INFO - ‚úÖ Loaded XML data to ETL_MAPPER.STAGE_XML_CP001
2025-10-06 00:51:24 - main - INFO - ‚úÖ Loaded to ETL_MAPPER.STAGE_XML_CP001
2025-10-06 00:51:24 - main - INFO - üóÑÔ∏è Fetching Silver layer schema from Snowflake...
2025-10-06 00:51:24 - utils.schema_manager - INFO - Fetching schema from INSURANCE.SILVER
2025-10-06 00:51:25 - utils.schema_manager - INFO - ‚úÖ Fetched 137 columns from 7 tables
2025-10-06 00:51:25 - main - INFO - ‚úÖ Fetched 137 columns from 7 tables
2025-10-06 00:51:25 - main - INFO - üìö Finding and loading reference data with AI...
2025-10-06 00:51:25 - utils.document_loader - INFO - üîç Found 9 potential reference files
2025-10-06 00:51:27 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 00:51:27 - utils.document_loader - INFO - üìÑ historical_mappings_personal_auto.xlsx: historical_mapping (relevance: 85%)
2025-10-06 00:51:28 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 00:51:28 - utils.document_loader - INFO - üìÑ historical_mappings_commercial.xlsx: historical_mapping (relevance: 85%)
2025-10-06 00:51:30 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 00:51:30 - utils.document_loader - INFO - üìÑ old_mappings.csv: historical_mapping (relevance: 85%)
2025-10-06 00:51:31 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 00:51:31 - utils.document_loader - INFO - üìÑ historical_mappings_homeowners.xlsx: historical_mapping (relevance: 85%)
2025-10-06 00:51:33 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 00:51:33 - utils.document_loader - INFO - üìÑ old_mappings_homeowners.csv: historical_mapping (relevance: 85%)
2025-10-06 00:51:34 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 00:51:34 - utils.document_loader - INFO - üìÑ old_mappings_personal_auto.csv: historical_mapping (relevance: 85%)
2025-10-06 00:51:35 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 00:51:35 - utils.document_loader - INFO - üìÑ old_mappings_commercial.csv: historical_mapping (relevance: 85%)
2025-10-06 00:51:36 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 00:51:36 - utils.document_loader - INFO - üìÑ data_dictionary.csv: data_dictionary (relevance: 90%)
2025-10-06 00:51:37 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 00:51:37 - utils.document_loader - INFO - üìÑ data_dictionary_complete.xlsx: data_dictionary (relevance: 90%)
2025-10-06 00:51:37 - utils.document_loader - INFO - Loading file: reference_data/data_dictionary.csv (type: .csv)
2025-10-06 00:51:39 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 00:51:39 - utils.document_loader - ERROR - Error loading reference_data/data_dictionary.csv: name 'true' is not defined
2025-10-06 00:51:39 - utils.document_loader - INFO - Loading file: reference_data/data_dictionary_complete.xlsx (type: .xlsx)
2025-10-06 00:51:39 - utils.document_loader - INFO - Found 3 sheets: ['DataDictionary', 'TableSummary', 'Metadata']
2025-10-06 00:51:42 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 00:51:42 - utils.document_loader - INFO - AI understands this as: data_dictionary
2025-10-06 00:51:42 - utils.document_loader - INFO - Loading file: reference_data/historical_mappings_personal_auto.xlsx (type: .xlsx)
2025-10-06 00:51:42 - utils.document_loader - INFO - Found 2 sheets: ['Mappings', 'Metadata']
2025-10-06 00:51:45 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 00:51:45 - utils.document_loader - INFO - AI understands this as: historical_mappings
2025-10-06 00:51:45 - utils.document_loader - INFO - Loading file: reference_data/historical_mappings_commercial.xlsx (type: .xlsx)
2025-10-06 00:51:45 - utils.document_loader - INFO - Found 1 sheets: ['Mappings']
2025-10-06 00:51:47 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 00:51:47 - utils.document_loader - INFO - AI understands this as: historical_mappings
2025-10-06 00:51:47 - utils.document_loader - INFO - Loading file: reference_data/old_mappings.csv (type: .csv)
2025-10-06 00:51:50 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 00:51:50 - utils.document_loader - ERROR - Error loading reference_data/old_mappings.csv: name 'true' is not defined
2025-10-06 00:51:50 - utils.document_loader - INFO - Loading file: reference_data/historical_mappings_homeowners.xlsx (type: .xlsx)
2025-10-06 00:51:50 - utils.document_loader - INFO - Found 1 sheets: ['Mappings']
2025-10-06 00:51:52 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 00:51:52 - utils.document_loader - INFO - AI understands this as: historical_mappings
2025-10-06 00:51:52 - utils.document_loader - INFO - 
============================================================
2025-10-06 00:51:52 - utils.document_loader - INFO - ‚úÖ LOADED REFERENCE DATA SUMMARY:
2025-10-06 00:51:52 - utils.document_loader - INFO - ============================================================
2025-10-06 00:51:52 - utils.document_loader - INFO -   üìö Historical mappings: 3 files
2025-10-06 00:51:52 - utils.document_loader - INFO -      - historical_mappings_personal_auto.xlsx (51 rows)
2025-10-06 00:51:52 - utils.document_loader - INFO -      - historical_mappings_commercial.xlsx (9 rows)
2025-10-06 00:51:52 - utils.document_loader - INFO -      - historical_mappings_homeowners.xlsx (14 rows)
2025-10-06 00:51:52 - utils.document_loader - INFO -   üìñ Data dictionaries: 1 files
2025-10-06 00:51:52 - utils.document_loader - INFO -      - data_dictionary_complete.xlsx (104 rows)
2025-10-06 00:51:52 - utils.document_loader - INFO -   üóÑÔ∏è Schema definitions: 0 files
2025-10-06 00:51:52 - utils.document_loader - INFO -   üìä Reference data: 0 files
2025-10-06 00:51:52 - utils.document_loader - INFO - ============================================================

2025-10-06 00:51:52 - main - INFO - ü§ñ Predicting mappings with AI (flexible mode)...
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG - üì• Input type: <class 'pandas.core.frame.DataFrame'>
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG - üìä DataFrame with 331 rows
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG - üìä Columns: ['node_path', 'node_name', 'attributes', 'sample_value', 'data_type', 'parent_path']
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/TransactionInfo
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/TransactionInfo/TransactionID
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/TransactionInfo/TransactionType
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/TransactionInfo/TransactionDate
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/TransactionInfo/TransactionStatus
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/TransactionInfo/SourceSystem
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/TransactionInfo/SourceVersion
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/TransactionInfo/ProcessedBy
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/PolicyData
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/PolicyData/ID
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/PolicyData/Number
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/PolicyData/Version
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/PolicyData/LineOfBusiness
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/PolicyData/StatusCode
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/PolicyData/StatusDescription
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/PolicyData/ProductDetails
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/PolicyData/ProductDetails/ProdCode
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/PolicyData/ProductDetails/ProdDescription
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/PolicyData/ProductDetails/ProdVersion
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/PolicyData/ProductDetails/LOB
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/PolicyData/ProductDetails/Category
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/PolicyData/ProductDetails/SubCategory
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/PolicyData/PolicyDates
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/PolicyData/PolicyDates/InceptionDate
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/PolicyData/PolicyDates/TerminationDate
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/PolicyData/PolicyDates/BindDate
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/PolicyData/PolicyDates/QuoteDate
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/PolicyData/TermLength
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/PolicyData/TermLengthUnit
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/PolicyData/PremiumInfo
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/PolicyData/PremiumInfo/BasePremium
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/PolicyData/PremiumInfo/AnnualPremium
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/PolicyData/PremiumInfo/MinimumPremium
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/PolicyData/PremiumInfo/DepositPremium
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/PolicyData/PremiumInfo/TaxAmount
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/PolicyData/PremiumInfo/SurchargeAmount
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/PolicyData/PremiumInfo/DiscountAmount
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/PolicyData/PremiumInfo/FeeAmount
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/PolicyData/PremiumInfo/TotalPremium
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/PolicyData/PremiumInfo/CoveredAmount
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/PolicyData/UnderwritingInfo
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/PolicyData/UnderwritingInfo/Carrier
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/PolicyData/UnderwritingInfo/UnderwritingCompany
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/PolicyData/UnderwritingInfo/UnderwritingState
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/PolicyData/UnderwritingInfo/RiskTier
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/PolicyData/UnderwritingInfo/UnderwriterID
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/PolicyData/UnderwritingInfo/UnderwriterName
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/PolicyData/UnderwritingInfo/UnderwriterAuthority
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/PolicyData/UnderwritingInfo/InspectionRequired
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/PolicyData/UnderwritingInfo/InspectionDate
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/PolicyData/SalesChannel
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/PolicyData/SalesChannel/ChannelName
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/PolicyData/SalesChannel/SubChannel
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/PolicyData/SalesChannel/Region
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/PolicyData/SalesChannel/Territory
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/AccountData
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/AccountData/AccountIdentifier
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/AccountData/AccountNumber
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/AccountData/AccountName
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/AccountData/AccountType
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/AccountData/AccountStatus
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/AccountData/BusinessInfo
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/AccountData/BusinessInfo/LegalName
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/AccountData/BusinessInfo/DBAName
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/AccountData/BusinessInfo/BusinessType
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/AccountData/BusinessInfo/IndustryCode
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/AccountData/BusinessInfo/IndustryDescription
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/AccountData/BusinessInfo/YearsInBusiness
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/AccountData/BusinessInfo/NumberOfEmployees
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/AccountData/BusinessInfo/AnnualRevenue
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/AccountData/BusinessInfo/FederalTaxID
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/AccountData/BusinessInfo/EntityType
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/AccountData/BusinessInfo/StateOfIncorporation
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/AccountData/BusinessInfo/IncorporationDate
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/AccountData/PrimaryContact
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/AccountData/PrimaryContact/ContactName
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/AccountData/PrimaryContact/Title
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/AccountData/PrimaryContact/DateOfBirth
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/AccountData/PrimaryContact/Email
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/AccountData/PrimaryContact/Phone
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/AccountData/PrimaryContact/Phone/PhoneType
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/AccountData/PrimaryContact/Phone/PhoneNumber
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/AccountData/PrimaryContact/Phone/Extension
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/AccountData/BusinessAddress
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/AccountData/BusinessAddress/AddressType
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/AccountData/BusinessAddress/AddressLine1
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/AccountData/BusinessAddress/AddressLine2
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/AccountData/BusinessAddress/City
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/AccountData/BusinessAddress/State
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/AccountData/BusinessAddress/ZipCode
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/AccountData/BusinessAddress/County
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/AccountData/BusinessAddress/Country
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/AccountData/MailingAddress
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/AccountData/MailingAddress/IsSameAsBusiness
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/AccountData/MailingAddress/AddressLine1
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/AccountData/MailingAddress/City
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/AccountData/MailingAddress/State
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/AccountData/MailingAddress/ZipCode
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/BrokerData
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/BrokerData/BrokerID
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/BrokerData/BrokerName
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/BrokerData/BrokerType
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/BrokerData/BrokerageFirm
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/BrokerData/BrokerageCode
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/BrokerData/BrokerEmail
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/BrokerData/BrokerPhone
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/BrokerData/CommissionRate
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/BrokerData/CommissionAmount
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/BrokerData/LicenseNumber
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/BrokerData/LicenseState
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/BrokerData/AppointedDate
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/QuoteData
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/QuoteData/QuoteIdentifier
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/QuoteData/QuoteNumber
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/QuoteData/QuoteDate
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/QuoteData/QuoteExpiryDate
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/QuoteData/ConversionDate
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/QuoteData/QuoteStatus
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/RiskData
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/RiskData/RiskIdentifier
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/RiskData/RiskSequence
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/RiskData/RiskClass
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/RiskData/RiskSummary
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/RiskData/LocationDetails
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/RiskData/LocationDetails/LocationNumber
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/RiskData/LocationDetails/LocationName
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/RiskData/LocationDetails/AddressLine1
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/RiskData/LocationDetails/AddressLine2
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/RiskData/LocationDetails/City
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/RiskData/LocationDetails/State
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/RiskData/LocationDetails/ZipCode
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/RiskData/LocationDetails/County
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/RiskData/LocationDetails/Country
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/RiskData/LocationDetails/Latitude
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/RiskData/LocationDetails/Longitude
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/RiskData/LocationDetails/FloodZone
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/RiskData/LocationDetails/WindZone
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/RiskData/LocationDetails/EarthquakeZone
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/RiskData/LocationDetails/TerrorismRiskZone
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/RiskData/BuildingDetails
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/RiskData/BuildingDetails/BuildingNumber
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/RiskData/BuildingDetails/BuildingType
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/RiskData/BuildingDetails/ConstructionClass
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/RiskData/BuildingDetails/ConstructionType
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/RiskData/BuildingDetails/ConstructionMaterial
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/RiskData/BuildingDetails/YearBuilt
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/RiskData/BuildingDetails/YearRenovated
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/RiskData/BuildingDetails/NumberOfStories
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/RiskData/BuildingDetails/TotalSquareFootage
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/RiskData/BuildingDetails/OccupiedSquareFootage
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/RiskData/BuildingDetails/VacantSquareFootage
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/RiskData/BuildingDetails/RoofType
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/RiskData/BuildingDetails/RoofMaterial
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/RiskData/BuildingDetails/RoofAge
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/RiskData/BuildingDetails/RoofCondition
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/RiskData/BuildingDetails/ExteriorWalls
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/RiskData/BuildingDetails/HasBasement
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/RiskData/BuildingDetails/BasementLevels
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/RiskData/BuildingDetails/ElevatorCount
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/RiskData/BuildingDetails/ParkingType
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/RiskData/BuildingDetails/ParkingSpaces
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/RiskData/OccupancyInfo
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/RiskData/OccupancyInfo/PrimaryOccupancy
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/RiskData/OccupancyInfo/OccupancyCode
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/RiskData/OccupancyInfo/SecondaryOccupancy
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/RiskData/OccupancyInfo/TenantCount
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/RiskData/OccupancyInfo/OwnerOccupiedPercent
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/RiskData/OccupancyInfo/HasRestaurant
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/RiskData/OccupancyInfo/HasRetail
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/RiskData/OccupancyInfo/HasResidential
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/RiskData/OccupancyInfo/HasHazardousMaterials
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/RiskData/OccupancyInfo/AverageOccupancyHours
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/RiskData/OccupancyInfo/WeekendOccupancy
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/RiskData/ValuationInfo
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/RiskData/ValuationInfo/BuildingValue
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/RiskData/ValuationInfo/ContentsValue
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/RiskData/ValuationInfo/BusinessPersonalProperty
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/RiskData/ValuationInfo/TenantImprovements
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/RiskData/ValuationInfo/LandValue
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/RiskData/ValuationInfo/TotalInsurableValue
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/RiskData/ValuationInfo/ReplacementCost
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/RiskData/ValuationInfo/ActualCashValue
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/RiskData/ValuationInfo/AppraisalDate
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/RiskData/ValuationInfo/AppraisalCompany
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/RiskData/ProtectionInfo
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/RiskData/ProtectionInfo/FireProtectionClass
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/RiskData/ProtectionInfo/FireHydrantDistance
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/RiskData/ProtectionInfo/FireStationDistance
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/RiskData/ProtectionInfo/HasSprinklerSystem
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/RiskData/ProtectionInfo/SprinklerType
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/RiskData/ProtectionInfo/SprinklerCoverage
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/RiskData/ProtectionInfo/HasFireAlarm
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/RiskData/ProtectionInfo/FireAlarmType
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/RiskData/ProtectionInfo/HasBurglarAlarm
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/RiskData/ProtectionInfo/BurglarAlarmType
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/RiskData/ProtectionInfo/HasSecurityGuard
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/RiskData/ProtectionInfo/SecurityGuardHours
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/RiskData/ProtectionInfo/HasCCTV
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/RiskData/ProtectionInfo/HasAccessControl
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/RiskData/ProtectionInfo/MonitoringCompany
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/RiskData/MechanicalSystems
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/RiskData/MechanicalSystems/HVACType
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/RiskData/MechanicalSystems/HVACAge
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/RiskData/MechanicalSystems/HeatingType
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/RiskData/MechanicalSystems/CoolingType
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/RiskData/MechanicalSystems/ElectricalCapacity
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/RiskData/MechanicalSystems/HasBackupGenerator
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/RiskData/MechanicalSystems/GeneratorCapacity
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/RiskData/MechanicalSystems/PlumbingType
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/RiskData/MechanicalSystems/WaterHeaterType
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/RiskData/MechanicalSystems/WaterHeaterAge
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/RiskData/MortgageInfo
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/RiskData/MortgageInfo/IsMortgaged
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/RiskData/MortgageInfo/MortgageHolder
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/RiskData/MortgageInfo/LoanNumber
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/RiskData/MortgageInfo/OutstandingBalance
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/RiskData/MortgageInfo/LoanToValue
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/RiskData/MortgageInfo/MortgageAddress
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/RiskData/MortgageInfo/MortgageAddress/AddressLine1
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/RiskData/MortgageInfo/MortgageAddress/City
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/RiskData/MortgageInfo/MortgageAddress/State
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/RiskData/MortgageInfo/MortgageAddress/ZipCode
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/RiskData/LossHistory
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/RiskData/LossHistory/HasPriorLosses
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/RiskData/LossHistory/Loss
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/RiskData/LossHistory/Loss/LossDate
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/RiskData/LossHistory/Loss/LossType
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/RiskData/LossHistory/Loss/LossCause
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/RiskData/LossHistory/Loss/LossAmount
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/RiskData/LossHistory/Loss/LossDescription
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/RiskData/LossHistory/Loss/ClaimNumber
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/RiskData/LossHistory/Loss/ClaimStatus
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/RiskData/LossHistory/Loss/ClaimPaid
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/RiskData/ComplianceInfo
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/RiskData/ComplianceInfo/BuildingCodeCompliant
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/RiskData/ComplianceInfo/FireCodeCompliant
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/RiskData/ComplianceInfo/ADACompliant
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/RiskData/ComplianceInfo/EnvironmentalCompliant
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/RiskData/ComplianceInfo/LastInspectionDate
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/RiskData/ComplianceInfo/InspectionAgency
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/RiskData/ComplianceInfo/ViolationsOutstanding
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/CoverageData
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/CoverageData/CoverageRecord
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/CoverageData/CoverageRecord/CoverageIdentifier
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/CoverageData/CoverageRecord/RiskIdentifier
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/CoverageData/CoverageRecord/CoverageSymbol
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/CoverageData/CoverageRecord/CoverageDescription
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/CoverageData/CoverageRecord/CoverageClass
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/CoverageData/CoverageRecord/MaxLimit
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/CoverageData/CoverageRecord/CoverageDeductible
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/CoverageData/CoverageRecord/CoverageBasis
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/CoverageData/CoverageRecord/CoinsurancePercent
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/CoverageData/CoverageRecord/CoveragePremium
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/CoverageData/CoverageRecord/CoverageStartDate
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/CoverageData/CoverageRecord/CoverageEndDate
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/CoverageData/CoverageRecord/PerilsCovered
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/CoverageData/CoverageRecord/IsMandatory
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/CoverageData/CoverageRecord
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/CoverageData/CoverageRecord/CoverageIdentifier
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/CoverageData/CoverageRecord/RiskIdentifier
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/CoverageData/CoverageRecord/CoverageSymbol
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/CoverageData/CoverageRecord/CoverageDescription
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/CoverageData/CoverageRecord/CoverageClass
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/CoverageData/CoverageRecord/MaxLimit
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/CoverageData/CoverageRecord/CoverageDeductible
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/CoverageData/CoverageRecord/CoverageBasis
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/CoverageData/CoverageRecord/CoinsurancePercent
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/CoverageData/CoverageRecord/CoveragePremium
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/CoverageData/CoverageRecord/CoverageStartDate
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/CoverageData/CoverageRecord/CoverageEndDate
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/CoverageData/CoverageRecord/PerilsCovered
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/CoverageData/CoverageRecord/IsMandatory
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/CoverageData/CoverageRecord
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/CoverageData/CoverageRecord/CoverageIdentifier
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/CoverageData/CoverageRecord/RiskIdentifier
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/CoverageData/CoverageRecord/CoverageSymbol
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/CoverageData/CoverageRecord/CoverageDescription
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/CoverageData/CoverageRecord/CoverageClass
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/CoverageData/CoverageRecord/MaxLimit
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/CoverageData/CoverageRecord/CoverageDeductible
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/CoverageData/CoverageRecord/DeductibleUnit
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/CoverageData/CoverageRecord/IndemnityPeriod
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/CoverageData/CoverageRecord/IndemnityPeriodUnit
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/CoverageData/CoverageRecord/CoveragePremium
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/CoverageData/CoverageRecord/CoverageStartDate
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/CoverageData/CoverageRecord/CoverageEndDate
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/CoverageData/CoverageRecord/IsMandatory
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/CoverageData/CoverageRecord
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/CoverageData/CoverageRecord/CoverageIdentifier
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/CoverageData/CoverageRecord/RiskIdentifier
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/CoverageData/CoverageRecord/CoverageSymbol
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/CoverageData/CoverageRecord/CoverageDescription
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/CoverageData/CoverageRecord/CoverageClass
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/CoverageData/CoverageRecord/MaxLimit
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/CoverageData/CoverageRecord/CoverageDeductible
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/CoverageData/CoverageRecord/CoveragePremium
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/CoverageData/CoverageRecord/CoverageStartDate
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/CoverageData/CoverageRecord/CoverageEndDate
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/CoverageData/CoverageRecord/CoveredEquipment
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/CoverageData/CoverageRecord/IsMandatory
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/PaymentData
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/PaymentData/PaymentIdentifier
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/PaymentData/PaymentNumber
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/PaymentData/TransactionType
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/PaymentData/PaymentMode
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/PaymentData/StatusDescription
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/PaymentData/ScheduledDate
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/PaymentData/TransactionAmount
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/PaymentData/BillingPlan
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/PaymentData/TotalInstallments
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/PaymentData/InstallmentAmount
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/PaymentData/PaymentAccountInfo
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/PaymentData/PaymentAccountInfo/NameOnAccount
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/PaymentData/PaymentAccountInfo/FinancialInstitution
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/PaymentData/PaymentAccountInfo/AccountNumber
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/PaymentData/PaymentAccountInfo/RoutingNumber
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/PaymentData/PaymentAccountInfo/AccountType
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/SystemData
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/SystemData/EnteredBy
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/SystemData/EntryTimestamp
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/SystemData/UpdatedBy
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/SystemData/UpdateTimestamp
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/SystemData/IssuedBy
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/SystemData/IssuedTimestamp
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/SystemData/WorkflowStatus
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/SystemData/ApprovalRequired
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/SystemData/ApprovalStatus
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/SystemData/ApprovedBy
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   Node: /Session/Data/SystemData/ApprovedDate
2025-10-06 00:51:52 - mapper.openai_mapper - INFO - üîç Processing 331 nodes
2025-10-06 00:51:52 - mapper.openai_mapper - INFO - üîç Grouping 331 nodes by section...
2025-10-06 00:51:52 - mapper.openai_mapper - INFO - üìä Grouped into sections: ['General', 'PolicyData', 'AccountData', 'QuoteData', 'RiskData', 'CoverageData', 'PaymentData']
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   General: 35 nodes
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   PolicyData: 47 nodes
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   AccountData: 43 nodes
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   QuoteData: 7 nodes
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   RiskData: 123 nodes
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   CoverageData: 59 nodes
2025-10-06 00:51:52 - mapper.openai_mapper - DEBUG -   PaymentData: 17 nodes
2025-10-06 00:51:52 - mapper.openai_mapper - INFO - üì¶ Processing section 'General' with 35 nodes
2025-10-06 00:51:52 - mapper.openai_mapper - WARNING - ‚ö†Ô∏è Using default table for 'General': SILVER.POLICY
2025-10-06 00:51:52 - mapper.openai_mapper - WARNING - ‚ö†Ô∏è No schema for SILVER.POLICY
2025-10-06 00:51:52 - mapper.openai_mapper - INFO - ‚úÖ Generated 0 mappings for General
2025-10-06 00:51:52 - mapper.openai_mapper - INFO - üì¶ Processing section 'PolicyData' with 47 nodes
2025-10-06 00:51:52 - mapper.openai_mapper - INFO - ‚úÖ Routing 'PolicyData' ‚Üí SILVER.POLICY
2025-10-06 00:51:52 - mapper.openai_mapper - WARNING - ‚ö†Ô∏è No schema for SILVER.POLICY
2025-10-06 00:51:52 - mapper.openai_mapper - INFO - ‚úÖ Generated 0 mappings for PolicyData
2025-10-06 00:51:52 - mapper.openai_mapper - INFO - üì¶ Processing section 'AccountData' with 43 nodes
2025-10-06 00:51:52 - mapper.openai_mapper - INFO - ‚úÖ Routing 'AccountData' ‚Üí SILVER.ACCOUNT
2025-10-06 00:51:52 - mapper.openai_mapper - WARNING - ‚ö†Ô∏è No schema for SILVER.ACCOUNT
2025-10-06 00:51:52 - mapper.openai_mapper - INFO - ‚úÖ Generated 0 mappings for AccountData
2025-10-06 00:51:52 - mapper.openai_mapper - INFO - üì¶ Processing section 'QuoteData' with 7 nodes
2025-10-06 00:51:52 - mapper.openai_mapper - INFO - ‚úÖ Routing 'QuoteData' ‚Üí SILVER.QUOTE
2025-10-06 00:51:52 - mapper.openai_mapper - WARNING - ‚ö†Ô∏è No schema for SILVER.QUOTE
2025-10-06 00:51:52 - mapper.openai_mapper - INFO - ‚úÖ Generated 0 mappings for QuoteData
2025-10-06 00:51:52 - mapper.openai_mapper - INFO - üì¶ Processing section 'RiskData' with 123 nodes
2025-10-06 00:51:52 - mapper.openai_mapper - INFO - ‚úÖ Routing 'RiskData' ‚Üí SILVER.RISK
2025-10-06 00:51:52 - mapper.openai_mapper - WARNING - ‚ö†Ô∏è No schema for SILVER.RISK
2025-10-06 00:51:52 - mapper.openai_mapper - INFO - ‚úÖ Generated 0 mappings for RiskData
2025-10-06 00:51:52 - mapper.openai_mapper - INFO - üì¶ Processing section 'CoverageData' with 59 nodes
2025-10-06 00:51:52 - mapper.openai_mapper - INFO - ‚úÖ Routing 'CoverageData' ‚Üí SILVER.COVERAGE
2025-10-06 00:51:52 - mapper.openai_mapper - WARNING - ‚ö†Ô∏è No schema for SILVER.COVERAGE
2025-10-06 00:51:52 - mapper.openai_mapper - INFO - ‚úÖ Generated 0 mappings for CoverageData
2025-10-06 00:51:52 - mapper.openai_mapper - INFO - üì¶ Processing section 'PaymentData' with 17 nodes
2025-10-06 00:51:52 - mapper.openai_mapper - INFO - ‚úÖ Routing 'PaymentData' ‚Üí SILVER.PAYMENT
2025-10-06 00:51:52 - mapper.openai_mapper - WARNING - ‚ö†Ô∏è No schema for SILVER.PAYMENT
2025-10-06 00:51:52 - mapper.openai_mapper - INFO - ‚úÖ Generated 0 mappings for PaymentData
2025-10-06 00:51:52 - mapper.openai_mapper - INFO - üéØ Total mappings generated: 0
2025-10-06 00:51:52 - main - INFO - üíæ Saving results...
2025-10-06 00:51:52 - main - INFO - ‚úÖ Saved 0 mappings to output/mappings_CP001_20251006_005152.csv
2025-10-06 00:51:52 - main - INFO - ‚úÖ Pipeline completed successfully!
2025-10-06 00:51:52 - utils.decorators - INFO - run completed in 29.07s
2025-10-06 00:56:31 - utils.logging_config - INFO - Logging configured at INFO level
2025-10-06 00:56:34 - loaders.snowflake_loader - INFO - ‚úÖ Connected to Snowflake: INSURANCE.ETL_MAPPER with role ACCOUNTADMIN
2025-10-06 00:56:34 - mapper.openai_mapper - INFO - ‚úÖ Loaded 7 Silver layer tables
2025-10-06 00:56:42 - loaders.snowflake_loader - INFO - ‚úÖ Connected to Snowflake: INSURANCE.ETL_MAPPER with role ACCOUNTADMIN
2025-10-06 00:56:42 - mapper.openai_mapper - INFO - ‚úÖ Loaded 7 Silver layer tables
2025-10-06 00:56:42 - utils.decorators - INFO - Starting run...
2025-10-06 00:56:42 - main - INFO - üîç Auto-detecting product type...
2025-10-06 00:56:42 - utils.product_detector - INFO - ‚úÖ Detected product: CP001 with 36.8% confidence
2025-10-06 00:56:42 - main - INFO - ‚úÖ Detected: CP001 with 36.8% confidence
2025-10-06 00:56:42 - main - INFO - üìä Extracting XML metadata...
2025-10-06 00:56:42 - main - INFO - ‚úÖ Extracted 331 XML nodes
2025-10-06 00:56:42 - main - INFO - ‚òÅÔ∏è Loading to Snowflake stage layer...
2025-10-06 00:56:42 - loaders.snowflake_loader - INFO - ‚úÖ Loaded XML data to ETL_MAPPER.STAGE_XML_CP001
2025-10-06 00:56:42 - main - INFO - ‚úÖ Loaded to ETL_MAPPER.STAGE_XML_CP001
2025-10-06 00:56:42 - main - INFO - üóÑÔ∏è Fetching Silver layer schema from Snowflake...
2025-10-06 00:56:42 - utils.schema_manager - INFO - Fetching schema from INSURANCE.SILVER
2025-10-06 00:56:44 - utils.schema_manager - INFO - ‚úÖ Fetched 137 columns from 7 tables
2025-10-06 00:56:44 - main - INFO - ‚úÖ Fetched 137 columns from 7 tables
2025-10-06 00:56:44 - main - INFO - üìö Finding and loading reference data with AI...
2025-10-06 00:56:44 - utils.document_loader - INFO - üîç Found 9 potential reference files
2025-10-06 00:56:45 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 00:56:45 - utils.document_loader - INFO - üìÑ historical_mappings_personal_auto.xlsx: historical_mapping (relevance: 85%)
2025-10-06 00:56:47 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 00:56:47 - utils.document_loader - INFO - üìÑ historical_mappings_commercial.xlsx: historical_mapping (relevance: 85%)
2025-10-06 00:56:49 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 00:56:49 - utils.document_loader - INFO - üìÑ old_mappings.csv: historical_mapping (relevance: 85%)
2025-10-06 00:56:51 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 00:56:51 - utils.document_loader - INFO - üìÑ historical_mappings_homeowners.xlsx: historical_mapping (relevance: 85%)
2025-10-06 00:56:53 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 00:56:53 - utils.document_loader - INFO - üìÑ old_mappings_homeowners.csv: historical_mapping (relevance: 85%)
2025-10-06 00:56:54 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 00:56:54 - utils.document_loader - INFO - üìÑ old_mappings_personal_auto.csv: historical_mapping (relevance: 85%)
2025-10-06 00:56:55 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 00:56:55 - utils.document_loader - INFO - üìÑ old_mappings_commercial.csv: historical_mapping (relevance: 85%)
2025-10-06 00:56:57 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 00:56:57 - utils.document_loader - INFO - üìÑ data_dictionary.csv: data_dictionary (relevance: 90%)
2025-10-06 00:56:58 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 00:56:58 - utils.document_loader - INFO - üìÑ data_dictionary_complete.xlsx: data_dictionary (relevance: 90%)
2025-10-06 00:56:58 - utils.document_loader - INFO - Loading file: reference_data/data_dictionary.csv (type: .csv)
2025-10-06 00:57:00 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 00:57:00 - utils.document_loader - ERROR - Error loading reference_data/data_dictionary.csv: name 'true' is not defined
2025-10-06 00:57:00 - utils.document_loader - INFO - Loading file: reference_data/data_dictionary_complete.xlsx (type: .xlsx)
2025-10-06 00:57:00 - utils.document_loader - INFO - Found 3 sheets: ['DataDictionary', 'TableSummary', 'Metadata']
2025-10-06 00:57:02 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 00:57:02 - utils.document_loader - INFO - AI understands this as: data_dictionary
2025-10-06 00:57:02 - utils.document_loader - INFO - Loading file: reference_data/historical_mappings_personal_auto.xlsx (type: .xlsx)
2025-10-06 00:57:02 - utils.document_loader - INFO - Found 2 sheets: ['Mappings', 'Metadata']
2025-10-06 00:57:05 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 00:57:05 - utils.document_loader - INFO - AI understands this as: historical_mappings
2025-10-06 00:57:05 - utils.document_loader - INFO - Loading file: reference_data/historical_mappings_commercial.xlsx (type: .xlsx)
2025-10-06 00:57:05 - utils.document_loader - INFO - Found 1 sheets: ['Mappings']
2025-10-06 00:57:08 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 00:57:08 - utils.document_loader - INFO - AI understands this as: historical_mappings
2025-10-06 00:57:08 - utils.document_loader - INFO - Loading file: reference_data/old_mappings.csv (type: .csv)
2025-10-06 00:57:10 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 00:57:10 - utils.document_loader - ERROR - Error loading reference_data/old_mappings.csv: name 'true' is not defined
2025-10-06 00:57:10 - utils.document_loader - INFO - Loading file: reference_data/historical_mappings_homeowners.xlsx (type: .xlsx)
2025-10-06 00:57:10 - utils.document_loader - INFO - Found 1 sheets: ['Mappings']
2025-10-06 00:57:12 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 00:57:12 - utils.document_loader - INFO - AI understands this as: historical_mappings
2025-10-06 00:57:12 - utils.document_loader - INFO - 
============================================================
2025-10-06 00:57:12 - utils.document_loader - INFO - ‚úÖ LOADED REFERENCE DATA SUMMARY:
2025-10-06 00:57:12 - utils.document_loader - INFO - ============================================================
2025-10-06 00:57:12 - utils.document_loader - INFO -   üìö Historical mappings: 3 files
2025-10-06 00:57:12 - utils.document_loader - INFO -      - historical_mappings_personal_auto.xlsx (51 rows)
2025-10-06 00:57:12 - utils.document_loader - INFO -      - historical_mappings_commercial.xlsx (9 rows)
2025-10-06 00:57:12 - utils.document_loader - INFO -      - historical_mappings_homeowners.xlsx (14 rows)
2025-10-06 00:57:12 - utils.document_loader - INFO -   üìñ Data dictionaries: 1 files
2025-10-06 00:57:12 - utils.document_loader - INFO -      - data_dictionary_complete.xlsx (104 rows)
2025-10-06 00:57:12 - utils.document_loader - INFO -   üóÑÔ∏è Schema definitions: 0 files
2025-10-06 00:57:12 - utils.document_loader - INFO -   üìä Reference data: 0 files
2025-10-06 00:57:12 - utils.document_loader - INFO - ============================================================

2025-10-06 00:57:12 - main - INFO - ü§ñ Predicting mappings with AI (flexible mode)...
2025-10-06 00:57:12 - mapper.openai_mapper - INFO - üì• Input type: <class 'pandas.core.frame.DataFrame'>
2025-10-06 00:57:12 - mapper.openai_mapper - INFO - üìã Schema keys: ['table_name', 'column_name', 'data_type', 'description', 'is_nullable']
2025-10-06 00:57:12 - mapper.openai_mapper - INFO - üîç Processing 331 nodes
2025-10-06 00:57:12 - mapper.openai_mapper - INFO - üìä Sections: ['General', 'PolicyData', 'AccountData', 'QuoteData', 'RiskData', 'CoverageData', 'PaymentData']
2025-10-06 00:57:12 - mapper.openai_mapper - INFO - üì¶ Processing 'General' (35 nodes)
2025-10-06 00:57:12 - mapper.openai_mapper - WARNING - ‚ö†Ô∏è Default: 'General' ‚Üí SILVER.POLICY
2025-10-06 00:57:12 - mapper.openai_mapper - ERROR - ‚ùå No schema found for SILVER.POLICY. Tried keys: POLICY, SILVER.POLICY, SILVER.POLICY
2025-10-06 00:57:12 - mapper.openai_mapper - ERROR - Available keys: ['table_name', 'column_name', 'data_type', 'description', 'is_nullable', 'column_default', 'ordinal_position', 'max_length', 'numeric_precision', 'numeric_scale', 'formatted_data_type']
2025-10-06 00:57:12 - mapper.openai_mapper - INFO - ‚úÖ Generated 0 mappings for General
2025-10-06 00:57:12 - mapper.openai_mapper - INFO - üì¶ Processing 'PolicyData' (47 nodes)
2025-10-06 00:57:12 - mapper.openai_mapper - INFO - ‚úÖ 'PolicyData' ‚Üí SILVER.POLICY
2025-10-06 00:57:12 - mapper.openai_mapper - ERROR - ‚ùå No schema found for SILVER.POLICY. Tried keys: POLICY, SILVER.POLICY, SILVER.POLICY
2025-10-06 00:57:12 - mapper.openai_mapper - ERROR - Available keys: ['table_name', 'column_name', 'data_type', 'description', 'is_nullable', 'column_default', 'ordinal_position', 'max_length', 'numeric_precision', 'numeric_scale', 'formatted_data_type']
2025-10-06 00:57:12 - mapper.openai_mapper - INFO - ‚úÖ Generated 0 mappings for PolicyData
2025-10-06 00:57:12 - mapper.openai_mapper - INFO - üì¶ Processing 'AccountData' (43 nodes)
2025-10-06 00:57:12 - mapper.openai_mapper - INFO - ‚úÖ 'AccountData' ‚Üí SILVER.ACCOUNT
2025-10-06 00:57:12 - mapper.openai_mapper - ERROR - ‚ùå No schema found for SILVER.ACCOUNT. Tried keys: ACCOUNT, SILVER.ACCOUNT, SILVER.ACCOUNT
2025-10-06 00:57:12 - mapper.openai_mapper - ERROR - Available keys: ['table_name', 'column_name', 'data_type', 'description', 'is_nullable', 'column_default', 'ordinal_position', 'max_length', 'numeric_precision', 'numeric_scale', 'formatted_data_type']
2025-10-06 00:57:12 - mapper.openai_mapper - INFO - ‚úÖ Generated 0 mappings for AccountData
2025-10-06 00:57:12 - mapper.openai_mapper - INFO - üì¶ Processing 'QuoteData' (7 nodes)
2025-10-06 00:57:12 - mapper.openai_mapper - INFO - ‚úÖ 'QuoteData' ‚Üí SILVER.QUOTE
2025-10-06 00:57:12 - mapper.openai_mapper - ERROR - ‚ùå No schema found for SILVER.QUOTE. Tried keys: QUOTE, SILVER.QUOTE, SILVER.QUOTE
2025-10-06 00:57:12 - mapper.openai_mapper - ERROR - Available keys: ['table_name', 'column_name', 'data_type', 'description', 'is_nullable', 'column_default', 'ordinal_position', 'max_length', 'numeric_precision', 'numeric_scale', 'formatted_data_type']
2025-10-06 00:57:12 - mapper.openai_mapper - INFO - ‚úÖ Generated 0 mappings for QuoteData
2025-10-06 00:57:12 - mapper.openai_mapper - INFO - üì¶ Processing 'RiskData' (123 nodes)
2025-10-06 00:57:12 - mapper.openai_mapper - INFO - ‚úÖ 'RiskData' ‚Üí SILVER.RISK
2025-10-06 00:57:12 - mapper.openai_mapper - ERROR - ‚ùå No schema found for SILVER.RISK. Tried keys: RISK, SILVER.RISK, SILVER.RISK
2025-10-06 00:57:12 - mapper.openai_mapper - ERROR - Available keys: ['table_name', 'column_name', 'data_type', 'description', 'is_nullable', 'column_default', 'ordinal_position', 'max_length', 'numeric_precision', 'numeric_scale', 'formatted_data_type']
2025-10-06 00:57:12 - mapper.openai_mapper - INFO - ‚úÖ Generated 0 mappings for RiskData
2025-10-06 00:57:12 - mapper.openai_mapper - INFO - üì¶ Processing 'CoverageData' (59 nodes)
2025-10-06 00:57:12 - mapper.openai_mapper - INFO - ‚úÖ 'CoverageData' ‚Üí SILVER.COVERAGE
2025-10-06 00:57:12 - mapper.openai_mapper - ERROR - ‚ùå No schema found for SILVER.COVERAGE. Tried keys: COVERAGE, SILVER.COVERAGE, SILVER.COVERAGE
2025-10-06 00:57:12 - mapper.openai_mapper - ERROR - Available keys: ['table_name', 'column_name', 'data_type', 'description', 'is_nullable', 'column_default', 'ordinal_position', 'max_length', 'numeric_precision', 'numeric_scale', 'formatted_data_type']
2025-10-06 00:57:12 - mapper.openai_mapper - INFO - ‚úÖ Generated 0 mappings for CoverageData
2025-10-06 00:57:12 - mapper.openai_mapper - INFO - üì¶ Processing 'PaymentData' (17 nodes)
2025-10-06 00:57:12 - mapper.openai_mapper - INFO - ‚úÖ 'PaymentData' ‚Üí SILVER.PAYMENT
2025-10-06 00:57:12 - mapper.openai_mapper - ERROR - ‚ùå No schema found for SILVER.PAYMENT. Tried keys: PAYMENT, SILVER.PAYMENT, SILVER.PAYMENT
2025-10-06 00:57:12 - mapper.openai_mapper - ERROR - Available keys: ['table_name', 'column_name', 'data_type', 'description', 'is_nullable', 'column_default', 'ordinal_position', 'max_length', 'numeric_precision', 'numeric_scale', 'formatted_data_type']
2025-10-06 00:57:12 - mapper.openai_mapper - INFO - ‚úÖ Generated 0 mappings for PaymentData
2025-10-06 00:57:12 - mapper.openai_mapper - INFO - üéØ Total: 0 mappings
2025-10-06 00:57:12 - main - INFO - üíæ Saving results...
2025-10-06 00:57:12 - main - INFO - ‚úÖ Saved 0 mappings to output/mappings_CP001_20251006_005712.csv
2025-10-06 00:57:12 - main - INFO - ‚úÖ Pipeline completed successfully!
2025-10-06 00:57:12 - utils.decorators - INFO - run completed in 30.29s
2025-10-06 01:00:58 - utils.logging_config - INFO - Logging configured at INFO level
2025-10-06 01:01:02 - loaders.snowflake_loader - INFO - ‚úÖ Connected to Snowflake: INSURANCE.ETL_MAPPER with role ACCOUNTADMIN
2025-10-06 01:01:02 - mapper.openai_mapper - INFO - ‚úÖ Loaded 7 Silver layer tables
2025-10-06 01:01:09 - loaders.snowflake_loader - INFO - ‚úÖ Connected to Snowflake: INSURANCE.ETL_MAPPER with role ACCOUNTADMIN
2025-10-06 01:01:09 - mapper.openai_mapper - INFO - ‚úÖ Loaded 7 Silver layer tables
2025-10-06 01:01:09 - utils.decorators - INFO - Starting run...
2025-10-06 01:01:09 - main - INFO - üîç Auto-detecting product type...
2025-10-06 01:01:09 - utils.product_detector - INFO - ‚úÖ Detected product: CP001 with 36.8% confidence
2025-10-06 01:01:09 - main - INFO - ‚úÖ Detected: CP001 with 36.8% confidence
2025-10-06 01:01:09 - main - INFO - üìä Extracting XML metadata...
2025-10-06 01:01:09 - main - INFO - ‚úÖ Extracted 331 XML nodes
2025-10-06 01:01:09 - main - INFO - ‚òÅÔ∏è Loading to Snowflake stage layer...
2025-10-06 01:01:11 - loaders.snowflake_loader - INFO - ‚úÖ Loaded XML data to ETL_MAPPER.STAGE_XML_CP001
2025-10-06 01:01:11 - main - INFO - ‚úÖ Loaded to ETL_MAPPER.STAGE_XML_CP001
2025-10-06 01:01:11 - main - INFO - üóÑÔ∏è Fetching Silver layer schema from Snowflake...
2025-10-06 01:01:11 - utils.schema_manager - INFO - Fetching schema from INSURANCE.SILVER
2025-10-06 01:01:12 - utils.schema_manager - INFO - ‚úÖ Fetched 137 columns from 7 tables
2025-10-06 01:01:12 - main - INFO - ‚úÖ Fetched 137 columns from 7 tables
2025-10-06 01:01:12 - main - INFO - üìö Finding and loading reference data with AI...
2025-10-06 01:01:12 - utils.document_loader - INFO - üîç Found 9 potential reference files
2025-10-06 01:01:14 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 01:01:14 - utils.document_loader - INFO - üìÑ historical_mappings_personal_auto.xlsx: historical_mapping (relevance: 85%)
2025-10-06 01:01:15 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 01:01:15 - utils.document_loader - INFO - üìÑ historical_mappings_commercial.xlsx: historical_mapping (relevance: 85%)
2025-10-06 01:01:17 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 01:01:17 - utils.document_loader - INFO - üìÑ old_mappings.csv: historical_mapping (relevance: 85%)
2025-10-06 01:01:18 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 01:01:18 - utils.document_loader - INFO - üìÑ historical_mappings_homeowners.xlsx: historical_mapping (relevance: 85%)
2025-10-06 01:01:20 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 01:01:20 - utils.document_loader - INFO - üìÑ old_mappings_homeowners.csv: historical_mapping (relevance: 85%)
2025-10-06 01:01:22 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 01:01:22 - utils.document_loader - INFO - üìÑ old_mappings_personal_auto.csv: historical_mapping (relevance: 85%)
2025-10-06 01:01:27 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 01:01:28 - utils.document_loader - INFO - üìÑ old_mappings_commercial.csv: historical_mapping (relevance: 85%)
2025-10-06 01:01:29 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 01:01:29 - utils.document_loader - INFO - üìÑ data_dictionary.csv: data_dictionary (relevance: 90%)
2025-10-06 01:01:35 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 01:01:35 - utils.document_loader - INFO - üìÑ data_dictionary_complete.xlsx: data_dictionary (relevance: 90%)
2025-10-06 01:01:35 - utils.document_loader - INFO - Loading file: reference_data/data_dictionary.csv (type: .csv)
2025-10-06 01:01:38 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 01:01:38 - utils.document_loader - ERROR - Error loading reference_data/data_dictionary.csv: name 'true' is not defined
2025-10-06 01:01:38 - utils.document_loader - INFO - Loading file: reference_data/data_dictionary_complete.xlsx (type: .xlsx)
2025-10-06 01:01:38 - utils.document_loader - INFO - Found 3 sheets: ['DataDictionary', 'TableSummary', 'Metadata']
2025-10-06 01:01:40 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 01:01:40 - utils.document_loader - INFO - AI understands this as: data_dictionary
2025-10-06 01:01:40 - utils.document_loader - INFO - Loading file: reference_data/historical_mappings_personal_auto.xlsx (type: .xlsx)
2025-10-06 01:01:40 - utils.document_loader - INFO - Found 2 sheets: ['Mappings', 'Metadata']
2025-10-06 01:01:42 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 01:01:42 - utils.document_loader - INFO - AI understands this as: historical_mappings
2025-10-06 01:01:42 - utils.document_loader - INFO - Loading file: reference_data/historical_mappings_commercial.xlsx (type: .xlsx)
2025-10-06 01:01:42 - utils.document_loader - INFO - Found 1 sheets: ['Mappings']
2025-10-06 01:01:46 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 01:01:46 - utils.document_loader - INFO - AI understands this as: historical_mappings
2025-10-06 01:01:46 - utils.document_loader - INFO - Loading file: reference_data/old_mappings.csv (type: .csv)
2025-10-06 01:01:47 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 01:01:47 - utils.document_loader - ERROR - Error loading reference_data/old_mappings.csv: name 'true' is not defined
2025-10-06 01:01:47 - utils.document_loader - INFO - Loading file: reference_data/historical_mappings_homeowners.xlsx (type: .xlsx)
2025-10-06 01:01:47 - utils.document_loader - INFO - Found 1 sheets: ['Mappings']
2025-10-06 01:01:52 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 01:01:52 - utils.document_loader - INFO - AI understands this as: historical_mappings
2025-10-06 01:01:52 - utils.document_loader - INFO - 
============================================================
2025-10-06 01:01:52 - utils.document_loader - INFO - ‚úÖ LOADED REFERENCE DATA SUMMARY:
2025-10-06 01:01:52 - utils.document_loader - INFO - ============================================================
2025-10-06 01:01:52 - utils.document_loader - INFO -   üìö Historical mappings: 3 files
2025-10-06 01:01:52 - utils.document_loader - INFO -      - historical_mappings_personal_auto.xlsx (51 rows)
2025-10-06 01:01:52 - utils.document_loader - INFO -      - historical_mappings_commercial.xlsx (9 rows)
2025-10-06 01:01:52 - utils.document_loader - INFO -      - historical_mappings_homeowners.xlsx (14 rows)
2025-10-06 01:01:52 - utils.document_loader - INFO -   üìñ Data dictionaries: 1 files
2025-10-06 01:01:52 - utils.document_loader - INFO -      - data_dictionary_complete.xlsx (104 rows)
2025-10-06 01:01:52 - utils.document_loader - INFO -   üóÑÔ∏è Schema definitions: 0 files
2025-10-06 01:01:52 - utils.document_loader - INFO -   üìä Reference data: 0 files
2025-10-06 01:01:52 - utils.document_loader - INFO - ============================================================

2025-10-06 01:01:52 - main - INFO - ü§ñ Predicting mappings with AI (flexible mode)...
2025-10-06 01:01:52 - mapper.openai_mapper - INFO - üì• XML type: <class 'pandas.core.frame.DataFrame'>
2025-10-06 01:01:52 - mapper.openai_mapper - INFO - üìã Schema type: <class 'pandas.core.frame.DataFrame'>
2025-10-06 01:01:52 - mapper.openai_mapper - INFO - üîÑ Transforming schema DataFrame to dict...
2025-10-06 01:01:52 - mapper.openai_mapper - INFO - ‚úÖ Transformed schema has 14 tables
2025-10-06 01:01:52 - mapper.openai_mapper - INFO - üîç Processing 331 nodes
2025-10-06 01:01:52 - mapper.openai_mapper - INFO - üìä Sections: ['General', 'PolicyData', 'AccountData', 'QuoteData', 'RiskData', 'CoverageData', 'PaymentData']
2025-10-06 01:01:52 - mapper.openai_mapper - INFO - üì¶ Processing 'General' (35 nodes)
2025-10-06 01:01:52 - mapper.openai_mapper - WARNING - ‚ö†Ô∏è Default: 'General' ‚Üí SILVER.POLICY
2025-10-06 01:01:52 - mapper.openai_mapper - INFO - üìã Found schema for 'SILVER.POLICY' using key: 'SILVER.POLICY'
2025-10-06 01:01:52 - mapper.openai_mapper - INFO - üéØ SILVER.POLICY has 23 columns
2025-10-06 01:01:53 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2025-10-06 01:01:53 - mapper.openai_mapper - ERROR - ‚ùå Failed: Error code: 400 - {'error': {'message': "Invalid parameter: 'response_format' of type 'json_object' is not supported with this model.", 'type': 'invalid_request_error', 'param': 'response_format', 'code': None}}
Traceback (most recent call last):
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/mapper/openai_mapper.py", line 304, in _generate_section_mappings
    response = self.client.chat.completions.create(
        model=self.model,
    ...<5 lines>...
        temperature=0.3
    )
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/.venv/lib/python3.13/site-packages/openai/_utils/_utils.py", line 286, in wrapper
    return func(*args, **kwargs)
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/.venv/lib/python3.13/site-packages/openai/resources/chat/completions/completions.py", line 1147, in create
    return self._post(
           ~~~~~~~~~~^
        "/chat/completions",
        ^^^^^^^^^^^^^^^^^^^^
    ...<46 lines>...
        stream_cls=Stream[ChatCompletionChunk],
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/.venv/lib/python3.13/site-packages/openai/_base_client.py", line 1259, in post
    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))
                           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/.venv/lib/python3.13/site-packages/openai/_base_client.py", line 1047, in request
    raise self._make_status_error_from_response(err.response) from None
openai.BadRequestError: Error code: 400 - {'error': {'message': "Invalid parameter: 'response_format' of type 'json_object' is not supported with this model.", 'type': 'invalid_request_error', 'param': 'response_format', 'code': None}}
2025-10-06 01:01:53 - mapper.openai_mapper - INFO - ‚úÖ Generated 0 mappings for General
2025-10-06 01:01:53 - mapper.openai_mapper - INFO - üì¶ Processing 'PolicyData' (47 nodes)
2025-10-06 01:01:53 - mapper.openai_mapper - INFO - ‚úÖ 'PolicyData' ‚Üí SILVER.POLICY
2025-10-06 01:01:53 - mapper.openai_mapper - INFO - üìã Found schema for 'SILVER.POLICY' using key: 'SILVER.POLICY'
2025-10-06 01:01:53 - mapper.openai_mapper - INFO - üéØ SILVER.POLICY has 23 columns
2025-10-06 01:01:53 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2025-10-06 01:01:53 - mapper.openai_mapper - ERROR - ‚ùå Failed: Error code: 400 - {'error': {'message': "Invalid parameter: 'response_format' of type 'json_object' is not supported with this model.", 'type': 'invalid_request_error', 'param': 'response_format', 'code': None}}
Traceback (most recent call last):
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/mapper/openai_mapper.py", line 304, in _generate_section_mappings
    response = self.client.chat.completions.create(
        model=self.model,
    ...<5 lines>...
        temperature=0.3
    )
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/.venv/lib/python3.13/site-packages/openai/_utils/_utils.py", line 286, in wrapper
    return func(*args, **kwargs)
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/.venv/lib/python3.13/site-packages/openai/resources/chat/completions/completions.py", line 1147, in create
    return self._post(
           ~~~~~~~~~~^
        "/chat/completions",
        ^^^^^^^^^^^^^^^^^^^^
    ...<46 lines>...
        stream_cls=Stream[ChatCompletionChunk],
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/.venv/lib/python3.13/site-packages/openai/_base_client.py", line 1259, in post
    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))
                           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/.venv/lib/python3.13/site-packages/openai/_base_client.py", line 1047, in request
    raise self._make_status_error_from_response(err.response) from None
openai.BadRequestError: Error code: 400 - {'error': {'message': "Invalid parameter: 'response_format' of type 'json_object' is not supported with this model.", 'type': 'invalid_request_error', 'param': 'response_format', 'code': None}}
2025-10-06 01:01:53 - mapper.openai_mapper - INFO - ‚úÖ Generated 0 mappings for PolicyData
2025-10-06 01:01:53 - mapper.openai_mapper - INFO - üì¶ Processing 'AccountData' (43 nodes)
2025-10-06 01:01:53 - mapper.openai_mapper - INFO - ‚úÖ 'AccountData' ‚Üí SILVER.ACCOUNT
2025-10-06 01:01:53 - mapper.openai_mapper - ERROR - ‚ùå No schema for SILVER.ACCOUNT
2025-10-06 01:01:53 - mapper.openai_mapper - ERROR - Available keys: ['SILVER.COVERAGE', 'SILVER.SILVER.COVERAGE', 'SILVER.CUSTOMER', 'SILVER.SILVER.CUSTOMER', 'SILVER.ORDERS', 'SILVER.SILVER.ORDERS', 'SILVER.PAYMENT', 'SILVER.SILVER.PAYMENT', 'SILVER.POLICY', 'SILVER.SILVER.POLICY']
2025-10-06 01:01:53 - mapper.openai_mapper - INFO - ‚úÖ Generated 0 mappings for AccountData
2025-10-06 01:01:53 - mapper.openai_mapper - INFO - üì¶ Processing 'QuoteData' (7 nodes)
2025-10-06 01:01:53 - mapper.openai_mapper - INFO - ‚úÖ 'QuoteData' ‚Üí SILVER.QUOTE
2025-10-06 01:01:53 - mapper.openai_mapper - INFO - üìã Found schema for 'SILVER.QUOTE' using key: 'SILVER.QUOTE'
2025-10-06 01:01:53 - mapper.openai_mapper - INFO - üéØ SILVER.QUOTE has 24 columns
2025-10-06 01:01:53 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2025-10-06 01:01:53 - mapper.openai_mapper - ERROR - ‚ùå Failed: Error code: 400 - {'error': {'message': "Invalid parameter: 'response_format' of type 'json_object' is not supported with this model.", 'type': 'invalid_request_error', 'param': 'response_format', 'code': None}}
Traceback (most recent call last):
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/mapper/openai_mapper.py", line 304, in _generate_section_mappings
    response = self.client.chat.completions.create(
        model=self.model,
    ...<5 lines>...
        temperature=0.3
    )
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/.venv/lib/python3.13/site-packages/openai/_utils/_utils.py", line 286, in wrapper
    return func(*args, **kwargs)
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/.venv/lib/python3.13/site-packages/openai/resources/chat/completions/completions.py", line 1147, in create
    return self._post(
           ~~~~~~~~~~^
        "/chat/completions",
        ^^^^^^^^^^^^^^^^^^^^
    ...<46 lines>...
        stream_cls=Stream[ChatCompletionChunk],
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/.venv/lib/python3.13/site-packages/openai/_base_client.py", line 1259, in post
    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))
                           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/.venv/lib/python3.13/site-packages/openai/_base_client.py", line 1047, in request
    raise self._make_status_error_from_response(err.response) from None
openai.BadRequestError: Error code: 400 - {'error': {'message': "Invalid parameter: 'response_format' of type 'json_object' is not supported with this model.", 'type': 'invalid_request_error', 'param': 'response_format', 'code': None}}
2025-10-06 01:01:53 - mapper.openai_mapper - INFO - ‚úÖ Generated 0 mappings for QuoteData
2025-10-06 01:01:53 - mapper.openai_mapper - INFO - üì¶ Processing 'RiskData' (123 nodes)
2025-10-06 01:01:53 - mapper.openai_mapper - INFO - ‚úÖ 'RiskData' ‚Üí SILVER.RISK
2025-10-06 01:01:53 - mapper.openai_mapper - INFO - üìã Found schema for 'SILVER.RISK' using key: 'SILVER.RISK'
2025-10-06 01:01:53 - mapper.openai_mapper - INFO - üéØ SILVER.RISK has 30 columns
2025-10-06 01:01:54 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2025-10-06 01:01:54 - mapper.openai_mapper - ERROR - ‚ùå Failed: Error code: 400 - {'error': {'message': "Invalid parameter: 'response_format' of type 'json_object' is not supported with this model.", 'type': 'invalid_request_error', 'param': 'response_format', 'code': None}}
Traceback (most recent call last):
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/mapper/openai_mapper.py", line 304, in _generate_section_mappings
    response = self.client.chat.completions.create(
        model=self.model,
    ...<5 lines>...
        temperature=0.3
    )
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/.venv/lib/python3.13/site-packages/openai/_utils/_utils.py", line 286, in wrapper
    return func(*args, **kwargs)
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/.venv/lib/python3.13/site-packages/openai/resources/chat/completions/completions.py", line 1147, in create
    return self._post(
           ~~~~~~~~~~^
        "/chat/completions",
        ^^^^^^^^^^^^^^^^^^^^
    ...<46 lines>...
        stream_cls=Stream[ChatCompletionChunk],
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/.venv/lib/python3.13/site-packages/openai/_base_client.py", line 1259, in post
    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))
                           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/.venv/lib/python3.13/site-packages/openai/_base_client.py", line 1047, in request
    raise self._make_status_error_from_response(err.response) from None
openai.BadRequestError: Error code: 400 - {'error': {'message': "Invalid parameter: 'response_format' of type 'json_object' is not supported with this model.", 'type': 'invalid_request_error', 'param': 'response_format', 'code': None}}
2025-10-06 01:01:54 - mapper.openai_mapper - INFO - ‚úÖ Generated 0 mappings for RiskData
2025-10-06 01:01:54 - mapper.openai_mapper - INFO - üì¶ Processing 'CoverageData' (59 nodes)
2025-10-06 01:01:54 - mapper.openai_mapper - INFO - ‚úÖ 'CoverageData' ‚Üí SILVER.COVERAGE
2025-10-06 01:01:54 - mapper.openai_mapper - INFO - üìã Found schema for 'SILVER.COVERAGE' using key: 'SILVER.COVERAGE'
2025-10-06 01:01:54 - mapper.openai_mapper - INFO - üéØ SILVER.COVERAGE has 22 columns
2025-10-06 01:01:54 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2025-10-06 01:01:54 - mapper.openai_mapper - ERROR - ‚ùå Failed: Error code: 400 - {'error': {'message': "Invalid parameter: 'response_format' of type 'json_object' is not supported with this model.", 'type': 'invalid_request_error', 'param': 'response_format', 'code': None}}
Traceback (most recent call last):
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/mapper/openai_mapper.py", line 304, in _generate_section_mappings
    response = self.client.chat.completions.create(
        model=self.model,
    ...<5 lines>...
        temperature=0.3
    )
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/.venv/lib/python3.13/site-packages/openai/_utils/_utils.py", line 286, in wrapper
    return func(*args, **kwargs)
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/.venv/lib/python3.13/site-packages/openai/resources/chat/completions/completions.py", line 1147, in create
    return self._post(
           ~~~~~~~~~~^
        "/chat/completions",
        ^^^^^^^^^^^^^^^^^^^^
    ...<46 lines>...
        stream_cls=Stream[ChatCompletionChunk],
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/.venv/lib/python3.13/site-packages/openai/_base_client.py", line 1259, in post
    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))
                           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/.venv/lib/python3.13/site-packages/openai/_base_client.py", line 1047, in request
    raise self._make_status_error_from_response(err.response) from None
openai.BadRequestError: Error code: 400 - {'error': {'message': "Invalid parameter: 'response_format' of type 'json_object' is not supported with this model.", 'type': 'invalid_request_error', 'param': 'response_format', 'code': None}}
2025-10-06 01:01:54 - mapper.openai_mapper - INFO - ‚úÖ Generated 0 mappings for CoverageData
2025-10-06 01:01:54 - mapper.openai_mapper - INFO - üì¶ Processing 'PaymentData' (17 nodes)
2025-10-06 01:01:54 - mapper.openai_mapper - INFO - ‚úÖ 'PaymentData' ‚Üí SILVER.PAYMENT
2025-10-06 01:01:54 - mapper.openai_mapper - INFO - üìã Found schema for 'SILVER.PAYMENT' using key: 'SILVER.PAYMENT'
2025-10-06 01:01:54 - mapper.openai_mapper - INFO - üéØ SILVER.PAYMENT has 28 columns
2025-10-06 01:01:54 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2025-10-06 01:01:54 - mapper.openai_mapper - ERROR - ‚ùå Failed: Error code: 400 - {'error': {'message': "Invalid parameter: 'response_format' of type 'json_object' is not supported with this model.", 'type': 'invalid_request_error', 'param': 'response_format', 'code': None}}
Traceback (most recent call last):
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/mapper/openai_mapper.py", line 304, in _generate_section_mappings
    response = self.client.chat.completions.create(
        model=self.model,
    ...<5 lines>...
        temperature=0.3
    )
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/.venv/lib/python3.13/site-packages/openai/_utils/_utils.py", line 286, in wrapper
    return func(*args, **kwargs)
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/.venv/lib/python3.13/site-packages/openai/resources/chat/completions/completions.py", line 1147, in create
    return self._post(
           ~~~~~~~~~~^
        "/chat/completions",
        ^^^^^^^^^^^^^^^^^^^^
    ...<46 lines>...
        stream_cls=Stream[ChatCompletionChunk],
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/.venv/lib/python3.13/site-packages/openai/_base_client.py", line 1259, in post
    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))
                           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/.venv/lib/python3.13/site-packages/openai/_base_client.py", line 1047, in request
    raise self._make_status_error_from_response(err.response) from None
openai.BadRequestError: Error code: 400 - {'error': {'message': "Invalid parameter: 'response_format' of type 'json_object' is not supported with this model.", 'type': 'invalid_request_error', 'param': 'response_format', 'code': None}}
2025-10-06 01:01:54 - mapper.openai_mapper - INFO - ‚úÖ Generated 0 mappings for PaymentData
2025-10-06 01:01:54 - mapper.openai_mapper - INFO - üéØ Total: 0 mappings
2025-10-06 01:01:54 - main - INFO - üíæ Saving results...
2025-10-06 01:01:54 - main - INFO - ‚úÖ Saved 0 mappings to output/mappings_CP001_20251006_010154.csv
2025-10-06 01:01:54 - main - INFO - ‚úÖ Pipeline completed successfully!
2025-10-06 01:01:54 - utils.decorators - INFO - run completed in 45.43s
2025-10-06 01:11:56 - utils.logging_config - INFO - Logging configured at INFO level
2025-10-06 01:11:58 - loaders.snowflake_loader - INFO - ‚úÖ Connected to Snowflake: INSURANCE.ETL_MAPPER with role ACCOUNTADMIN
2025-10-06 01:12:06 - loaders.snowflake_loader - INFO - ‚úÖ Connected to Snowflake: INSURANCE.ETL_MAPPER with role ACCOUNTADMIN
2025-10-06 01:12:06 - utils.decorators - INFO - Starting run...
2025-10-06 01:12:06 - main - INFO - üîç Auto-detecting product type...
2025-10-06 01:12:06 - utils.product_detector - INFO - ‚úÖ Detected product: CP001 with 36.8% confidence
2025-10-06 01:12:06 - main - INFO - ‚úÖ Detected: CP001 with 36.8% confidence
2025-10-06 01:12:06 - main - INFO - üìä Extracting XML metadata...
2025-10-06 01:12:06 - main - INFO - ‚úÖ Extracted 331 XML nodes
2025-10-06 01:12:06 - main - INFO - ‚òÅÔ∏è Loading to Snowflake stage layer...
2025-10-06 01:12:10 - loaders.snowflake_loader - INFO - ‚úÖ Loaded XML data to ETL_MAPPER.STAGE_XML_CP001
2025-10-06 01:12:10 - main - INFO - ‚úÖ Loaded to ETL_MAPPER.STAGE_XML_CP001
2025-10-06 01:12:10 - main - INFO - üóÑÔ∏è Fetching Silver layer schema from Snowflake...
2025-10-06 01:12:10 - utils.schema_manager - INFO - Fetching schema from INSURANCE.SILVER
2025-10-06 01:12:11 - utils.schema_manager - INFO - ‚úÖ Fetched 137 columns from 7 tables
2025-10-06 01:12:11 - main - INFO - ‚úÖ Fetched 137 columns from 7 tables
2025-10-06 01:12:11 - main - INFO - üìö Finding and loading reference data with AI...
2025-10-06 01:12:11 - utils.document_loader - INFO - üîç Found 9 potential reference files
2025-10-06 01:12:13 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 01:12:13 - utils.document_loader - INFO - üìÑ historical_mappings_personal_auto.xlsx: historical_mapping (relevance: 85%)
2025-10-06 01:12:17 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 01:12:17 - utils.document_loader - INFO - üìÑ historical_mappings_commercial.xlsx: historical_mapping (relevance: 85%)
2025-10-06 01:12:18 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 01:12:18 - utils.document_loader - INFO - üìÑ old_mappings.csv: historical_mapping (relevance: 85%)
2025-10-06 01:12:23 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 01:12:23 - utils.document_loader - INFO - üìÑ historical_mappings_homeowners.xlsx: historical_mapping (relevance: 85%)
2025-10-06 01:12:25 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 01:12:25 - utils.document_loader - INFO - üìÑ old_mappings_homeowners.csv: historical_mapping (relevance: 85%)
2025-10-06 01:12:28 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 01:12:28 - utils.document_loader - INFO - üìÑ old_mappings_personal_auto.csv: historical_mapping (relevance: 85%)
2025-10-06 01:12:29 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 01:12:29 - utils.document_loader - INFO - üìÑ old_mappings_commercial.csv: historical_mapping (relevance: 85%)
2025-10-06 01:12:31 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 01:12:31 - utils.document_loader - INFO - üìÑ data_dictionary.csv: data_dictionary (relevance: 90%)
2025-10-06 01:12:32 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 01:12:32 - utils.document_loader - INFO - üìÑ data_dictionary_complete.xlsx: data_dictionary (relevance: 90%)
2025-10-06 01:12:32 - utils.document_loader - INFO - Loading file: reference_data/data_dictionary.csv (type: .csv)
2025-10-06 01:12:33 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 01:12:33 - utils.document_loader - ERROR - Error loading reference_data/data_dictionary.csv: name 'true' is not defined
2025-10-06 01:12:33 - utils.document_loader - INFO - Loading file: reference_data/data_dictionary_complete.xlsx (type: .xlsx)
2025-10-06 01:12:33 - utils.document_loader - INFO - Found 3 sheets: ['DataDictionary', 'TableSummary', 'Metadata']
2025-10-06 01:12:36 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 01:12:36 - utils.document_loader - INFO - AI understands this as: data_dictionary
2025-10-06 01:12:36 - utils.document_loader - INFO - Loading file: reference_data/historical_mappings_personal_auto.xlsx (type: .xlsx)
2025-10-06 01:12:36 - utils.document_loader - INFO - Found 2 sheets: ['Mappings', 'Metadata']
2025-10-06 01:12:39 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 01:12:39 - utils.document_loader - INFO - AI understands this as: historical_mappings
2025-10-06 01:12:39 - utils.document_loader - INFO - Loading file: reference_data/historical_mappings_commercial.xlsx (type: .xlsx)
2025-10-06 01:12:39 - utils.document_loader - INFO - Found 1 sheets: ['Mappings']
2025-10-06 01:12:41 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 01:12:41 - utils.document_loader - INFO - AI understands this as: historical_mappings
2025-10-06 01:12:41 - utils.document_loader - INFO - Loading file: reference_data/old_mappings.csv (type: .csv)
2025-10-06 01:12:44 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 01:12:44 - utils.document_loader - ERROR - Error loading reference_data/old_mappings.csv: name 'true' is not defined
2025-10-06 01:12:44 - utils.document_loader - INFO - Loading file: reference_data/historical_mappings_homeowners.xlsx (type: .xlsx)
2025-10-06 01:12:44 - utils.document_loader - INFO - Found 1 sheets: ['Mappings']
2025-10-06 01:12:45 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 01:12:45 - utils.document_loader - INFO - AI understands this as: historical_mappings
2025-10-06 01:12:45 - utils.document_loader - INFO - 
============================================================
2025-10-06 01:12:45 - utils.document_loader - INFO - ‚úÖ LOADED REFERENCE DATA SUMMARY:
2025-10-06 01:12:45 - utils.document_loader - INFO - ============================================================
2025-10-06 01:12:45 - utils.document_loader - INFO -   üìö Historical mappings: 3 files
2025-10-06 01:12:45 - utils.document_loader - INFO -      - historical_mappings_personal_auto.xlsx (51 rows)
2025-10-06 01:12:45 - utils.document_loader - INFO -      - historical_mappings_commercial.xlsx (9 rows)
2025-10-06 01:12:45 - utils.document_loader - INFO -      - historical_mappings_homeowners.xlsx (14 rows)
2025-10-06 01:12:45 - utils.document_loader - INFO -   üìñ Data dictionaries: 1 files
2025-10-06 01:12:45 - utils.document_loader - INFO -      - data_dictionary_complete.xlsx (104 rows)
2025-10-06 01:12:45 - utils.document_loader - INFO -   üóÑÔ∏è Schema definitions: 0 files
2025-10-06 01:12:45 - utils.document_loader - INFO -   üìä Reference data: 0 files
2025-10-06 01:12:45 - utils.document_loader - INFO - ============================================================

2025-10-06 01:12:45 - main - INFO - ü§ñ Predicting mappings with AI (flexible mode)...
2025-10-06 01:13:05 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 01:13:27 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 01:13:38 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 01:14:00 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 01:14:22 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 01:14:48 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 01:14:48 - main - INFO - üíæ Saving results...
2025-10-06 01:14:48 - main - INFO - ‚úÖ Saved 65 mappings to output/mappings_CP001_20251006_011448.csv
2025-10-06 01:14:48 - main - INFO - ‚úÖ Pipeline completed successfully!
2025-10-06 01:14:48 - utils.decorators - INFO - run completed in 162.16s
2025-10-06 01:14:51 - utils.database_helper - INFO - ‚úÖ Saved XML to stage: XML-20251006011451
2025-10-06 01:15:15 - utils.database_helper - INFO - ‚úÖ Saved 65 mappings
2025-10-06 01:21:59 - loaders.snowflake_loader - INFO - ‚úÖ Connected to Snowflake: INSURANCE.ETL_MAPPER with role ACCOUNTADMIN
2025-10-06 01:21:59 - utils.decorators - INFO - Starting run...
2025-10-06 01:21:59 - main - INFO - üîç Auto-detecting product type...
2025-10-06 01:22:00 - utils.product_detector - INFO - ‚úÖ Detected product: CP001 with 36.8% confidence
2025-10-06 01:22:00 - main - INFO - ‚úÖ Detected: CP001 with 36.8% confidence
2025-10-06 01:22:00 - main - INFO - üìä Extracting XML metadata...
2025-10-06 01:22:00 - main - INFO - ‚úÖ Extracted 331 XML nodes
2025-10-06 01:22:00 - main - INFO - ‚òÅÔ∏è Loading to Snowflake stage layer...
2025-10-06 01:22:00 - loaders.snowflake_loader - INFO - ‚úÖ Loaded XML data to ETL_MAPPER.STAGE_XML_CP001
2025-10-06 01:22:00 - main - INFO - ‚úÖ Loaded to ETL_MAPPER.STAGE_XML_CP001
2025-10-06 01:22:00 - main - INFO - üóÑÔ∏è Fetching Silver layer schema from Snowflake...
2025-10-06 01:22:00 - utils.schema_manager - INFO - Fetching schema from INSURANCE.SILVER
2025-10-06 01:22:01 - utils.schema_manager - INFO - ‚úÖ Fetched 137 columns from 7 tables
2025-10-06 01:22:01 - main - INFO - ‚úÖ Fetched 137 columns from 7 tables
2025-10-06 01:22:01 - main - INFO - üìö Finding and loading reference data with AI...
2025-10-06 01:22:01 - utils.document_loader - INFO - üîç Found 9 potential reference files
2025-10-06 01:22:03 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 01:22:03 - utils.document_loader - INFO - üìÑ historical_mappings_personal_auto.xlsx: historical_mapping (relevance: 85%)
2025-10-06 01:22:06 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 01:22:06 - utils.document_loader - INFO - üìÑ historical_mappings_commercial.xlsx: historical_mapping (relevance: 85%)
2025-10-06 01:22:07 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 01:22:07 - utils.document_loader - INFO - üìÑ old_mappings.csv: historical_mapping (relevance: 85%)
2025-10-06 01:22:10 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 01:22:10 - utils.document_loader - INFO - üìÑ historical_mappings_homeowners.xlsx: historical_mapping (relevance: 85%)
2025-10-06 01:22:12 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 01:22:12 - utils.document_loader - INFO - üìÑ old_mappings_homeowners.csv: historical_mapping (relevance: 85%)
2025-10-06 01:22:14 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 01:22:14 - utils.document_loader - INFO - üìÑ old_mappings_personal_auto.csv: historical_mapping (relevance: 85%)
2025-10-06 01:22:16 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 01:22:16 - utils.document_loader - INFO - üìÑ old_mappings_commercial.csv: historical_mapping (relevance: 85%)
2025-10-06 01:22:17 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 01:22:17 - utils.document_loader - INFO - üìÑ data_dictionary.csv: data_dictionary (relevance: 90%)
2025-10-06 01:22:19 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 01:22:19 - utils.document_loader - INFO - üìÑ data_dictionary_complete.xlsx: data_dictionary (relevance: 90%)
2025-10-06 01:22:19 - utils.document_loader - INFO - Loading file: reference_data/data_dictionary.csv (type: .csv)
2025-10-06 01:22:21 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 01:22:21 - utils.document_loader - ERROR - Error loading reference_data/data_dictionary.csv: name 'true' is not defined
2025-10-06 01:22:21 - utils.document_loader - INFO - Loading file: reference_data/data_dictionary_complete.xlsx (type: .xlsx)
2025-10-06 01:22:21 - utils.document_loader - INFO - Found 3 sheets: ['DataDictionary', 'TableSummary', 'Metadata']
2025-10-06 01:22:24 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 01:22:24 - utils.document_loader - INFO - AI understands this as: data_dictionary
2025-10-06 01:22:24 - utils.document_loader - INFO - Loading file: reference_data/historical_mappings_personal_auto.xlsx (type: .xlsx)
2025-10-06 01:22:24 - utils.document_loader - INFO - Found 2 sheets: ['Mappings', 'Metadata']
2025-10-06 01:22:27 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 01:22:27 - utils.document_loader - INFO - AI understands this as: historical_mappings
2025-10-06 01:22:27 - utils.document_loader - INFO - Loading file: reference_data/historical_mappings_commercial.xlsx (type: .xlsx)
2025-10-06 01:22:27 - utils.document_loader - INFO - Found 1 sheets: ['Mappings']
2025-10-06 01:22:30 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 01:22:30 - utils.document_loader - INFO - AI understands this as: historical_mappings
2025-10-06 01:22:30 - utils.document_loader - INFO - Loading file: reference_data/old_mappings.csv (type: .csv)
2025-10-06 01:22:33 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 01:22:33 - utils.document_loader - ERROR - Error loading reference_data/old_mappings.csv: name 'true' is not defined
2025-10-06 01:22:33 - utils.document_loader - INFO - Loading file: reference_data/historical_mappings_homeowners.xlsx (type: .xlsx)
2025-10-06 01:22:33 - utils.document_loader - INFO - Found 1 sheets: ['Mappings']
2025-10-06 01:22:35 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 01:22:35 - utils.document_loader - INFO - AI understands this as: historical_mappings
2025-10-06 01:22:35 - utils.document_loader - INFO - 
============================================================
2025-10-06 01:22:35 - utils.document_loader - INFO - ‚úÖ LOADED REFERENCE DATA SUMMARY:
2025-10-06 01:22:35 - utils.document_loader - INFO - ============================================================
2025-10-06 01:22:35 - utils.document_loader - INFO -   üìö Historical mappings: 3 files
2025-10-06 01:22:35 - utils.document_loader - INFO -      - historical_mappings_personal_auto.xlsx (51 rows)
2025-10-06 01:22:35 - utils.document_loader - INFO -      - historical_mappings_commercial.xlsx (9 rows)
2025-10-06 01:22:35 - utils.document_loader - INFO -      - historical_mappings_homeowners.xlsx (14 rows)
2025-10-06 01:22:35 - utils.document_loader - INFO -   üìñ Data dictionaries: 1 files
2025-10-06 01:22:35 - utils.document_loader - INFO -      - data_dictionary_complete.xlsx (104 rows)
2025-10-06 01:22:35 - utils.document_loader - INFO -   üóÑÔ∏è Schema definitions: 0 files
2025-10-06 01:22:35 - utils.document_loader - INFO -   üìä Reference data: 0 files
2025-10-06 01:22:35 - utils.document_loader - INFO - ============================================================

2025-10-06 01:22:35 - main - INFO - ü§ñ Predicting mappings with AI (flexible mode)...
2025-10-06 01:23:03 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 01:23:23 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 01:23:37 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 01:23:53 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 01:24:11 - loaders.snowflake_loader - INFO - ‚úÖ Connected to Snowflake: INSURANCE.ETL_MAPPER with role ACCOUNTADMIN
2025-10-06 01:24:24 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 01:24:48 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 01:24:48 - main - INFO - üíæ Saving results...
2025-10-06 01:24:48 - main - INFO - ‚úÖ Saved 84 mappings to output/mappings_CP001_20251006_012448.csv
2025-10-06 01:24:48 - main - INFO - ‚úÖ Pipeline completed successfully!
2025-10-06 01:24:48 - utils.decorators - INFO - run completed in 168.59s
2025-10-06 01:24:53 - loaders.snowflake_loader - INFO - ‚úÖ Connected to Snowflake: INSURANCE.ETL_MAPPER with role ACCOUNTADMIN
2025-10-06 01:24:58 - loaders.snowflake_loader - INFO - ‚úÖ Connected to Snowflake: INSURANCE.ETL_MAPPER with role ACCOUNTADMIN
2025-10-06 01:25:04 - loaders.snowflake_loader - INFO - ‚úÖ Connected to Snowflake: INSURANCE.ETL_MAPPER with role ACCOUNTADMIN
2025-10-06 01:25:04 - utils.decorators - INFO - Starting run...
2025-10-06 01:25:04 - main - INFO - üîç Auto-detecting product type...
2025-10-06 01:25:04 - utils.product_detector - INFO - ‚úÖ Detected product: HO003 with 67.3% confidence
2025-10-06 01:25:04 - main - INFO - ‚úÖ Detected: HO003 with 67.3% confidence
2025-10-06 01:25:04 - main - INFO - üìä Extracting XML metadata...
2025-10-06 01:25:04 - main - INFO - ‚úÖ Extracted 319 XML nodes
2025-10-06 01:25:04 - main - INFO - ‚òÅÔ∏è Loading to Snowflake stage layer...
2025-10-06 01:25:05 - loaders.snowflake_loader - INFO - ‚úÖ Loaded XML data to ETL_MAPPER.STAGE_XML_HO003
2025-10-06 01:25:05 - main - INFO - ‚úÖ Loaded to ETL_MAPPER.STAGE_XML_HO003
2025-10-06 01:25:05 - main - INFO - üóÑÔ∏è Fetching Silver layer schema from Snowflake...
2025-10-06 01:25:05 - utils.schema_manager - INFO - Fetching schema from INSURANCE.SILVER
2025-10-06 01:25:07 - utils.schema_manager - INFO - ‚úÖ Fetched 137 columns from 7 tables
2025-10-06 01:25:07 - main - INFO - ‚úÖ Fetched 137 columns from 7 tables
2025-10-06 01:25:07 - main - INFO - üìö Finding and loading reference data with AI...
2025-10-06 01:25:07 - utils.document_loader - INFO - üîç Found 9 potential reference files
2025-10-06 01:25:08 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 01:25:08 - utils.document_loader - INFO - üìÑ historical_mappings_personal_auto.xlsx: historical_mapping (relevance: 85%)
2025-10-06 01:25:09 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 01:25:09 - utils.document_loader - INFO - üìÑ historical_mappings_commercial.xlsx: historical_mapping (relevance: 85%)
2025-10-06 01:25:11 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 01:25:11 - utils.document_loader - INFO - üìÑ old_mappings.csv: historical_mapping (relevance: 85%)
2025-10-06 01:25:12 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 01:25:12 - utils.document_loader - INFO - üìÑ historical_mappings_homeowners.xlsx: historical_mapping (relevance: 85%)
2025-10-06 01:25:14 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 01:25:14 - utils.document_loader - INFO - üìÑ old_mappings_homeowners.csv: historical_mapping (relevance: 85%)
2025-10-06 01:25:16 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 01:25:16 - utils.document_loader - INFO - üìÑ old_mappings_personal_auto.csv: historical_mapping (relevance: 85%)
2025-10-06 01:25:17 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 01:25:17 - utils.document_loader - INFO - üìÑ old_mappings_commercial.csv: historical_mapping (relevance: 85%)
2025-10-06 01:25:19 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 01:25:19 - utils.document_loader - INFO - üìÑ data_dictionary.csv: data_dictionary (relevance: 90%)
2025-10-06 01:25:20 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 01:25:20 - utils.document_loader - INFO - üìÑ data_dictionary_complete.xlsx: data_dictionary (relevance: 85%)
2025-10-06 01:25:20 - utils.document_loader - INFO - Loading file: reference_data/data_dictionary.csv (type: .csv)
2025-10-06 01:25:23 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 01:25:23 - utils.document_loader - ERROR - Error loading reference_data/data_dictionary.csv: name 'true' is not defined
2025-10-06 01:25:23 - utils.document_loader - INFO - Loading file: reference_data/historical_mappings_personal_auto.xlsx (type: .xlsx)
2025-10-06 01:25:23 - utils.document_loader - INFO - Found 2 sheets: ['Mappings', 'Metadata']
2025-10-06 01:25:27 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 01:25:27 - utils.document_loader - INFO - AI understands this as: historical_mappings
2025-10-06 01:25:27 - utils.document_loader - INFO - Loading file: reference_data/historical_mappings_commercial.xlsx (type: .xlsx)
2025-10-06 01:25:27 - utils.document_loader - INFO - Found 1 sheets: ['Mappings']
2025-10-06 01:25:29 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 01:25:29 - utils.document_loader - INFO - AI understands this as: historical_mappings
2025-10-06 01:25:29 - utils.document_loader - INFO - Loading file: reference_data/old_mappings.csv (type: .csv)
2025-10-06 01:25:32 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 01:25:32 - utils.document_loader - ERROR - Error loading reference_data/old_mappings.csv: name 'true' is not defined
2025-10-06 01:25:32 - utils.document_loader - INFO - Loading file: reference_data/historical_mappings_homeowners.xlsx (type: .xlsx)
2025-10-06 01:25:32 - utils.document_loader - INFO - Found 1 sheets: ['Mappings']
2025-10-06 01:25:37 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 01:25:37 - utils.document_loader - INFO - AI understands this as: historical_mappings
2025-10-06 01:25:37 - utils.document_loader - INFO - Loading file: reference_data/data_dictionary_complete.xlsx (type: .xlsx)
2025-10-06 01:25:37 - utils.document_loader - INFO - Found 3 sheets: ['DataDictionary', 'TableSummary', 'Metadata']
2025-10-06 01:25:43 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 01:25:43 - utils.document_loader - INFO - AI understands this as: data_dictionary
2025-10-06 01:25:43 - utils.document_loader - INFO - 
============================================================
2025-10-06 01:25:43 - utils.document_loader - INFO - ‚úÖ LOADED REFERENCE DATA SUMMARY:
2025-10-06 01:25:43 - utils.document_loader - INFO - ============================================================
2025-10-06 01:25:43 - utils.document_loader - INFO -   üìö Historical mappings: 3 files
2025-10-06 01:25:43 - utils.document_loader - INFO -      - historical_mappings_personal_auto.xlsx (51 rows)
2025-10-06 01:25:43 - utils.document_loader - INFO -      - historical_mappings_commercial.xlsx (9 rows)
2025-10-06 01:25:43 - utils.document_loader - INFO -      - historical_mappings_homeowners.xlsx (14 rows)
2025-10-06 01:25:43 - utils.document_loader - INFO -   üìñ Data dictionaries: 1 files
2025-10-06 01:25:43 - utils.document_loader - INFO -      - data_dictionary_complete.xlsx (104 rows)
2025-10-06 01:25:43 - utils.document_loader - INFO -   üóÑÔ∏è Schema definitions: 0 files
2025-10-06 01:25:43 - utils.document_loader - INFO -   üìä Reference data: 0 files
2025-10-06 01:25:43 - utils.document_loader - INFO - ============================================================

2025-10-06 01:25:43 - main - INFO - ü§ñ Predicting mappings with AI (flexible mode)...
2025-10-06 01:26:05 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 01:26:26 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 01:26:55 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 01:27:11 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 01:27:37 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 01:28:10 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 01:28:41 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 01:28:41 - main - INFO - üíæ Saving results...
2025-10-06 01:28:41 - main - INFO - ‚úÖ Saved 101 mappings to output/mappings_HO003_20251006_012841.csv
2025-10-06 01:28:41 - main - INFO - ‚úÖ Pipeline completed successfully!
2025-10-06 01:28:41 - utils.decorators - INFO - run completed in 216.36s
2025-10-06 01:28:44 - utils.database_helper - INFO - ‚úÖ Saved XML to stage: XML-20251006012843
2025-10-06 01:29:19 - utils.database_helper - INFO - ‚úÖ Saved 101 mappings
2025-10-06 01:35:56 - utils.logging_config - INFO - Logging configured at INFO level
2025-10-06 01:35:58 - loaders.snowflake_loader - INFO - ‚úÖ Connected to Snowflake: INSURANCE.ETL_MAPPER with role ACCOUNTADMIN
2025-10-06 01:36:36 - loaders.snowflake_loader - INFO - ‚úÖ Connected to Snowflake: INSURANCE.ETL_MAPPER with role ACCOUNTADMIN
2025-10-06 01:36:38 - loaders.snowflake_loader - INFO - ‚úÖ Connected to Snowflake: INSURANCE.ETL_MAPPER with role ACCOUNTADMIN
2025-10-06 01:36:58 - loaders.snowflake_loader - INFO - ‚úÖ Connected to Snowflake: INSURANCE.ETL_MAPPER with role ACCOUNTADMIN
2025-10-06 01:37:39 - loaders.snowflake_loader - INFO - ‚úÖ Connected to Snowflake: INSURANCE.ETL_MAPPER with role ACCOUNTADMIN
2025-10-06 01:56:49 - utils.logging_config - INFO - Logging configured at INFO level
2025-10-06 01:56:52 - loaders.snowflake_loader - INFO - ‚úÖ Connected to Snowflake: INSURANCE.ETL_MAPPER with role ACCOUNTADMIN
2025-10-06 01:57:32 - loaders.snowflake_loader - INFO - ‚úÖ Connected to Snowflake: INSURANCE.ETL_MAPPER with role ACCOUNTADMIN
2025-10-06 01:57:32 - utils.decorators - INFO - Starting run...
2025-10-06 01:57:32 - main - INFO - üîç Auto-detecting product type...
2025-10-06 01:57:32 - utils.product_detector - INFO - ‚úÖ Detected product: CP001 with 36.8% confidence
2025-10-06 01:57:32 - main - INFO - ‚úÖ Detected: CP001 with 36.8% confidence
2025-10-06 01:57:32 - main - INFO - üìä Extracting XML metadata...
2025-10-06 01:57:32 - main - INFO - ‚úÖ Extracted 331 XML nodes
2025-10-06 01:57:32 - main - INFO - ‚òÅÔ∏è Loading to Snowflake stage layer...
2025-10-06 01:57:34 - loaders.snowflake_loader - INFO - ‚úÖ Loaded XML data to ETL_MAPPER.STAGE_XML_CP001
2025-10-06 01:57:34 - main - INFO - ‚úÖ Loaded to ETL_MAPPER.STAGE_XML_CP001
2025-10-06 01:57:34 - main - INFO - üóÑÔ∏è Fetching Silver layer schema from Snowflake...
2025-10-06 01:57:34 - utils.schema_manager - INFO - Fetching schema from INSURANCE.SILVER
2025-10-06 01:57:35 - utils.schema_manager - INFO - ‚úÖ Fetched 137 columns from 7 tables
2025-10-06 01:57:35 - main - INFO - ‚úÖ Fetched 137 columns from 7 tables
2025-10-06 01:57:35 - main - INFO - üìö Finding and loading reference data with AI...
2025-10-06 01:57:35 - utils.document_loader - INFO - üîç Found 9 potential reference files
2025-10-06 01:57:37 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 01:57:37 - utils.document_loader - INFO - üìÑ historical_mappings_personal_auto.xlsx: historical_mapping (relevance: 85%)
2025-10-06 01:57:38 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 01:57:38 - utils.document_loader - INFO - üìÑ historical_mappings_commercial.xlsx: historical_mapping (relevance: 85%)
2025-10-06 01:57:40 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 01:57:40 - utils.document_loader - INFO - üìÑ old_mappings.csv: historical_mapping (relevance: 85%)
2025-10-06 01:57:41 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 01:57:41 - utils.document_loader - INFO - üìÑ historical_mappings_homeowners.xlsx: historical_mapping (relevance: 85%)
2025-10-06 01:57:43 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 01:57:43 - utils.document_loader - INFO - üìÑ old_mappings_homeowners.csv: historical_mapping (relevance: 85%)
2025-10-06 01:57:44 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 01:57:44 - utils.document_loader - INFO - üìÑ old_mappings_personal_auto.csv: historical_mapping (relevance: 85%)
2025-10-06 01:57:46 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 01:57:46 - utils.document_loader - INFO - üìÑ old_mappings_commercial.csv: historical_mapping (relevance: 85%)
2025-10-06 01:57:48 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 01:57:48 - utils.document_loader - INFO - üìÑ data_dictionary.csv: data_dictionary (relevance: 90%)
2025-10-06 01:57:49 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 01:57:49 - utils.document_loader - INFO - üìÑ data_dictionary_complete.xlsx: data_dictionary (relevance: 90%)
2025-10-06 01:57:49 - utils.document_loader - INFO - Loading file: reference_data/data_dictionary.csv (type: .csv)
2025-10-06 01:57:51 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 01:57:51 - utils.document_loader - ERROR - Error loading reference_data/data_dictionary.csv: name 'true' is not defined
2025-10-06 01:57:51 - utils.document_loader - INFO - Loading file: reference_data/data_dictionary_complete.xlsx (type: .xlsx)
2025-10-06 01:57:51 - utils.document_loader - INFO - Found 3 sheets: ['DataDictionary', 'TableSummary', 'Metadata']
2025-10-06 01:57:53 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 01:57:53 - utils.document_loader - INFO - AI understands this as: data_dictionary
2025-10-06 01:57:53 - utils.document_loader - INFO - Loading file: reference_data/historical_mappings_personal_auto.xlsx (type: .xlsx)
2025-10-06 01:57:53 - utils.document_loader - INFO - Found 2 sheets: ['Mappings', 'Metadata']
2025-10-06 01:57:56 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 01:57:56 - utils.document_loader - INFO - AI understands this as: historical_mappings
2025-10-06 01:57:56 - utils.document_loader - INFO - Loading file: reference_data/historical_mappings_commercial.xlsx (type: .xlsx)
2025-10-06 01:57:56 - utils.document_loader - INFO - Found 1 sheets: ['Mappings']
2025-10-06 01:57:58 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 01:57:58 - utils.document_loader - INFO - AI understands this as: historical_mappings
2025-10-06 01:57:58 - utils.document_loader - INFO - Loading file: reference_data/old_mappings.csv (type: .csv)
2025-10-06 01:58:00 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 01:58:00 - utils.document_loader - ERROR - Error loading reference_data/old_mappings.csv: name 'true' is not defined
2025-10-06 01:58:00 - utils.document_loader - INFO - Loading file: reference_data/historical_mappings_homeowners.xlsx (type: .xlsx)
2025-10-06 01:58:00 - utils.document_loader - INFO - Found 1 sheets: ['Mappings']
2025-10-06 01:58:03 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 01:58:03 - utils.document_loader - INFO - AI understands this as: historical_mappings
2025-10-06 01:58:03 - utils.document_loader - INFO - 
============================================================
2025-10-06 01:58:03 - utils.document_loader - INFO - ‚úÖ LOADED REFERENCE DATA SUMMARY:
2025-10-06 01:58:03 - utils.document_loader - INFO - ============================================================
2025-10-06 01:58:03 - utils.document_loader - INFO -   üìö Historical mappings: 3 files
2025-10-06 01:58:03 - utils.document_loader - INFO -      - historical_mappings_personal_auto.xlsx (51 rows)
2025-10-06 01:58:03 - utils.document_loader - INFO -      - historical_mappings_commercial.xlsx (9 rows)
2025-10-06 01:58:03 - utils.document_loader - INFO -      - historical_mappings_homeowners.xlsx (14 rows)
2025-10-06 01:58:03 - utils.document_loader - INFO -   üìñ Data dictionaries: 1 files
2025-10-06 01:58:03 - utils.document_loader - INFO -      - data_dictionary_complete.xlsx (104 rows)
2025-10-06 01:58:03 - utils.document_loader - INFO -   üóÑÔ∏è Schema definitions: 0 files
2025-10-06 01:58:03 - utils.document_loader - INFO -   üìä Reference data: 0 files
2025-10-06 01:58:03 - utils.document_loader - INFO - ============================================================

2025-10-06 01:58:03 - main - INFO - ü§ñ Predicting mappings with AI (flexible mode)...
2025-10-06 01:58:22 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 01:58:37 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 01:58:47 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 01:59:09 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 01:59:34 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 02:00:02 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 02:00:02 - main - INFO - üíæ Saving results...
2025-10-06 02:00:02 - main - INFO - ‚úÖ Saved 65 mappings to output/mappings_CP001_20251006_020002.csv
2025-10-06 02:00:02 - main - INFO - ‚úÖ Pipeline completed successfully!
2025-10-06 02:00:02 - utils.decorators - INFO - run completed in 150.85s
2025-10-06 02:00:05 - utils.database_helper - INFO - ‚úÖ Saved XML to stage: XML-20251006020005
2025-10-06 02:00:29 - utils.database_helper - INFO - ‚úÖ Saved 65 mappings
2025-10-06 02:01:04 - loaders.snowflake_loader - INFO - ‚úÖ Connected to Snowflake: INSURANCE.ETL_MAPPER with role ACCOUNTADMIN
2025-10-06 02:01:34 - loaders.snowflake_loader - INFO - ‚úÖ Connected to Snowflake: INSURANCE.ETL_MAPPER with role ACCOUNTADMIN
2025-10-06 02:12:00 - utils.logging_config - INFO - Logging configured at INFO level
2025-10-06 02:12:02 - loaders.snowflake_loader - INFO - ‚úÖ Connected to Snowflake: INSURANCE.ETL_MAPPER with role ACCOUNTADMIN
2025-10-06 02:12:06 - utils.database_helper - INFO - Loaded 166 approved mappings
2025-10-06 02:12:19 - loaders.snowflake_loader - INFO - ‚úÖ Connected to Snowflake: INSURANCE.ETL_MAPPER with role ACCOUNTADMIN
2025-10-06 02:12:20 - utils.database_helper - INFO - Loaded 166 approved mappings
2025-10-06 02:12:45 - loaders.snowflake_loader - INFO - ‚úÖ Connected to Snowflake: INSURANCE.ETL_MAPPER with role ACCOUNTADMIN
2025-10-06 02:12:48 - utils.database_helper - INFO - Loaded 166 approved mappings
2025-10-06 02:12:48 - etl.executor - INFO - üîÑ Processing SILVER.RISK...
2025-10-06 02:12:51 - etl.executor - ERROR - ‚ùå Failed SILVER.RISK: 000904 (42000): SQL compilation error: error line 2 at position 15
invalid identifier 'NODE_VALUE'
2025-10-06 02:12:58 - etl.executor - INFO - üîÑ Processing SILVER.POLICY...
2025-10-06 02:12:59 - etl.executor - ERROR - ‚ùå Failed SILVER.POLICY: 000904 (42000): SQL compilation error: error line 2 at position 15
invalid identifier 'NODE_VALUE'
2025-10-06 02:13:13 - etl.executor - INFO - üîÑ Processing SILVER.QUOTE...
2025-10-06 02:13:17 - etl.executor - ERROR - ‚ùå Failed SILVER.QUOTE: 000904 (42000): SQL compilation error: error line 2 at position 15
invalid identifier 'NODE_VALUE'
2025-10-06 02:13:24 - etl.executor - INFO - üîÑ Processing SILVER.PAYMENT...
2025-10-06 02:13:28 - etl.executor - ERROR - ‚ùå Failed SILVER.PAYMENT: 000904 (42000): SQL compilation error: error line 2 at position 15
invalid identifier 'NODE_VALUE'
2025-10-06 02:13:33 - etl.executor - INFO - üîÑ Processing SILVER.COVERAGE...
2025-10-06 02:13:35 - etl.executor - ERROR - ‚ùå Failed SILVER.COVERAGE: 000904 (42000): SQL compilation error: error line 2 at position 15
invalid identifier 'NODE_VALUE'
2025-10-06 02:13:40 - etl.executor - INFO - ‚úÖ Execution complete: 0 tables, 0 rows
2025-10-06 02:13:41 - loaders.snowflake_loader - INFO - ‚úÖ Connected to Snowflake: INSURANCE.ETL_MAPPER with role ACCOUNTADMIN
2025-10-06 02:13:42 - utils.database_helper - INFO - Loaded 166 approved mappings
2025-10-06 02:20:48 - utils.logging_config - INFO - Logging configured at INFO level
2025-10-06 02:20:51 - loaders.snowflake_loader - INFO - ‚úÖ Connected to Snowflake: INSURANCE.ETL_MAPPER with role ACCOUNTADMIN
2025-10-06 02:20:54 - utils.database_helper - INFO - Loaded 166 approved mappings
2025-10-06 02:21:21 - loaders.snowflake_loader - INFO - ‚úÖ Connected to Snowflake: INSURANCE.ETL_MAPPER with role ACCOUNTADMIN
2025-10-06 02:21:24 - utils.database_helper - INFO - Loaded 166 approved mappings
2025-10-06 02:21:30 - loaders.snowflake_loader - INFO - ‚úÖ Connected to Snowflake: INSURANCE.ETL_MAPPER with role ACCOUNTADMIN
2025-10-06 02:21:30 - utils.database_helper - INFO - Loaded 166 approved mappings
2025-10-06 02:21:31 - etl.executor - ERROR - ‚ùå Failed to process SILVER.QUOTE: 001003 (42000): SQL compilation error:
syntax error line 2 at position 28 unexpected '/'.
syntax error line 2 at position 102 unexpected '/'.
syntax error line 2 at position 172 unexpected '/'.
syntax error line 2 at position 246 unexpected '/'.
syntax error line 2 at position 320 unexpected '/'.
syntax error line 2 at position 397 unexpected '/'.
syntax error line 3 at position 45 unexpected '-'.
2025-10-06 02:21:31 - etl.executor - ERROR - Execution failed: 000904 (42000): SQL compilation error: error line 3 at position 16
invalid identifier 'LAST_EXECUTION_ID'
2025-10-06 02:24:12 - utils.logging_config - INFO - Logging configured at INFO level
2025-10-06 02:24:14 - loaders.snowflake_loader - INFO - ‚úÖ Connected to Snowflake: INSURANCE.ETL_MAPPER with role ACCOUNTADMIN
2025-10-06 02:24:18 - utils.database_helper - INFO - Loaded 166 approved mappings
2025-10-06 02:24:40 - loaders.snowflake_loader - INFO - ‚úÖ Connected to Snowflake: INSURANCE.ETL_MAPPER with role ACCOUNTADMIN
2025-10-06 02:24:42 - utils.database_helper - INFO - Loaded 166 approved mappings
2025-10-06 02:24:43 - etl.executor - ERROR - Insert failed for SILVER.QUOTE: 002003 (42S02): SQL compilation error:
Object 'INSURANCE.ETL_MAPPER.XML_STAGING' does not exist or not authorized.
2025-10-06 02:24:43 - etl.executor - ERROR - SQL was: 
        INSERT INTO SILVER.QUOTE (QUOTE_STATUS, QUOTE_DATE, QUOTE_ID, QUOTE_NUMBER, EXPIRY_DATE, EFFECTIVE_DATE)
        SELECT GET_PATH(stg.xml_data, '/Session/Data/QuoteData/QuoteStatus')::STRING AS QUOTE_STATUS, GET_PATH(stg.xml_data, '/Session/Data/QuoteData/QuoteDate')::STRING AS QUOTE_DATE, GET_PATH(stg.xml_data, '/Session/Data/QuoteData/QuoteIdentifier')::STRING AS QUOTE_ID, GET_PATH(stg.xml_data, '/Session/Data/QuoteData/QuoteNumber')::STRING AS QUOTE_NUMBER, GET_PATH(stg.xml_data, '/Session/Data/QuoteData/QuoteExpiryDate')::STRING AS EXPIRY_DATE, GET_PATH(stg.xml_data, '/Session/Data/QuoteData/ConversionDate')::STRING AS EFFECTIVE_DATE
        FROM INSURANCE.ETL_MAPPER.XML_STAGING stg
        WHERE stg.xml_id = 'XML-20251006020005'
          AND stg.processed = FALSE
        
2025-10-06 02:24:43 - etl.executor - ERROR - ‚ùå Failed to process SILVER.QUOTE: 002003 (42S02): SQL compilation error:
Object 'INSURANCE.ETL_MAPPER.XML_STAGING' does not exist or not authorized.
2025-10-06 02:24:44 - etl.executor - ERROR - Insert failed for SILVER.POLICY: 002003 (42S02): SQL compilation error:
Object 'INSURANCE.ETL_MAPPER.XML_STAGING' does not exist or not authorized.
2025-10-06 02:24:44 - etl.executor - ERROR - SQL was: 
        INSERT INTO SILVER.POLICY (POLICY_ID, POLICY_TYPE, PRODUCT_CODE, ACCOUNT_ID, CREATED_BY, DISTRIBUTION_CHANNEL, UNDERWRITING_COMPANY, PREMIUM_AMOUNT, TOTAL_INSURED_VALUE, POLICY_ID, POLICY_NUMBER, POLICY_TYPE, POLICY_STATUS, POLICY_STATUS, EFFECTIVE_DATE, EXPIRATION_DATE, CANCELLATION_DATE, RENEWAL_DATE, POLICY_TERM_MONTHS, PRODUCT_NAME, EFFECTIVE_DATE)
        SELECT GET_PATH(stg.xml_data, '/Session/TransactionInfo/TransactionID')::STRING AS POLICY_ID, GET_PATH(stg.xml_data, '/Session/TransactionInfo/TransactionType')::STRING AS POLICY_TYPE, GET_PATH(stg.xml_data, '/Session/Data/PolicyData/ProductDetails/ProdCode')::STRING AS PRODUCT_CODE, GET_PATH(stg.xml_data, '/Session/Data/BrokerData/BrokerID')::STRING AS ACCOUNT_ID, GET_PATH(stg.xml_data, '/Session/Data/BrokerData/BrokerName')::STRING AS CREATED_BY, GET_PATH(stg.xml_data, '/Session/Data/BrokerData/BrokerType')::STRING AS DISTRIBUTION_CHANNEL, GET_PATH(stg.xml_data, '/Session/Data/BrokerData/BrokerageFirm')::STRING AS UNDERWRITING_COMPANY, GET_PATH(stg.xml_data, '/Session/Data/BrokerData/CommissionRate')::STRING AS PREMIUM_AMOUNT, GET_PATH(stg.xml_data, '/Session/Data/BrokerData/CommissionAmount')::STRING AS TOTAL_INSURED_VALUE, GET_PATH(stg.xml_data, '/Session/Data/PolicyData/ID')::STRING AS POLICY_ID, GET_PATH(stg.xml_data, '/Session/Data/PolicyData/Number')::STRING AS POLICY_NUMBER, GET_PATH(stg.xml_data, '/Session/Data/PolicyData/Version')::STRING AS POLICY_TYPE, GET_PATH(stg.xml_data, '/Session/TransactionInfo/TransactionStatus')::STRING AS POLICY_STATUS, GET_PATH(stg.xml_data, '/Session/Data/PolicyData/StatusCode')::STRING AS POLICY_STATUS, GET_PATH(stg.xml_data, '/Session/Data/PolicyData/PolicyDates/InceptionDate')::STRING AS EFFECTIVE_DATE, GET_PATH(stg.xml_data, '/Session/Data/PolicyData/PolicyDates/TerminationDate')::STRING AS EXPIRATION_DATE, GET_PATH(stg.xml_data, '/Session/Data/PolicyData/PolicyDates/BindDate')::STRING AS CANCELLATION_DATE, GET_PATH(stg.xml_data, '/Session/Data/PolicyData/PolicyDates/QuoteDate')::STRING AS RENEWAL_DATE, GET_PATH(stg.xml_data, '/Session/Data/PolicyData/TermLength')::STRING AS POLICY_TERM_MONTHS, GET_PATH(stg.xml_data, '/Session/Data/PolicyData/ProductDetails/ProdDescription')::STRING AS PRODUCT_NAME, GET_PATH(stg.xml_data, '/Session/TransactionInfo/TransactionDate')::STRING AS EFFECTIVE_DATE
        FROM INSURANCE.ETL_MAPPER.XML_STAGING stg
        WHERE stg.xml_id = 'XML-20251006020005'
          AND stg.processed = FALSE
        
2025-10-06 02:24:44 - etl.executor - ERROR - ‚ùå Failed to process SILVER.POLICY: 002003 (42S02): SQL compilation error:
Object 'INSURANCE.ETL_MAPPER.XML_STAGING' does not exist or not authorized.
2025-10-06 02:24:44 - etl.executor - ERROR - Insert failed for SILVER.PAYMENT: 002003 (42S02): SQL compilation error:
Object 'INSURANCE.ETL_MAPPER.XML_STAGING' does not exist or not authorized.
2025-10-06 02:24:44 - etl.executor - ERROR - SQL was: 
        INSERT INTO SILVER.PAYMENT (PAYMENT_STATUS, CARD_TYPE, ROUTING_NUMBER, PAYMENT_TYPE, PAYMENT_ID, PAYMENT_NUMBER, PAYMENT_METHOD, PAYMENT_DATE, PAYMENT_AMOUNT, PAYMENT_TERM, TOTAL_INSTALLMENTS, ACCOUNT_HOLDER_NAME, BANK_NAME, ACCOUNT_NUMBER)
        SELECT GET_PATH(stg.xml_data, '/Session/Data/PaymentData/StatusDescription')::STRING AS PAYMENT_STATUS, GET_PATH(stg.xml_data, '/Session/Data/PaymentData/PaymentAccountInfo/AccountType')::STRING AS CARD_TYPE, GET_PATH(stg.xml_data, '/Session/Data/PaymentData/PaymentAccountInfo/RoutingNumber')::STRING AS ROUTING_NUMBER, GET_PATH(stg.xml_data, '/Session/Data/PaymentData/TransactionType')::STRING AS PAYMENT_TYPE, GET_PATH(stg.xml_data, '/Session/Data/PaymentData/PaymentIdentifier')::STRING AS PAYMENT_ID, GET_PATH(stg.xml_data, '/Session/Data/PaymentData/PaymentNumber')::STRING AS PAYMENT_NUMBER, GET_PATH(stg.xml_data, '/Session/Data/PaymentData/PaymentMode')::STRING AS PAYMENT_METHOD, GET_PATH(stg.xml_data, '/Session/Data/PaymentData/ScheduledDate')::STRING AS PAYMENT_DATE, GET_PATH(stg.xml_data, '/Session/Data/PaymentData/TransactionAmount')::STRING AS PAYMENT_AMOUNT, GET_PATH(stg.xml_data, '/Session/Data/PaymentData/BillingPlan')::STRING AS PAYMENT_TERM, GET_PATH(stg.xml_data, '/Session/Data/PaymentData/TotalInstallments')::STRING AS TOTAL_INSTALLMENTS, GET_PATH(stg.xml_data, '/Session/Data/PaymentData/PaymentAccountInfo/NameOnAccount')::STRING AS ACCOUNT_HOLDER_NAME, GET_PATH(stg.xml_data, '/Session/Data/PaymentData/PaymentAccountInfo/FinancialInstitution')::STRING AS BANK_NAME, GET_PATH(stg.xml_data, '/Session/Data/PaymentData/PaymentAccountInfo/AccountNumber')::STRING AS ACCOUNT_NUMBER
        FROM INSURANCE.ETL_MAPPER.XML_STAGING stg
        WHERE stg.xml_id = 'XML-20251006020005'
          AND stg.processed = FALSE
        
2025-10-06 02:24:44 - etl.executor - ERROR - ‚ùå Failed to process SILVER.PAYMENT: 002003 (42S02): SQL compilation error:
Object 'INSURANCE.ETL_MAPPER.XML_STAGING' does not exist or not authorized.
2025-10-06 02:24:44 - etl.executor - ERROR - Insert failed for SILVER.RISK: 002003 (42S02): SQL compilation error:
Object 'INSURANCE.ETL_MAPPER.XML_STAGING' does not exist or not authorized.
2025-10-06 02:24:44 - etl.executor - ERROR - SQL was: 
        INSERT INTO SILVER.RISK (RISK_ADDRESS_LINE2, RISK_CITY, RISK_ID, POLICY_ID, RISK_TYPE, RISK_DESCRIPTION, RISK_NUMBER, RISK_ADDRESS_LINE1, RISK_STATE, RISK_ZIP, RISK_COUNTRY)
        SELECT GET_PATH(stg.xml_data, '/Session/Data/RiskData/LocationDetails/AddressLine2')::STRING AS RISK_ADDRESS_LINE2, GET_PATH(stg.xml_data, '/Session/Data/RiskData/LocationDetails/City')::STRING AS RISK_CITY, GET_PATH(stg.xml_data, '/Session/Data/RiskData/RiskIdentifier')::STRING AS RISK_ID, GET_PATH(stg.xml_data, '/Session/Data/RiskData/RiskSequence')::STRING AS POLICY_ID, GET_PATH(stg.xml_data, '/Session/Data/RiskData/RiskClass')::STRING AS RISK_TYPE, GET_PATH(stg.xml_data, '/Session/Data/RiskData/RiskSummary')::STRING AS RISK_DESCRIPTION, GET_PATH(stg.xml_data, '/Session/Data/RiskData/LocationDetails/LocationNumber')::STRING AS RISK_NUMBER, GET_PATH(stg.xml_data, '/Session/Data/RiskData/LocationDetails/AddressLine1')::STRING AS RISK_ADDRESS_LINE1, GET_PATH(stg.xml_data, '/Session/Data/RiskData/LocationDetails/State')::STRING AS RISK_STATE, GET_PATH(stg.xml_data, '/Session/Data/RiskData/LocationDetails/ZipCode')::STRING AS RISK_ZIP, GET_PATH(stg.xml_data, '/Session/Data/RiskData/LocationDetails/Country')::STRING AS RISK_COUNTRY
        FROM INSURANCE.ETL_MAPPER.XML_STAGING stg
        WHERE stg.xml_id = 'XML-20251006020005'
          AND stg.processed = FALSE
        
2025-10-06 02:24:44 - etl.executor - ERROR - ‚ùå Failed to process SILVER.RISK: 002003 (42S02): SQL compilation error:
Object 'INSURANCE.ETL_MAPPER.XML_STAGING' does not exist or not authorized.
2025-10-06 02:24:45 - etl.executor - ERROR - Insert failed for SILVER.COVERAGE: 002003 (42S02): SQL compilation error:
Object 'INSURANCE.ETL_MAPPER.XML_STAGING' does not exist or not authorized.
2025-10-06 02:24:45 - etl.executor - ERROR - SQL was: 
        INSERT INTO SILVER.COVERAGE (COVERAGE_ID, RISK_ID, COVERAGE_CODE, COVERAGE_NAME, COVERAGE_TYPE, COVERAGE_LIMIT, COVERAGE_PREMIUM, COINSURANCE_PERCENTAGE, EFFECTIVE_DATE, EXPIRATION_DATE, IS_MANDATORY, COVERAGE_BASIS, COVERAGE_DEDUCTIBLE)
        SELECT GET_PATH(stg.xml_data, '/Session/Data/CoverageData/CoverageRecord/CoverageIdentifier')::STRING AS COVERAGE_ID, GET_PATH(stg.xml_data, '/Session/Data/CoverageData/CoverageRecord/RiskIdentifier')::STRING AS RISK_ID, GET_PATH(stg.xml_data, '/Session/Data/CoverageData/CoverageRecord/CoverageSymbol')::STRING AS COVERAGE_CODE, GET_PATH(stg.xml_data, '/Session/Data/CoverageData/CoverageRecord/CoverageDescription')::STRING AS COVERAGE_NAME, GET_PATH(stg.xml_data, '/Session/Data/CoverageData/CoverageRecord/CoverageClass')::STRING AS COVERAGE_TYPE, GET_PATH(stg.xml_data, '/Session/Data/CoverageData/CoverageRecord/MaxLimit')::STRING AS COVERAGE_LIMIT, GET_PATH(stg.xml_data, '/Session/Data/CoverageData/CoverageRecord/CoveragePremium')::STRING AS COVERAGE_PREMIUM, GET_PATH(stg.xml_data, '/Session/Data/CoverageData/CoverageRecord/CoinsurancePercent')::STRING AS COINSURANCE_PERCENTAGE, GET_PATH(stg.xml_data, '/Session/Data/CoverageData/CoverageRecord/CoverageStartDate')::STRING AS EFFECTIVE_DATE, GET_PATH(stg.xml_data, '/Session/Data/CoverageData/CoverageRecord/CoverageEndDate')::STRING AS EXPIRATION_DATE, GET_PATH(stg.xml_data, '/Session/Data/CoverageData/CoverageRecord/IsMandatory')::STRING AS IS_MANDATORY, GET_PATH(stg.xml_data, '/Session/Data/CoverageData/CoverageRecord/CoverageBasis')::STRING AS COVERAGE_BASIS, GET_PATH(stg.xml_data, '/Session/Data/CoverageData/CoverageRecord/CoverageDeductible')::STRING AS COVERAGE_DEDUCTIBLE
        FROM INSURANCE.ETL_MAPPER.XML_STAGING stg
        WHERE stg.xml_id = 'XML-20251006020005'
          AND stg.processed = FALSE
        
2025-10-06 02:24:45 - etl.executor - ERROR - ‚ùå Failed to process SILVER.COVERAGE: 002003 (42S02): SQL compilation error:
Object 'INSURANCE.ETL_MAPPER.XML_STAGING' does not exist or not authorized.
2025-10-06 02:24:47 - loaders.snowflake_loader - INFO - ‚úÖ Connected to Snowflake: INSURANCE.ETL_MAPPER with role ACCOUNTADMIN
2025-10-06 02:24:48 - utils.database_helper - INFO - Loaded 166 approved mappings
2025-10-06 02:25:29 - loaders.snowflake_loader - INFO - ‚úÖ Connected to Snowflake: INSURANCE.ETL_MAPPER with role ACCOUNTADMIN
2025-10-06 02:25:32 - utils.database_helper - INFO - Loaded 166 approved mappings
2025-10-06 02:26:18 - loaders.snowflake_loader - INFO - ‚úÖ Connected to Snowflake: INSURANCE.ETL_MAPPER with role ACCOUNTADMIN
2025-10-06 02:26:21 - utils.database_helper - INFO - Loaded 166 approved mappings
2025-10-06 02:26:21 - etl.executor - ERROR - Insert failed for SILVER.QUOTE: 002003 (42S02): SQL compilation error:
Object 'INSURANCE.ETL_MAPPER.XML_STAGING' does not exist or not authorized.
2025-10-06 02:26:21 - etl.executor - ERROR - SQL was: 
        INSERT INTO SILVER.QUOTE (QUOTE_STATUS, QUOTE_DATE, QUOTE_ID, QUOTE_NUMBER, EXPIRY_DATE, EFFECTIVE_DATE)
        SELECT GET_PATH(stg.xml_data, '/Session/Data/QuoteData/QuoteStatus')::STRING AS QUOTE_STATUS, GET_PATH(stg.xml_data, '/Session/Data/QuoteData/QuoteDate')::STRING AS QUOTE_DATE, GET_PATH(stg.xml_data, '/Session/Data/QuoteData/QuoteIdentifier')::STRING AS QUOTE_ID, GET_PATH(stg.xml_data, '/Session/Data/QuoteData/QuoteNumber')::STRING AS QUOTE_NUMBER, GET_PATH(stg.xml_data, '/Session/Data/QuoteData/QuoteExpiryDate')::STRING AS EXPIRY_DATE, GET_PATH(stg.xml_data, '/Session/Data/QuoteData/ConversionDate')::STRING AS EFFECTIVE_DATE
        FROM INSURANCE.ETL_MAPPER.XML_STAGING stg
        WHERE stg.xml_id = 'XML-20251006020005'
          AND stg.processed = FALSE
        
2025-10-06 02:26:21 - etl.executor - ERROR - ‚ùå Failed to process SILVER.QUOTE: 002003 (42S02): SQL compilation error:
Object 'INSURANCE.ETL_MAPPER.XML_STAGING' does not exist or not authorized.
2025-10-06 02:26:22 - etl.executor - ERROR - Insert failed for SILVER.POLICY: 002003 (42S02): SQL compilation error:
Object 'INSURANCE.ETL_MAPPER.XML_STAGING' does not exist or not authorized.
2025-10-06 02:26:22 - etl.executor - ERROR - SQL was: 
        INSERT INTO SILVER.POLICY (POLICY_ID, POLICY_TYPE, PRODUCT_CODE, ACCOUNT_ID, CREATED_BY, DISTRIBUTION_CHANNEL, UNDERWRITING_COMPANY, PREMIUM_AMOUNT, TOTAL_INSURED_VALUE, POLICY_ID, POLICY_NUMBER, POLICY_TYPE, POLICY_STATUS, POLICY_STATUS, EFFECTIVE_DATE, EXPIRATION_DATE, CANCELLATION_DATE, RENEWAL_DATE, POLICY_TERM_MONTHS, PRODUCT_NAME, EFFECTIVE_DATE)
        SELECT GET_PATH(stg.xml_data, '/Session/TransactionInfo/TransactionID')::STRING AS POLICY_ID, GET_PATH(stg.xml_data, '/Session/TransactionInfo/TransactionType')::STRING AS POLICY_TYPE, GET_PATH(stg.xml_data, '/Session/Data/PolicyData/ProductDetails/ProdCode')::STRING AS PRODUCT_CODE, GET_PATH(stg.xml_data, '/Session/Data/BrokerData/BrokerID')::STRING AS ACCOUNT_ID, GET_PATH(stg.xml_data, '/Session/Data/BrokerData/BrokerName')::STRING AS CREATED_BY, GET_PATH(stg.xml_data, '/Session/Data/BrokerData/BrokerType')::STRING AS DISTRIBUTION_CHANNEL, GET_PATH(stg.xml_data, '/Session/Data/BrokerData/BrokerageFirm')::STRING AS UNDERWRITING_COMPANY, GET_PATH(stg.xml_data, '/Session/Data/BrokerData/CommissionRate')::STRING AS PREMIUM_AMOUNT, GET_PATH(stg.xml_data, '/Session/Data/BrokerData/CommissionAmount')::STRING AS TOTAL_INSURED_VALUE, GET_PATH(stg.xml_data, '/Session/Data/PolicyData/ID')::STRING AS POLICY_ID, GET_PATH(stg.xml_data, '/Session/Data/PolicyData/Number')::STRING AS POLICY_NUMBER, GET_PATH(stg.xml_data, '/Session/Data/PolicyData/Version')::STRING AS POLICY_TYPE, GET_PATH(stg.xml_data, '/Session/TransactionInfo/TransactionStatus')::STRING AS POLICY_STATUS, GET_PATH(stg.xml_data, '/Session/Data/PolicyData/StatusCode')::STRING AS POLICY_STATUS, GET_PATH(stg.xml_data, '/Session/Data/PolicyData/PolicyDates/InceptionDate')::STRING AS EFFECTIVE_DATE, GET_PATH(stg.xml_data, '/Session/Data/PolicyData/PolicyDates/TerminationDate')::STRING AS EXPIRATION_DATE, GET_PATH(stg.xml_data, '/Session/Data/PolicyData/PolicyDates/BindDate')::STRING AS CANCELLATION_DATE, GET_PATH(stg.xml_data, '/Session/Data/PolicyData/PolicyDates/QuoteDate')::STRING AS RENEWAL_DATE, GET_PATH(stg.xml_data, '/Session/Data/PolicyData/TermLength')::STRING AS POLICY_TERM_MONTHS, GET_PATH(stg.xml_data, '/Session/Data/PolicyData/ProductDetails/ProdDescription')::STRING AS PRODUCT_NAME, GET_PATH(stg.xml_data, '/Session/TransactionInfo/TransactionDate')::STRING AS EFFECTIVE_DATE
        FROM INSURANCE.ETL_MAPPER.XML_STAGING stg
        WHERE stg.xml_id = 'XML-20251006020005'
          AND stg.processed = FALSE
        
2025-10-06 02:26:22 - etl.executor - ERROR - ‚ùå Failed to process SILVER.POLICY: 002003 (42S02): SQL compilation error:
Object 'INSURANCE.ETL_MAPPER.XML_STAGING' does not exist or not authorized.
2025-10-06 02:26:22 - etl.executor - ERROR - Insert failed for SILVER.PAYMENT: 002003 (42S02): SQL compilation error:
Object 'INSURANCE.ETL_MAPPER.XML_STAGING' does not exist or not authorized.
2025-10-06 02:26:22 - etl.executor - ERROR - SQL was: 
        INSERT INTO SILVER.PAYMENT (PAYMENT_STATUS, CARD_TYPE, ROUTING_NUMBER, PAYMENT_TYPE, PAYMENT_ID, PAYMENT_NUMBER, PAYMENT_METHOD, PAYMENT_DATE, PAYMENT_AMOUNT, PAYMENT_TERM, TOTAL_INSTALLMENTS, ACCOUNT_HOLDER_NAME, BANK_NAME, ACCOUNT_NUMBER)
        SELECT GET_PATH(stg.xml_data, '/Session/Data/PaymentData/StatusDescription')::STRING AS PAYMENT_STATUS, GET_PATH(stg.xml_data, '/Session/Data/PaymentData/PaymentAccountInfo/AccountType')::STRING AS CARD_TYPE, GET_PATH(stg.xml_data, '/Session/Data/PaymentData/PaymentAccountInfo/RoutingNumber')::STRING AS ROUTING_NUMBER, GET_PATH(stg.xml_data, '/Session/Data/PaymentData/TransactionType')::STRING AS PAYMENT_TYPE, GET_PATH(stg.xml_data, '/Session/Data/PaymentData/PaymentIdentifier')::STRING AS PAYMENT_ID, GET_PATH(stg.xml_data, '/Session/Data/PaymentData/PaymentNumber')::STRING AS PAYMENT_NUMBER, GET_PATH(stg.xml_data, '/Session/Data/PaymentData/PaymentMode')::STRING AS PAYMENT_METHOD, GET_PATH(stg.xml_data, '/Session/Data/PaymentData/ScheduledDate')::STRING AS PAYMENT_DATE, GET_PATH(stg.xml_data, '/Session/Data/PaymentData/TransactionAmount')::STRING AS PAYMENT_AMOUNT, GET_PATH(stg.xml_data, '/Session/Data/PaymentData/BillingPlan')::STRING AS PAYMENT_TERM, GET_PATH(stg.xml_data, '/Session/Data/PaymentData/TotalInstallments')::STRING AS TOTAL_INSTALLMENTS, GET_PATH(stg.xml_data, '/Session/Data/PaymentData/PaymentAccountInfo/NameOnAccount')::STRING AS ACCOUNT_HOLDER_NAME, GET_PATH(stg.xml_data, '/Session/Data/PaymentData/PaymentAccountInfo/FinancialInstitution')::STRING AS BANK_NAME, GET_PATH(stg.xml_data, '/Session/Data/PaymentData/PaymentAccountInfo/AccountNumber')::STRING AS ACCOUNT_NUMBER
        FROM INSURANCE.ETL_MAPPER.XML_STAGING stg
        WHERE stg.xml_id = 'XML-20251006020005'
          AND stg.processed = FALSE
        
2025-10-06 02:26:22 - etl.executor - ERROR - ‚ùå Failed to process SILVER.PAYMENT: 002003 (42S02): SQL compilation error:
Object 'INSURANCE.ETL_MAPPER.XML_STAGING' does not exist or not authorized.
2025-10-06 02:26:23 - etl.executor - ERROR - Insert failed for SILVER.RISK: 002003 (42S02): SQL compilation error:
Object 'INSURANCE.ETL_MAPPER.XML_STAGING' does not exist or not authorized.
2025-10-06 02:26:23 - etl.executor - ERROR - SQL was: 
        INSERT INTO SILVER.RISK (RISK_ADDRESS_LINE2, RISK_CITY, RISK_ID, POLICY_ID, RISK_TYPE, RISK_DESCRIPTION, RISK_NUMBER, RISK_ADDRESS_LINE1, RISK_STATE, RISK_ZIP, RISK_COUNTRY)
        SELECT GET_PATH(stg.xml_data, '/Session/Data/RiskData/LocationDetails/AddressLine2')::STRING AS RISK_ADDRESS_LINE2, GET_PATH(stg.xml_data, '/Session/Data/RiskData/LocationDetails/City')::STRING AS RISK_CITY, GET_PATH(stg.xml_data, '/Session/Data/RiskData/RiskIdentifier')::STRING AS RISK_ID, GET_PATH(stg.xml_data, '/Session/Data/RiskData/RiskSequence')::STRING AS POLICY_ID, GET_PATH(stg.xml_data, '/Session/Data/RiskData/RiskClass')::STRING AS RISK_TYPE, GET_PATH(stg.xml_data, '/Session/Data/RiskData/RiskSummary')::STRING AS RISK_DESCRIPTION, GET_PATH(stg.xml_data, '/Session/Data/RiskData/LocationDetails/LocationNumber')::STRING AS RISK_NUMBER, GET_PATH(stg.xml_data, '/Session/Data/RiskData/LocationDetails/AddressLine1')::STRING AS RISK_ADDRESS_LINE1, GET_PATH(stg.xml_data, '/Session/Data/RiskData/LocationDetails/State')::STRING AS RISK_STATE, GET_PATH(stg.xml_data, '/Session/Data/RiskData/LocationDetails/ZipCode')::STRING AS RISK_ZIP, GET_PATH(stg.xml_data, '/Session/Data/RiskData/LocationDetails/Country')::STRING AS RISK_COUNTRY
        FROM INSURANCE.ETL_MAPPER.XML_STAGING stg
        WHERE stg.xml_id = 'XML-20251006020005'
          AND stg.processed = FALSE
        
2025-10-06 02:26:23 - etl.executor - ERROR - ‚ùå Failed to process SILVER.RISK: 002003 (42S02): SQL compilation error:
Object 'INSURANCE.ETL_MAPPER.XML_STAGING' does not exist or not authorized.
2025-10-06 02:26:23 - etl.executor - ERROR - Insert failed for SILVER.COVERAGE: 002003 (42S02): SQL compilation error:
Object 'INSURANCE.ETL_MAPPER.XML_STAGING' does not exist or not authorized.
2025-10-06 02:26:23 - etl.executor - ERROR - SQL was: 
        INSERT INTO SILVER.COVERAGE (COVERAGE_ID, RISK_ID, COVERAGE_CODE, COVERAGE_NAME, COVERAGE_TYPE, COVERAGE_LIMIT, COVERAGE_PREMIUM, COINSURANCE_PERCENTAGE, EFFECTIVE_DATE, EXPIRATION_DATE, IS_MANDATORY, COVERAGE_BASIS, COVERAGE_DEDUCTIBLE)
        SELECT GET_PATH(stg.xml_data, '/Session/Data/CoverageData/CoverageRecord/CoverageIdentifier')::STRING AS COVERAGE_ID, GET_PATH(stg.xml_data, '/Session/Data/CoverageData/CoverageRecord/RiskIdentifier')::STRING AS RISK_ID, GET_PATH(stg.xml_data, '/Session/Data/CoverageData/CoverageRecord/CoverageSymbol')::STRING AS COVERAGE_CODE, GET_PATH(stg.xml_data, '/Session/Data/CoverageData/CoverageRecord/CoverageDescription')::STRING AS COVERAGE_NAME, GET_PATH(stg.xml_data, '/Session/Data/CoverageData/CoverageRecord/CoverageClass')::STRING AS COVERAGE_TYPE, GET_PATH(stg.xml_data, '/Session/Data/CoverageData/CoverageRecord/MaxLimit')::STRING AS COVERAGE_LIMIT, GET_PATH(stg.xml_data, '/Session/Data/CoverageData/CoverageRecord/CoveragePremium')::STRING AS COVERAGE_PREMIUM, GET_PATH(stg.xml_data, '/Session/Data/CoverageData/CoverageRecord/CoinsurancePercent')::STRING AS COINSURANCE_PERCENTAGE, GET_PATH(stg.xml_data, '/Session/Data/CoverageData/CoverageRecord/CoverageStartDate')::STRING AS EFFECTIVE_DATE, GET_PATH(stg.xml_data, '/Session/Data/CoverageData/CoverageRecord/CoverageEndDate')::STRING AS EXPIRATION_DATE, GET_PATH(stg.xml_data, '/Session/Data/CoverageData/CoverageRecord/IsMandatory')::STRING AS IS_MANDATORY, GET_PATH(stg.xml_data, '/Session/Data/CoverageData/CoverageRecord/CoverageBasis')::STRING AS COVERAGE_BASIS, GET_PATH(stg.xml_data, '/Session/Data/CoverageData/CoverageRecord/CoverageDeductible')::STRING AS COVERAGE_DEDUCTIBLE
        FROM INSURANCE.ETL_MAPPER.XML_STAGING stg
        WHERE stg.xml_id = 'XML-20251006020005'
          AND stg.processed = FALSE
        
2025-10-06 02:26:23 - etl.executor - ERROR - ‚ùå Failed to process SILVER.COVERAGE: 002003 (42S02): SQL compilation error:
Object 'INSURANCE.ETL_MAPPER.XML_STAGING' does not exist or not authorized.
2025-10-06 02:26:24 - loaders.snowflake_loader - INFO - ‚úÖ Connected to Snowflake: INSURANCE.ETL_MAPPER with role ACCOUNTADMIN
2025-10-06 02:26:25 - utils.database_helper - INFO - Loaded 166 approved mappings
2025-10-06 02:27:11 - loaders.snowflake_loader - INFO - ‚úÖ Connected to Snowflake: INSURANCE.ETL_MAPPER with role ACCOUNTADMIN
2025-10-06 02:27:14 - utils.database_helper - INFO - Loaded 166 approved mappings
2025-10-06 02:27:14 - etl.executor - ERROR - Insert failed for SILVER.QUOTE: 002003 (42S02): SQL compilation error:
Object 'INSURANCE.ETL_MAPPER.XML_STAGING' does not exist or not authorized.
2025-10-06 02:27:14 - etl.executor - ERROR - SQL was: 
        INSERT INTO SILVER.QUOTE (QUOTE_STATUS, QUOTE_DATE, QUOTE_ID, QUOTE_NUMBER, EXPIRY_DATE, EFFECTIVE_DATE)
        SELECT GET_PATH(stg.xml_data, '/Session/Data/QuoteData/QuoteStatus')::STRING AS QUOTE_STATUS, GET_PATH(stg.xml_data, '/Session/Data/QuoteData/QuoteDate')::STRING AS QUOTE_DATE, GET_PATH(stg.xml_data, '/Session/Data/QuoteData/QuoteIdentifier')::STRING AS QUOTE_ID, GET_PATH(stg.xml_data, '/Session/Data/QuoteData/QuoteNumber')::STRING AS QUOTE_NUMBER, GET_PATH(stg.xml_data, '/Session/Data/QuoteData/QuoteExpiryDate')::STRING AS EXPIRY_DATE, GET_PATH(stg.xml_data, '/Session/Data/QuoteData/ConversionDate')::STRING AS EFFECTIVE_DATE
        FROM INSURANCE.ETL_MAPPER.XML_STAGING stg
        WHERE stg.xml_id = 'XML-20251006020005'
          AND stg.processed = FALSE
        
2025-10-06 02:27:14 - etl.executor - ERROR - ‚ùå Failed to process SILVER.QUOTE: 002003 (42S02): SQL compilation error:
Object 'INSURANCE.ETL_MAPPER.XML_STAGING' does not exist or not authorized.
2025-10-06 02:27:15 - etl.executor - ERROR - Insert failed for SILVER.POLICY: 002003 (42S02): SQL compilation error:
Object 'INSURANCE.ETL_MAPPER.XML_STAGING' does not exist or not authorized.
2025-10-06 02:27:15 - etl.executor - ERROR - SQL was: 
        INSERT INTO SILVER.POLICY (POLICY_ID, POLICY_TYPE, PRODUCT_CODE, ACCOUNT_ID, CREATED_BY, DISTRIBUTION_CHANNEL, UNDERWRITING_COMPANY, PREMIUM_AMOUNT, TOTAL_INSURED_VALUE, POLICY_ID, POLICY_NUMBER, POLICY_TYPE, POLICY_STATUS, POLICY_STATUS, EFFECTIVE_DATE, EXPIRATION_DATE, CANCELLATION_DATE, RENEWAL_DATE, POLICY_TERM_MONTHS, PRODUCT_NAME, EFFECTIVE_DATE)
        SELECT GET_PATH(stg.xml_data, '/Session/TransactionInfo/TransactionID')::STRING AS POLICY_ID, GET_PATH(stg.xml_data, '/Session/TransactionInfo/TransactionType')::STRING AS POLICY_TYPE, GET_PATH(stg.xml_data, '/Session/Data/PolicyData/ProductDetails/ProdCode')::STRING AS PRODUCT_CODE, GET_PATH(stg.xml_data, '/Session/Data/BrokerData/BrokerID')::STRING AS ACCOUNT_ID, GET_PATH(stg.xml_data, '/Session/Data/BrokerData/BrokerName')::STRING AS CREATED_BY, GET_PATH(stg.xml_data, '/Session/Data/BrokerData/BrokerType')::STRING AS DISTRIBUTION_CHANNEL, GET_PATH(stg.xml_data, '/Session/Data/BrokerData/BrokerageFirm')::STRING AS UNDERWRITING_COMPANY, GET_PATH(stg.xml_data, '/Session/Data/BrokerData/CommissionRate')::STRING AS PREMIUM_AMOUNT, GET_PATH(stg.xml_data, '/Session/Data/BrokerData/CommissionAmount')::STRING AS TOTAL_INSURED_VALUE, GET_PATH(stg.xml_data, '/Session/Data/PolicyData/ID')::STRING AS POLICY_ID, GET_PATH(stg.xml_data, '/Session/Data/PolicyData/Number')::STRING AS POLICY_NUMBER, GET_PATH(stg.xml_data, '/Session/Data/PolicyData/Version')::STRING AS POLICY_TYPE, GET_PATH(stg.xml_data, '/Session/TransactionInfo/TransactionStatus')::STRING AS POLICY_STATUS, GET_PATH(stg.xml_data, '/Session/Data/PolicyData/StatusCode')::STRING AS POLICY_STATUS, GET_PATH(stg.xml_data, '/Session/Data/PolicyData/PolicyDates/InceptionDate')::STRING AS EFFECTIVE_DATE, GET_PATH(stg.xml_data, '/Session/Data/PolicyData/PolicyDates/TerminationDate')::STRING AS EXPIRATION_DATE, GET_PATH(stg.xml_data, '/Session/Data/PolicyData/PolicyDates/BindDate')::STRING AS CANCELLATION_DATE, GET_PATH(stg.xml_data, '/Session/Data/PolicyData/PolicyDates/QuoteDate')::STRING AS RENEWAL_DATE, GET_PATH(stg.xml_data, '/Session/Data/PolicyData/TermLength')::STRING AS POLICY_TERM_MONTHS, GET_PATH(stg.xml_data, '/Session/Data/PolicyData/ProductDetails/ProdDescription')::STRING AS PRODUCT_NAME, GET_PATH(stg.xml_data, '/Session/TransactionInfo/TransactionDate')::STRING AS EFFECTIVE_DATE
        FROM INSURANCE.ETL_MAPPER.XML_STAGING stg
        WHERE stg.xml_id = 'XML-20251006020005'
          AND stg.processed = FALSE
        
2025-10-06 02:27:15 - etl.executor - ERROR - ‚ùå Failed to process SILVER.POLICY: 002003 (42S02): SQL compilation error:
Object 'INSURANCE.ETL_MAPPER.XML_STAGING' does not exist or not authorized.
2025-10-06 02:27:15 - etl.executor - ERROR - Insert failed for SILVER.PAYMENT: 002003 (42S02): SQL compilation error:
Object 'INSURANCE.ETL_MAPPER.XML_STAGING' does not exist or not authorized.
2025-10-06 02:27:15 - etl.executor - ERROR - SQL was: 
        INSERT INTO SILVER.PAYMENT (PAYMENT_STATUS, CARD_TYPE, ROUTING_NUMBER, PAYMENT_TYPE, PAYMENT_ID, PAYMENT_NUMBER, PAYMENT_METHOD, PAYMENT_DATE, PAYMENT_AMOUNT, PAYMENT_TERM, TOTAL_INSTALLMENTS, ACCOUNT_HOLDER_NAME, BANK_NAME, ACCOUNT_NUMBER)
        SELECT GET_PATH(stg.xml_data, '/Session/Data/PaymentData/StatusDescription')::STRING AS PAYMENT_STATUS, GET_PATH(stg.xml_data, '/Session/Data/PaymentData/PaymentAccountInfo/AccountType')::STRING AS CARD_TYPE, GET_PATH(stg.xml_data, '/Session/Data/PaymentData/PaymentAccountInfo/RoutingNumber')::STRING AS ROUTING_NUMBER, GET_PATH(stg.xml_data, '/Session/Data/PaymentData/TransactionType')::STRING AS PAYMENT_TYPE, GET_PATH(stg.xml_data, '/Session/Data/PaymentData/PaymentIdentifier')::STRING AS PAYMENT_ID, GET_PATH(stg.xml_data, '/Session/Data/PaymentData/PaymentNumber')::STRING AS PAYMENT_NUMBER, GET_PATH(stg.xml_data, '/Session/Data/PaymentData/PaymentMode')::STRING AS PAYMENT_METHOD, GET_PATH(stg.xml_data, '/Session/Data/PaymentData/ScheduledDate')::STRING AS PAYMENT_DATE, GET_PATH(stg.xml_data, '/Session/Data/PaymentData/TransactionAmount')::STRING AS PAYMENT_AMOUNT, GET_PATH(stg.xml_data, '/Session/Data/PaymentData/BillingPlan')::STRING AS PAYMENT_TERM, GET_PATH(stg.xml_data, '/Session/Data/PaymentData/TotalInstallments')::STRING AS TOTAL_INSTALLMENTS, GET_PATH(stg.xml_data, '/Session/Data/PaymentData/PaymentAccountInfo/NameOnAccount')::STRING AS ACCOUNT_HOLDER_NAME, GET_PATH(stg.xml_data, '/Session/Data/PaymentData/PaymentAccountInfo/FinancialInstitution')::STRING AS BANK_NAME, GET_PATH(stg.xml_data, '/Session/Data/PaymentData/PaymentAccountInfo/AccountNumber')::STRING AS ACCOUNT_NUMBER
        FROM INSURANCE.ETL_MAPPER.XML_STAGING stg
        WHERE stg.xml_id = 'XML-20251006020005'
          AND stg.processed = FALSE
        
2025-10-06 02:27:15 - etl.executor - ERROR - ‚ùå Failed to process SILVER.PAYMENT: 002003 (42S02): SQL compilation error:
Object 'INSURANCE.ETL_MAPPER.XML_STAGING' does not exist or not authorized.
2025-10-06 02:27:16 - etl.executor - ERROR - Insert failed for SILVER.RISK: 002003 (42S02): SQL compilation error:
Object 'INSURANCE.ETL_MAPPER.XML_STAGING' does not exist or not authorized.
2025-10-06 02:27:16 - etl.executor - ERROR - SQL was: 
        INSERT INTO SILVER.RISK (RISK_ADDRESS_LINE2, RISK_CITY, RISK_ID, POLICY_ID, RISK_TYPE, RISK_DESCRIPTION, RISK_NUMBER, RISK_ADDRESS_LINE1, RISK_STATE, RISK_ZIP, RISK_COUNTRY)
        SELECT GET_PATH(stg.xml_data, '/Session/Data/RiskData/LocationDetails/AddressLine2')::STRING AS RISK_ADDRESS_LINE2, GET_PATH(stg.xml_data, '/Session/Data/RiskData/LocationDetails/City')::STRING AS RISK_CITY, GET_PATH(stg.xml_data, '/Session/Data/RiskData/RiskIdentifier')::STRING AS RISK_ID, GET_PATH(stg.xml_data, '/Session/Data/RiskData/RiskSequence')::STRING AS POLICY_ID, GET_PATH(stg.xml_data, '/Session/Data/RiskData/RiskClass')::STRING AS RISK_TYPE, GET_PATH(stg.xml_data, '/Session/Data/RiskData/RiskSummary')::STRING AS RISK_DESCRIPTION, GET_PATH(stg.xml_data, '/Session/Data/RiskData/LocationDetails/LocationNumber')::STRING AS RISK_NUMBER, GET_PATH(stg.xml_data, '/Session/Data/RiskData/LocationDetails/AddressLine1')::STRING AS RISK_ADDRESS_LINE1, GET_PATH(stg.xml_data, '/Session/Data/RiskData/LocationDetails/State')::STRING AS RISK_STATE, GET_PATH(stg.xml_data, '/Session/Data/RiskData/LocationDetails/ZipCode')::STRING AS RISK_ZIP, GET_PATH(stg.xml_data, '/Session/Data/RiskData/LocationDetails/Country')::STRING AS RISK_COUNTRY
        FROM INSURANCE.ETL_MAPPER.XML_STAGING stg
        WHERE stg.xml_id = 'XML-20251006020005'
          AND stg.processed = FALSE
        
2025-10-06 02:27:16 - etl.executor - ERROR - ‚ùå Failed to process SILVER.RISK: 002003 (42S02): SQL compilation error:
Object 'INSURANCE.ETL_MAPPER.XML_STAGING' does not exist or not authorized.
2025-10-06 02:27:17 - etl.executor - ERROR - Insert failed for SILVER.COVERAGE: 002003 (42S02): SQL compilation error:
Object 'INSURANCE.ETL_MAPPER.XML_STAGING' does not exist or not authorized.
2025-10-06 02:27:17 - etl.executor - ERROR - SQL was: 
        INSERT INTO SILVER.COVERAGE (COVERAGE_ID, RISK_ID, COVERAGE_CODE, COVERAGE_NAME, COVERAGE_TYPE, COVERAGE_LIMIT, COVERAGE_PREMIUM, COINSURANCE_PERCENTAGE, EFFECTIVE_DATE, EXPIRATION_DATE, IS_MANDATORY, COVERAGE_BASIS, COVERAGE_DEDUCTIBLE)
        SELECT GET_PATH(stg.xml_data, '/Session/Data/CoverageData/CoverageRecord/CoverageIdentifier')::STRING AS COVERAGE_ID, GET_PATH(stg.xml_data, '/Session/Data/CoverageData/CoverageRecord/RiskIdentifier')::STRING AS RISK_ID, GET_PATH(stg.xml_data, '/Session/Data/CoverageData/CoverageRecord/CoverageSymbol')::STRING AS COVERAGE_CODE, GET_PATH(stg.xml_data, '/Session/Data/CoverageData/CoverageRecord/CoverageDescription')::STRING AS COVERAGE_NAME, GET_PATH(stg.xml_data, '/Session/Data/CoverageData/CoverageRecord/CoverageClass')::STRING AS COVERAGE_TYPE, GET_PATH(stg.xml_data, '/Session/Data/CoverageData/CoverageRecord/MaxLimit')::STRING AS COVERAGE_LIMIT, GET_PATH(stg.xml_data, '/Session/Data/CoverageData/CoverageRecord/CoveragePremium')::STRING AS COVERAGE_PREMIUM, GET_PATH(stg.xml_data, '/Session/Data/CoverageData/CoverageRecord/CoinsurancePercent')::STRING AS COINSURANCE_PERCENTAGE, GET_PATH(stg.xml_data, '/Session/Data/CoverageData/CoverageRecord/CoverageStartDate')::STRING AS EFFECTIVE_DATE, GET_PATH(stg.xml_data, '/Session/Data/CoverageData/CoverageRecord/CoverageEndDate')::STRING AS EXPIRATION_DATE, GET_PATH(stg.xml_data, '/Session/Data/CoverageData/CoverageRecord/IsMandatory')::STRING AS IS_MANDATORY, GET_PATH(stg.xml_data, '/Session/Data/CoverageData/CoverageRecord/CoverageBasis')::STRING AS COVERAGE_BASIS, GET_PATH(stg.xml_data, '/Session/Data/CoverageData/CoverageRecord/CoverageDeductible')::STRING AS COVERAGE_DEDUCTIBLE
        FROM INSURANCE.ETL_MAPPER.XML_STAGING stg
        WHERE stg.xml_id = 'XML-20251006020005'
          AND stg.processed = FALSE
        
2025-10-06 02:27:17 - etl.executor - ERROR - ‚ùå Failed to process SILVER.COVERAGE: 002003 (42S02): SQL compilation error:
Object 'INSURANCE.ETL_MAPPER.XML_STAGING' does not exist or not authorized.
2025-10-06 02:27:18 - loaders.snowflake_loader - INFO - ‚úÖ Connected to Snowflake: INSURANCE.ETL_MAPPER with role ACCOUNTADMIN
2025-10-06 02:27:19 - utils.database_helper - INFO - Loaded 166 approved mappings
2025-10-06 02:28:51 - loaders.snowflake_loader - INFO - ‚úÖ Connected to Snowflake: INSURANCE.ETL_MAPPER with role ACCOUNTADMIN
2025-10-06 02:28:54 - utils.database_helper - INFO - Loaded 166 approved mappings
2025-10-06 02:32:44 - utils.logging_config - INFO - Logging configured at INFO level
2025-10-06 02:32:47 - loaders.snowflake_loader - INFO - ‚úÖ Connected to Snowflake: INSURANCE.ETL_MAPPER with role ACCOUNTADMIN
2025-10-06 02:32:49 - etl.executor - INFO - ‚úÖ Required tables ensured
2025-10-06 02:32:50 - utils.database_helper - INFO - Loaded 166 approved mappings
2025-10-06 02:32:56 - loaders.snowflake_loader - INFO - ‚úÖ Connected to Snowflake: INSURANCE.ETL_MAPPER with role ACCOUNTADMIN
2025-10-06 02:32:56 - etl.executor - INFO - ‚úÖ Required tables ensured
2025-10-06 02:32:57 - utils.database_helper - INFO - Loaded 166 approved mappings
2025-10-06 02:32:58 - etl.executor - INFO - Processing 5 tables for xml_id: XML-20251006020005
2025-10-06 02:32:58 - etl.executor - INFO - Processing table: SILVER.QUOTE with 6 mappings
2025-10-06 02:32:58 - etl.executor - ERROR - ‚ùå Failed to process SILVER.QUOTE: No staging data found for xml_id: XML-20251006020005
2025-10-06 02:32:58 - etl.executor - ERROR - Traceback (most recent call last):
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 105, in execute_mappings
    rows_inserted = self._insert_to_silver(
        cursor, xml_id, table, table_mappings
    )
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 199, in _insert_to_silver
    staging_table, has_processed_flag = self._get_staging_data_info(cursor, xml_id)
                                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 193, in _get_staging_data_info
    raise Exception(f"No staging data found for xml_id: {xml_id}")
Exception: No staging data found for xml_id: XML-20251006020005

2025-10-06 02:32:59 - etl.executor - INFO - Processing table: SILVER.POLICY with 21 mappings
2025-10-06 02:32:59 - etl.executor - ERROR - ‚ùå Failed to process SILVER.POLICY: No staging data found for xml_id: XML-20251006020005
2025-10-06 02:32:59 - etl.executor - ERROR - Traceback (most recent call last):
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 105, in execute_mappings
    rows_inserted = self._insert_to_silver(
        cursor, xml_id, table, table_mappings
    )
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 199, in _insert_to_silver
    staging_table, has_processed_flag = self._get_staging_data_info(cursor, xml_id)
                                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 193, in _get_staging_data_info
    raise Exception(f"No staging data found for xml_id: {xml_id}")
Exception: No staging data found for xml_id: XML-20251006020005

2025-10-06 02:32:59 - etl.executor - INFO - Processing table: SILVER.PAYMENT with 14 mappings
2025-10-06 02:32:59 - etl.executor - ERROR - ‚ùå Failed to process SILVER.PAYMENT: No staging data found for xml_id: XML-20251006020005
2025-10-06 02:32:59 - etl.executor - ERROR - Traceback (most recent call last):
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 105, in execute_mappings
    rows_inserted = self._insert_to_silver(
        cursor, xml_id, table, table_mappings
    )
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 199, in _insert_to_silver
    staging_table, has_processed_flag = self._get_staging_data_info(cursor, xml_id)
                                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 193, in _get_staging_data_info
    raise Exception(f"No staging data found for xml_id: {xml_id}")
Exception: No staging data found for xml_id: XML-20251006020005

2025-10-06 02:32:59 - etl.executor - INFO - Processing table: SILVER.RISK with 11 mappings
2025-10-06 02:33:00 - etl.executor - ERROR - ‚ùå Failed to process SILVER.RISK: No staging data found for xml_id: XML-20251006020005
2025-10-06 02:33:00 - etl.executor - ERROR - Traceback (most recent call last):
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 105, in execute_mappings
    rows_inserted = self._insert_to_silver(
        cursor, xml_id, table, table_mappings
    )
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 199, in _insert_to_silver
    staging_table, has_processed_flag = self._get_staging_data_info(cursor, xml_id)
                                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 193, in _get_staging_data_info
    raise Exception(f"No staging data found for xml_id: {xml_id}")
Exception: No staging data found for xml_id: XML-20251006020005

2025-10-06 02:33:00 - etl.executor - INFO - Processing table: SILVER.COVERAGE with 13 mappings
2025-10-06 02:33:00 - etl.executor - ERROR - ‚ùå Failed to process SILVER.COVERAGE: No staging data found for xml_id: XML-20251006020005
2025-10-06 02:33:00 - etl.executor - ERROR - Traceback (most recent call last):
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 105, in execute_mappings
    rows_inserted = self._insert_to_silver(
        cursor, xml_id, table, table_mappings
    )
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 199, in _insert_to_silver
    staging_table, has_processed_flag = self._get_staging_data_info(cursor, xml_id)
                                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 193, in _get_staging_data_info
    raise Exception(f"No staging data found for xml_id: {xml_id}")
Exception: No staging data found for xml_id: XML-20251006020005

2025-10-06 02:33:01 - loaders.snowflake_loader - INFO - ‚úÖ Connected to Snowflake: INSURANCE.ETL_MAPPER with role ACCOUNTADMIN
2025-10-06 02:33:02 - etl.executor - INFO - ‚úÖ Required tables ensured
2025-10-06 02:33:03 - utils.database_helper - INFO - Loaded 166 approved mappings
2025-10-06 02:33:15 - loaders.snowflake_loader - INFO - ‚úÖ Connected to Snowflake: INSURANCE.ETL_MAPPER with role ACCOUNTADMIN
2025-10-06 02:33:18 - etl.executor - INFO - ‚úÖ Required tables ensured
2025-10-06 02:33:19 - utils.database_helper - INFO - Loaded 166 approved mappings
2025-10-06 02:33:54 - loaders.snowflake_loader - INFO - ‚úÖ Connected to Snowflake: INSURANCE.ETL_MAPPER with role ACCOUNTADMIN
2025-10-06 02:33:56 - etl.executor - INFO - ‚úÖ Required tables ensured
2025-10-06 02:33:58 - utils.database_helper - INFO - Loaded 166 approved mappings
2025-10-06 02:33:58 - etl.executor - INFO - Processing 5 tables for xml_id: XML-20251006020005
2025-10-06 02:33:58 - etl.executor - INFO - Processing table: SILVER.QUOTE with 6 mappings
2025-10-06 02:33:58 - etl.executor - ERROR - ‚ùå Failed to process SILVER.QUOTE: No staging data found for xml_id: XML-20251006020005
2025-10-06 02:33:58 - etl.executor - ERROR - Traceback (most recent call last):
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 105, in execute_mappings
    rows_inserted = self._insert_to_silver(
        cursor, xml_id, table, table_mappings
    )
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 199, in _insert_to_silver
    staging_table, has_processed_flag = self._get_staging_data_info(cursor, xml_id)
                                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 193, in _get_staging_data_info
    raise Exception(f"No staging data found for xml_id: {xml_id}")
Exception: No staging data found for xml_id: XML-20251006020005

2025-10-06 02:33:58 - etl.executor - INFO - Processing table: SILVER.POLICY with 21 mappings
2025-10-06 02:33:58 - etl.executor - ERROR - ‚ùå Failed to process SILVER.POLICY: No staging data found for xml_id: XML-20251006020005
2025-10-06 02:33:58 - etl.executor - ERROR - Traceback (most recent call last):
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 105, in execute_mappings
    rows_inserted = self._insert_to_silver(
        cursor, xml_id, table, table_mappings
    )
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 199, in _insert_to_silver
    staging_table, has_processed_flag = self._get_staging_data_info(cursor, xml_id)
                                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 193, in _get_staging_data_info
    raise Exception(f"No staging data found for xml_id: {xml_id}")
Exception: No staging data found for xml_id: XML-20251006020005

2025-10-06 02:33:59 - etl.executor - INFO - Processing table: SILVER.PAYMENT with 14 mappings
2025-10-06 02:33:59 - etl.executor - ERROR - ‚ùå Failed to process SILVER.PAYMENT: No staging data found for xml_id: XML-20251006020005
2025-10-06 02:33:59 - etl.executor - ERROR - Traceback (most recent call last):
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 105, in execute_mappings
    rows_inserted = self._insert_to_silver(
        cursor, xml_id, table, table_mappings
    )
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 199, in _insert_to_silver
    staging_table, has_processed_flag = self._get_staging_data_info(cursor, xml_id)
                                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 193, in _get_staging_data_info
    raise Exception(f"No staging data found for xml_id: {xml_id}")
Exception: No staging data found for xml_id: XML-20251006020005

2025-10-06 02:33:59 - etl.executor - INFO - Processing table: SILVER.RISK with 11 mappings
2025-10-06 02:34:00 - etl.executor - ERROR - ‚ùå Failed to process SILVER.RISK: No staging data found for xml_id: XML-20251006020005
2025-10-06 02:34:00 - etl.executor - ERROR - Traceback (most recent call last):
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 105, in execute_mappings
    rows_inserted = self._insert_to_silver(
        cursor, xml_id, table, table_mappings
    )
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 199, in _insert_to_silver
    staging_table, has_processed_flag = self._get_staging_data_info(cursor, xml_id)
                                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 193, in _get_staging_data_info
    raise Exception(f"No staging data found for xml_id: {xml_id}")
Exception: No staging data found for xml_id: XML-20251006020005

2025-10-06 02:34:00 - etl.executor - INFO - Processing table: SILVER.COVERAGE with 13 mappings
2025-10-06 02:34:00 - etl.executor - ERROR - ‚ùå Failed to process SILVER.COVERAGE: No staging data found for xml_id: XML-20251006020005
2025-10-06 02:34:00 - etl.executor - ERROR - Traceback (most recent call last):
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 105, in execute_mappings
    rows_inserted = self._insert_to_silver(
        cursor, xml_id, table, table_mappings
    )
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 199, in _insert_to_silver
    staging_table, has_processed_flag = self._get_staging_data_info(cursor, xml_id)
                                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 193, in _get_staging_data_info
    raise Exception(f"No staging data found for xml_id: {xml_id}")
Exception: No staging data found for xml_id: XML-20251006020005

2025-10-06 02:34:02 - loaders.snowflake_loader - INFO - ‚úÖ Connected to Snowflake: INSURANCE.ETL_MAPPER with role ACCOUNTADMIN
2025-10-06 02:34:02 - etl.executor - INFO - ‚úÖ Required tables ensured
2025-10-06 02:34:03 - utils.database_helper - INFO - Loaded 166 approved mappings
2025-10-06 02:34:51 - loaders.snowflake_loader - INFO - ‚úÖ Connected to Snowflake: INSURANCE.ETL_MAPPER with role ACCOUNTADMIN
2025-10-06 02:34:54 - etl.executor - INFO - ‚úÖ Required tables ensured
2025-10-06 02:34:55 - utils.database_helper - INFO - Loaded 166 approved mappings
2025-10-06 02:34:55 - etl.executor - INFO - Processing 5 tables for xml_id: XML-20251006020005
2025-10-06 02:34:55 - etl.executor - INFO - Processing table: SILVER.QUOTE with 6 mappings
2025-10-06 02:34:55 - etl.executor - ERROR - ‚ùå Failed to process SILVER.QUOTE: No staging data found for xml_id: XML-20251006020005
2025-10-06 02:34:55 - etl.executor - ERROR - Traceback (most recent call last):
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 105, in execute_mappings
    rows_inserted = self._insert_to_silver(
        cursor, xml_id, table, table_mappings
    )
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 199, in _insert_to_silver
    staging_table, has_processed_flag = self._get_staging_data_info(cursor, xml_id)
                                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 193, in _get_staging_data_info
    raise Exception(f"No staging data found for xml_id: {xml_id}")
Exception: No staging data found for xml_id: XML-20251006020005

2025-10-06 02:34:56 - etl.executor - INFO - Processing table: SILVER.POLICY with 21 mappings
2025-10-06 02:34:56 - etl.executor - ERROR - ‚ùå Failed to process SILVER.POLICY: No staging data found for xml_id: XML-20251006020005
2025-10-06 02:34:56 - etl.executor - ERROR - Traceback (most recent call last):
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 105, in execute_mappings
    rows_inserted = self._insert_to_silver(
        cursor, xml_id, table, table_mappings
    )
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 199, in _insert_to_silver
    staging_table, has_processed_flag = self._get_staging_data_info(cursor, xml_id)
                                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 193, in _get_staging_data_info
    raise Exception(f"No staging data found for xml_id: {xml_id}")
Exception: No staging data found for xml_id: XML-20251006020005

2025-10-06 02:34:56 - etl.executor - INFO - Processing table: SILVER.PAYMENT with 14 mappings
2025-10-06 02:34:56 - etl.executor - ERROR - ‚ùå Failed to process SILVER.PAYMENT: No staging data found for xml_id: XML-20251006020005
2025-10-06 02:34:56 - etl.executor - ERROR - Traceback (most recent call last):
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 105, in execute_mappings
    rows_inserted = self._insert_to_silver(
        cursor, xml_id, table, table_mappings
    )
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 199, in _insert_to_silver
    staging_table, has_processed_flag = self._get_staging_data_info(cursor, xml_id)
                                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 193, in _get_staging_data_info
    raise Exception(f"No staging data found for xml_id: {xml_id}")
Exception: No staging data found for xml_id: XML-20251006020005

2025-10-06 02:34:57 - etl.executor - INFO - Processing table: SILVER.RISK with 11 mappings
2025-10-06 02:34:57 - etl.executor - ERROR - ‚ùå Failed to process SILVER.RISK: No staging data found for xml_id: XML-20251006020005
2025-10-06 02:34:57 - etl.executor - ERROR - Traceback (most recent call last):
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 105, in execute_mappings
    rows_inserted = self._insert_to_silver(
        cursor, xml_id, table, table_mappings
    )
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 199, in _insert_to_silver
    staging_table, has_processed_flag = self._get_staging_data_info(cursor, xml_id)
                                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 193, in _get_staging_data_info
    raise Exception(f"No staging data found for xml_id: {xml_id}")
Exception: No staging data found for xml_id: XML-20251006020005

2025-10-06 02:34:58 - etl.executor - INFO - Processing table: SILVER.COVERAGE with 13 mappings
2025-10-06 02:34:58 - etl.executor - ERROR - ‚ùå Failed to process SILVER.COVERAGE: No staging data found for xml_id: XML-20251006020005
2025-10-06 02:34:58 - etl.executor - ERROR - Traceback (most recent call last):
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 105, in execute_mappings
    rows_inserted = self._insert_to_silver(
        cursor, xml_id, table, table_mappings
    )
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 199, in _insert_to_silver
    staging_table, has_processed_flag = self._get_staging_data_info(cursor, xml_id)
                                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 193, in _get_staging_data_info
    raise Exception(f"No staging data found for xml_id: {xml_id}")
Exception: No staging data found for xml_id: XML-20251006020005

2025-10-06 02:35:00 - loaders.snowflake_loader - INFO - ‚úÖ Connected to Snowflake: INSURANCE.ETL_MAPPER with role ACCOUNTADMIN
2025-10-06 02:35:00 - etl.executor - INFO - ‚úÖ Required tables ensured
2025-10-06 02:35:01 - utils.database_helper - INFO - Loaded 166 approved mappings
2025-10-06 02:37:29 - utils.logging_config - INFO - Logging configured at INFO level
2025-10-06 02:37:32 - loaders.snowflake_loader - INFO - ‚úÖ Connected to Snowflake: INSURANCE.ETL_MAPPER with role ACCOUNTADMIN
2025-10-06 02:37:35 - etl.executor - INFO - ‚úÖ Required tables ensured
2025-10-06 02:37:36 - utils.database_helper - INFO - Loaded 166 approved mappings
2025-10-06 02:37:41 - loaders.snowflake_loader - INFO - ‚úÖ Connected to Snowflake: INSURANCE.ETL_MAPPER with role ACCOUNTADMIN
2025-10-06 02:37:41 - etl.executor - INFO - ‚úÖ Required tables ensured
2025-10-06 02:37:42 - utils.database_helper - INFO - Loaded 166 approved mappings
2025-10-06 02:37:43 - etl.executor - INFO - Processing 5 tables for xml_id: XML-20251006020005
2025-10-06 02:37:43 - etl.executor - INFO - Processing table: SILVER.QUOTE with 6 mappings
2025-10-06 02:37:43 - etl.executor - ERROR - ‚ùå Failed to process SILVER.QUOTE: No staging data found for xml_id: XML-20251006020005
2025-10-06 02:37:43 - etl.executor - ERROR - Traceback (most recent call last):
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 105, in execute_mappings
    rows_inserted = self._insert_to_silver(
        cursor, xml_id, table, table_mappings
    )
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 199, in _insert_to_silver
    staging_table, has_processed_flag = self._get_staging_data_info(cursor, xml_id)
                                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 193, in _get_staging_data_info
    raise Exception(f"No staging data found for xml_id: {xml_id}")
Exception: No staging data found for xml_id: XML-20251006020005

2025-10-06 02:37:43 - etl.executor - INFO - Processing table: SILVER.POLICY with 21 mappings
2025-10-06 02:37:44 - etl.executor - ERROR - ‚ùå Failed to process SILVER.POLICY: No staging data found for xml_id: XML-20251006020005
2025-10-06 02:37:44 - etl.executor - ERROR - Traceback (most recent call last):
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 105, in execute_mappings
    rows_inserted = self._insert_to_silver(
        cursor, xml_id, table, table_mappings
    )
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 199, in _insert_to_silver
    staging_table, has_processed_flag = self._get_staging_data_info(cursor, xml_id)
                                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 193, in _get_staging_data_info
    raise Exception(f"No staging data found for xml_id: {xml_id}")
Exception: No staging data found for xml_id: XML-20251006020005

2025-10-06 02:37:44 - etl.executor - INFO - Processing table: SILVER.PAYMENT with 14 mappings
2025-10-06 02:37:44 - etl.executor - ERROR - ‚ùå Failed to process SILVER.PAYMENT: No staging data found for xml_id: XML-20251006020005
2025-10-06 02:37:44 - etl.executor - ERROR - Traceback (most recent call last):
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 105, in execute_mappings
    rows_inserted = self._insert_to_silver(
        cursor, xml_id, table, table_mappings
    )
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 199, in _insert_to_silver
    staging_table, has_processed_flag = self._get_staging_data_info(cursor, xml_id)
                                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 193, in _get_staging_data_info
    raise Exception(f"No staging data found for xml_id: {xml_id}")
Exception: No staging data found for xml_id: XML-20251006020005

2025-10-06 02:37:45 - etl.executor - INFO - Processing table: SILVER.RISK with 11 mappings
2025-10-06 02:37:45 - etl.executor - ERROR - ‚ùå Failed to process SILVER.RISK: No staging data found for xml_id: XML-20251006020005
2025-10-06 02:37:45 - etl.executor - ERROR - Traceback (most recent call last):
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 105, in execute_mappings
    rows_inserted = self._insert_to_silver(
        cursor, xml_id, table, table_mappings
    )
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 199, in _insert_to_silver
    staging_table, has_processed_flag = self._get_staging_data_info(cursor, xml_id)
                                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 193, in _get_staging_data_info
    raise Exception(f"No staging data found for xml_id: {xml_id}")
Exception: No staging data found for xml_id: XML-20251006020005

2025-10-06 02:37:45 - etl.executor - INFO - Processing table: SILVER.COVERAGE with 13 mappings
2025-10-06 02:37:45 - etl.executor - ERROR - ‚ùå Failed to process SILVER.COVERAGE: No staging data found for xml_id: XML-20251006020005
2025-10-06 02:37:45 - etl.executor - ERROR - Traceback (most recent call last):
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 105, in execute_mappings
    rows_inserted = self._insert_to_silver(
        cursor, xml_id, table, table_mappings
    )
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 199, in _insert_to_silver
    staging_table, has_processed_flag = self._get_staging_data_info(cursor, xml_id)
                                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 193, in _get_staging_data_info
    raise Exception(f"No staging data found for xml_id: {xml_id}")
Exception: No staging data found for xml_id: XML-20251006020005

2025-10-06 02:37:47 - loaders.snowflake_loader - INFO - ‚úÖ Connected to Snowflake: INSURANCE.ETL_MAPPER with role ACCOUNTADMIN
2025-10-06 02:37:47 - etl.executor - INFO - ‚úÖ Required tables ensured
2025-10-06 02:37:49 - utils.database_helper - INFO - Loaded 166 approved mappings
2025-10-06 02:38:08 - loaders.snowflake_loader - INFO - ‚úÖ Connected to Snowflake: INSURANCE.ETL_MAPPER with role ACCOUNTADMIN
2025-10-06 02:38:10 - etl.executor - INFO - ‚úÖ Required tables ensured
2025-10-06 02:38:11 - utils.database_helper - INFO - Loaded 166 approved mappings
2025-10-06 02:38:11 - etl.executor - INFO - Processing 5 tables for xml_id: XML-20251006020005
2025-10-06 02:38:11 - etl.executor - INFO - Processing table: SILVER.QUOTE with 6 mappings
2025-10-06 02:38:11 - etl.executor - ERROR - ‚ùå Failed to process SILVER.QUOTE: No staging data found for xml_id: XML-20251006020005
2025-10-06 02:38:12 - etl.executor - ERROR - Traceback (most recent call last):
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 105, in execute_mappings
    rows_inserted = self._insert_to_silver(
        cursor, xml_id, table, table_mappings
    )
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 199, in _insert_to_silver
    staging_table, has_processed_flag = self._get_staging_data_info(cursor, xml_id)
                                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 193, in _get_staging_data_info
    raise Exception(f"No staging data found for xml_id: {xml_id}")
Exception: No staging data found for xml_id: XML-20251006020005

2025-10-06 02:38:12 - etl.executor - INFO - Processing table: SILVER.POLICY with 21 mappings
2025-10-06 02:38:12 - etl.executor - ERROR - ‚ùå Failed to process SILVER.POLICY: No staging data found for xml_id: XML-20251006020005
2025-10-06 02:38:12 - etl.executor - ERROR - Traceback (most recent call last):
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 105, in execute_mappings
    rows_inserted = self._insert_to_silver(
        cursor, xml_id, table, table_mappings
    )
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 199, in _insert_to_silver
    staging_table, has_processed_flag = self._get_staging_data_info(cursor, xml_id)
                                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 193, in _get_staging_data_info
    raise Exception(f"No staging data found for xml_id: {xml_id}")
Exception: No staging data found for xml_id: XML-20251006020005

2025-10-06 02:38:12 - etl.executor - INFO - Processing table: SILVER.PAYMENT with 14 mappings
2025-10-06 02:38:12 - etl.executor - ERROR - ‚ùå Failed to process SILVER.PAYMENT: No staging data found for xml_id: XML-20251006020005
2025-10-06 02:38:12 - etl.executor - ERROR - Traceback (most recent call last):
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 105, in execute_mappings
    rows_inserted = self._insert_to_silver(
        cursor, xml_id, table, table_mappings
    )
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 199, in _insert_to_silver
    staging_table, has_processed_flag = self._get_staging_data_info(cursor, xml_id)
                                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 193, in _get_staging_data_info
    raise Exception(f"No staging data found for xml_id: {xml_id}")
Exception: No staging data found for xml_id: XML-20251006020005

2025-10-06 02:38:13 - etl.executor - INFO - Processing table: SILVER.RISK with 11 mappings
2025-10-06 02:38:13 - etl.executor - ERROR - ‚ùå Failed to process SILVER.RISK: No staging data found for xml_id: XML-20251006020005
2025-10-06 02:38:13 - etl.executor - ERROR - Traceback (most recent call last):
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 105, in execute_mappings
    rows_inserted = self._insert_to_silver(
        cursor, xml_id, table, table_mappings
    )
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 199, in _insert_to_silver
    staging_table, has_processed_flag = self._get_staging_data_info(cursor, xml_id)
                                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 193, in _get_staging_data_info
    raise Exception(f"No staging data found for xml_id: {xml_id}")
Exception: No staging data found for xml_id: XML-20251006020005

2025-10-06 02:38:13 - etl.executor - INFO - Processing table: SILVER.COVERAGE with 13 mappings
2025-10-06 02:38:13 - etl.executor - ERROR - ‚ùå Failed to process SILVER.COVERAGE: No staging data found for xml_id: XML-20251006020005
2025-10-06 02:38:13 - etl.executor - ERROR - Traceback (most recent call last):
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 105, in execute_mappings
    rows_inserted = self._insert_to_silver(
        cursor, xml_id, table, table_mappings
    )
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 199, in _insert_to_silver
    staging_table, has_processed_flag = self._get_staging_data_info(cursor, xml_id)
                                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 193, in _get_staging_data_info
    raise Exception(f"No staging data found for xml_id: {xml_id}")
Exception: No staging data found for xml_id: XML-20251006020005

2025-10-06 02:38:15 - loaders.snowflake_loader - INFO - ‚úÖ Connected to Snowflake: INSURANCE.ETL_MAPPER with role ACCOUNTADMIN
2025-10-06 02:38:15 - etl.executor - INFO - ‚úÖ Required tables ensured
2025-10-06 02:38:17 - utils.database_helper - INFO - Loaded 166 approved mappings
2025-10-06 02:44:32 - utils.logging_config - INFO - Logging configured at INFO level
2025-10-06 02:44:32 - etl.executor - INFO - ETL Executor initialized. Log file: logs/etl_executor_20251006.log
2025-10-06 02:44:34 - loaders.snowflake_loader - INFO - ‚úÖ Connected to Snowflake: INSURANCE.ETL_MAPPER with role ACCOUNTADMIN
2025-10-06 02:44:37 - etl.executor - INFO - ‚úÖ Required tables ensured
2025-10-06 02:44:38 - utils.database_helper - INFO - Loaded 166 approved mappings
2025-10-06 02:44:47 - loaders.snowflake_loader - INFO - ‚úÖ Connected to Snowflake: INSURANCE.ETL_MAPPER with role ACCOUNTADMIN
2025-10-06 02:44:48 - etl.executor - INFO - ‚úÖ Required tables ensured
2025-10-06 02:44:50 - utils.database_helper - INFO - Loaded 166 approved mappings
2025-10-06 02:44:50 - etl.executor - INFO - Processing 5 tables for xml_id: XML-20251006020005
2025-10-06 02:44:50 - etl.executor - INFO - Processing table: SILVER.QUOTE with 6 mappings
2025-10-06 02:44:50 - etl.executor - ERROR - ‚ùå Failed to process SILVER.QUOTE: No staging data found for xml_id: XML-20251006020005
2025-10-06 02:44:50 - etl.executor - ERROR - Traceback (most recent call last):
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 124, in execute_mappings
    rows_inserted = self._insert_to_silver(
        cursor, xml_id, table, table_mappings
    )
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 218, in _insert_to_silver
    staging_table, has_processed_flag = self._get_staging_data_info(cursor, xml_id)
                                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 212, in _get_staging_data_info
    raise Exception(f"No staging data found for xml_id: {xml_id}")
Exception: No staging data found for xml_id: XML-20251006020005

2025-10-06 02:44:53 - etl.executor - INFO - Processing table: SILVER.POLICY with 21 mappings
2025-10-06 02:44:53 - etl.executor - ERROR - ‚ùå Failed to process SILVER.POLICY: No staging data found for xml_id: XML-20251006020005
2025-10-06 02:44:53 - etl.executor - ERROR - Traceback (most recent call last):
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 124, in execute_mappings
    rows_inserted = self._insert_to_silver(
        cursor, xml_id, table, table_mappings
    )
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 218, in _insert_to_silver
    staging_table, has_processed_flag = self._get_staging_data_info(cursor, xml_id)
                                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 212, in _get_staging_data_info
    raise Exception(f"No staging data found for xml_id: {xml_id}")
Exception: No staging data found for xml_id: XML-20251006020005

2025-10-06 02:44:53 - etl.executor - INFO - Processing table: SILVER.PAYMENT with 14 mappings
2025-10-06 02:44:54 - etl.executor - ERROR - ‚ùå Failed to process SILVER.PAYMENT: No staging data found for xml_id: XML-20251006020005
2025-10-06 02:44:54 - etl.executor - ERROR - Traceback (most recent call last):
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 124, in execute_mappings
    rows_inserted = self._insert_to_silver(
        cursor, xml_id, table, table_mappings
    )
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 218, in _insert_to_silver
    staging_table, has_processed_flag = self._get_staging_data_info(cursor, xml_id)
                                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 212, in _get_staging_data_info
    raise Exception(f"No staging data found for xml_id: {xml_id}")
Exception: No staging data found for xml_id: XML-20251006020005

2025-10-06 02:44:54 - etl.executor - INFO - Processing table: SILVER.RISK with 11 mappings
2025-10-06 02:44:54 - etl.executor - ERROR - ‚ùå Failed to process SILVER.RISK: No staging data found for xml_id: XML-20251006020005
2025-10-06 02:44:54 - etl.executor - ERROR - Traceback (most recent call last):
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 124, in execute_mappings
    rows_inserted = self._insert_to_silver(
        cursor, xml_id, table, table_mappings
    )
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 218, in _insert_to_silver
    staging_table, has_processed_flag = self._get_staging_data_info(cursor, xml_id)
                                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 212, in _get_staging_data_info
    raise Exception(f"No staging data found for xml_id: {xml_id}")
Exception: No staging data found for xml_id: XML-20251006020005

2025-10-06 02:44:55 - etl.executor - INFO - Processing table: SILVER.COVERAGE with 13 mappings
2025-10-06 02:44:55 - etl.executor - ERROR - ‚ùå Failed to process SILVER.COVERAGE: No staging data found for xml_id: XML-20251006020005
2025-10-06 02:44:55 - etl.executor - ERROR - Traceback (most recent call last):
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 124, in execute_mappings
    rows_inserted = self._insert_to_silver(
        cursor, xml_id, table, table_mappings
    )
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 218, in _insert_to_silver
    staging_table, has_processed_flag = self._get_staging_data_info(cursor, xml_id)
                                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 212, in _get_staging_data_info
    raise Exception(f"No staging data found for xml_id: {xml_id}")
Exception: No staging data found for xml_id: XML-20251006020005

2025-10-06 03:01:11 - utils.logging_config - INFO - Logging configured at INFO level
2025-10-06 03:01:11 - etl.executor - INFO - ETL Executor initialized. Log file: logs/etl_executor_20251006.log
2025-10-06 03:01:12 - loaders.snowflake_loader - INFO - ‚úÖ Connected to Snowflake: INSURANCE.ETL_MAPPER with role ACCOUNTADMIN
2025-10-06 03:01:12 - etl.executor - INFO - ‚úÖ Required tables ensured
2025-10-06 03:01:14 - utils.database_helper - INFO - Loaded 166 approved mappings
2025-10-06 03:01:19 - loaders.snowflake_loader - INFO - ‚úÖ Connected to Snowflake: INSURANCE.ETL_MAPPER with role ACCOUNTADMIN
2025-10-06 03:01:20 - etl.executor - INFO - ‚úÖ Required tables ensured
2025-10-06 03:01:21 - utils.database_helper - INFO - Loaded 166 approved mappings
2025-10-06 03:01:21 - etl.executor - INFO - Processing 5 tables for xml_id: XML-20251006020005
2025-10-06 03:01:21 - etl.executor - INFO - Processing table: SILVER.QUOTE with 6 mappings
2025-10-06 03:01:21 - etl.executor - ERROR - ‚ùå Failed to process SILVER.QUOTE: No staging data found for xml_id: XML-20251006020005
2025-10-06 03:01:21 - etl.executor - ERROR - Traceback (most recent call last):
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 124, in execute_mappings
    rows_inserted = self._insert_to_silver(
        cursor, xml_id, table, table_mappings
    )
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 218, in _insert_to_silver
    staging_table, has_processed_flag = self._get_staging_data_info(cursor, xml_id)
                                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 212, in _get_staging_data_info
    raise Exception(f"No staging data found for xml_id: {xml_id}")
Exception: No staging data found for xml_id: XML-20251006020005

2025-10-06 03:01:23 - etl.executor - INFO - Processing table: SILVER.POLICY with 21 mappings
2025-10-06 03:01:23 - etl.executor - ERROR - ‚ùå Failed to process SILVER.POLICY: No staging data found for xml_id: XML-20251006020005
2025-10-06 03:01:23 - etl.executor - ERROR - Traceback (most recent call last):
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 124, in execute_mappings
    rows_inserted = self._insert_to_silver(
        cursor, xml_id, table, table_mappings
    )
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 218, in _insert_to_silver
    staging_table, has_processed_flag = self._get_staging_data_info(cursor, xml_id)
                                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 212, in _get_staging_data_info
    raise Exception(f"No staging data found for xml_id: {xml_id}")
Exception: No staging data found for xml_id: XML-20251006020005

2025-10-06 03:01:23 - etl.executor - INFO - Processing table: SILVER.PAYMENT with 14 mappings
2025-10-06 03:01:23 - etl.executor - ERROR - ‚ùå Failed to process SILVER.PAYMENT: No staging data found for xml_id: XML-20251006020005
2025-10-06 03:01:23 - etl.executor - ERROR - Traceback (most recent call last):
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 124, in execute_mappings
    rows_inserted = self._insert_to_silver(
        cursor, xml_id, table, table_mappings
    )
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 218, in _insert_to_silver
    staging_table, has_processed_flag = self._get_staging_data_info(cursor, xml_id)
                                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 212, in _get_staging_data_info
    raise Exception(f"No staging data found for xml_id: {xml_id}")
Exception: No staging data found for xml_id: XML-20251006020005

2025-10-06 03:01:24 - etl.executor - INFO - Processing table: SILVER.RISK with 11 mappings
2025-10-06 03:01:24 - etl.executor - ERROR - ‚ùå Failed to process SILVER.RISK: No staging data found for xml_id: XML-20251006020005
2025-10-06 03:01:24 - etl.executor - ERROR - Traceback (most recent call last):
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 124, in execute_mappings
    rows_inserted = self._insert_to_silver(
        cursor, xml_id, table, table_mappings
    )
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 218, in _insert_to_silver
    staging_table, has_processed_flag = self._get_staging_data_info(cursor, xml_id)
                                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 212, in _get_staging_data_info
    raise Exception(f"No staging data found for xml_id: {xml_id}")
Exception: No staging data found for xml_id: XML-20251006020005

2025-10-06 03:01:24 - etl.executor - INFO - Processing table: SILVER.COVERAGE with 13 mappings
2025-10-06 03:01:24 - etl.executor - ERROR - ‚ùå Failed to process SILVER.COVERAGE: No staging data found for xml_id: XML-20251006020005
2025-10-06 03:01:24 - etl.executor - ERROR - Traceback (most recent call last):
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 124, in execute_mappings
    rows_inserted = self._insert_to_silver(
        cursor, xml_id, table, table_mappings
    )
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 218, in _insert_to_silver
    staging_table, has_processed_flag = self._get_staging_data_info(cursor, xml_id)
                                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 212, in _get_staging_data_info
    raise Exception(f"No staging data found for xml_id: {xml_id}")
Exception: No staging data found for xml_id: XML-20251006020005

2025-10-06 03:02:55 - utils.logging_config - INFO - Logging configured at INFO level
2025-10-06 03:02:55 - etl.executor - INFO - ETL Executor initialized. Log file: logs/etl_executor_20251006.log
2025-10-06 03:02:58 - loaders.snowflake_loader - INFO - ‚úÖ Connected to Snowflake: INSURANCE.ETL_MAPPER with role ACCOUNTADMIN
2025-10-06 03:03:00 - etl.executor - INFO - ‚úÖ Required tables ensured
2025-10-06 03:03:02 - utils.database_helper - INFO - Loaded 166 approved mappings
2025-10-06 03:03:06 - loaders.snowflake_loader - INFO - ‚úÖ Connected to Snowflake: INSURANCE.ETL_MAPPER with role ACCOUNTADMIN
2025-10-06 03:03:07 - etl.executor - INFO - ‚úÖ Required tables ensured
2025-10-06 03:03:07 - utils.decorators - INFO - Starting run...
2025-10-06 03:03:07 - main - INFO - üîç Auto-detecting product type...
2025-10-06 03:03:07 - utils.product_detector - INFO - ‚úÖ Detected product: CP001 with 36.8% confidence
2025-10-06 03:03:07 - main - INFO - ‚úÖ Detected: CP001 with 36.8% confidence
2025-10-06 03:03:07 - main - INFO - üìä Extracting XML metadata...
2025-10-06 03:03:07 - main - INFO - ‚úÖ Extracted 331 XML nodes
2025-10-06 03:03:07 - main - INFO - ‚òÅÔ∏è Loading to Snowflake stage layer...
2025-10-06 03:03:07 - loaders.snowflake_loader - INFO - ‚úÖ Loaded XML data to ETL_MAPPER.STAGE_XML_CP001
2025-10-06 03:03:07 - main - INFO - ‚úÖ Loaded to ETL_MAPPER.STAGE_XML_CP001
2025-10-06 03:03:07 - main - INFO - üóÑÔ∏è Fetching Silver layer schema from Snowflake...
2025-10-06 03:03:07 - utils.schema_manager - INFO - Fetching schema from INSURANCE.SILVER
2025-10-06 03:03:08 - utils.schema_manager - INFO - ‚úÖ Fetched 137 columns from 7 tables
2025-10-06 03:03:08 - main - INFO - ‚úÖ Fetched 137 columns from 7 tables
2025-10-06 03:03:08 - main - INFO - üìö Finding and loading reference data with AI...
2025-10-06 03:03:08 - utils.document_loader - INFO - üîç Found 9 potential reference files
2025-10-06 03:03:11 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 03:03:11 - utils.document_loader - INFO - üìÑ historical_mappings_personal_auto.xlsx: historical_mapping (relevance: 85%)
2025-10-06 03:03:14 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 03:03:14 - utils.document_loader - INFO - üìÑ historical_mappings_commercial.xlsx: historical_mapping (relevance: 85%)
2025-10-06 03:03:15 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 03:03:15 - utils.document_loader - INFO - üìÑ old_mappings.csv: historical_mapping (relevance: 85%)
2025-10-06 03:03:18 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 03:03:18 - utils.document_loader - INFO - üìÑ historical_mappings_homeowners.xlsx: historical_mapping (relevance: 85%)
2025-10-06 03:03:20 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 03:03:20 - utils.document_loader - INFO - üìÑ old_mappings_homeowners.csv: historical_mapping (relevance: 85%)
2025-10-06 03:03:22 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 03:03:22 - utils.document_loader - INFO - üìÑ old_mappings_personal_auto.csv: historical_mapping (relevance: 85%)
2025-10-06 03:03:24 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 03:03:24 - utils.document_loader - INFO - üìÑ old_mappings_commercial.csv: historical_mapping (relevance: 85%)
2025-10-06 03:03:26 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 03:03:26 - utils.document_loader - INFO - üìÑ data_dictionary.csv: data_dictionary (relevance: 90%)
2025-10-06 03:03:29 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 03:03:29 - utils.document_loader - INFO - üìÑ data_dictionary_complete.xlsx: data_dictionary (relevance: 90%)
2025-10-06 03:03:29 - utils.document_loader - INFO - Loading file: reference_data/data_dictionary.csv (type: .csv)
2025-10-06 03:03:31 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 03:03:31 - utils.document_loader - ERROR - Error loading reference_data/data_dictionary.csv: name 'true' is not defined
2025-10-06 03:03:31 - utils.document_loader - INFO - Loading file: reference_data/data_dictionary_complete.xlsx (type: .xlsx)
2025-10-06 03:03:31 - utils.document_loader - INFO - Found 3 sheets: ['DataDictionary', 'TableSummary', 'Metadata']
2025-10-06 03:03:34 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 03:03:34 - utils.document_loader - INFO - AI understands this as: data_dictionary
2025-10-06 03:03:34 - utils.document_loader - INFO - Loading file: reference_data/historical_mappings_personal_auto.xlsx (type: .xlsx)
2025-10-06 03:03:34 - utils.document_loader - INFO - Found 2 sheets: ['Mappings', 'Metadata']
2025-10-06 03:03:37 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 03:03:37 - utils.document_loader - INFO - AI understands this as: historical_mappings
2025-10-06 03:03:37 - utils.document_loader - INFO - Loading file: reference_data/historical_mappings_commercial.xlsx (type: .xlsx)
2025-10-06 03:03:37 - utils.document_loader - INFO - Found 1 sheets: ['Mappings']
2025-10-06 03:03:41 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 03:03:41 - utils.document_loader - INFO - AI understands this as: historical_mappings
2025-10-06 03:03:41 - utils.document_loader - INFO - Loading file: reference_data/old_mappings.csv (type: .csv)
2025-10-06 03:03:43 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 03:03:43 - utils.document_loader - ERROR - Error loading reference_data/old_mappings.csv: name 'true' is not defined
2025-10-06 03:03:43 - utils.document_loader - INFO - Loading file: reference_data/historical_mappings_homeowners.xlsx (type: .xlsx)
2025-10-06 03:03:43 - utils.document_loader - INFO - Found 1 sheets: ['Mappings']
2025-10-06 03:03:47 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 03:03:47 - utils.document_loader - INFO - AI understands this as: historical_mappings
2025-10-06 03:03:47 - utils.document_loader - INFO - 
============================================================
2025-10-06 03:03:47 - utils.document_loader - INFO - ‚úÖ LOADED REFERENCE DATA SUMMARY:
2025-10-06 03:03:47 - utils.document_loader - INFO - ============================================================
2025-10-06 03:03:47 - utils.document_loader - INFO -   üìö Historical mappings: 3 files
2025-10-06 03:03:47 - utils.document_loader - INFO -      - historical_mappings_personal_auto.xlsx (51 rows)
2025-10-06 03:03:47 - utils.document_loader - INFO -      - historical_mappings_commercial.xlsx (9 rows)
2025-10-06 03:03:47 - utils.document_loader - INFO -      - historical_mappings_homeowners.xlsx (14 rows)
2025-10-06 03:03:47 - utils.document_loader - INFO -   üìñ Data dictionaries: 1 files
2025-10-06 03:03:47 - utils.document_loader - INFO -      - data_dictionary_complete.xlsx (104 rows)
2025-10-06 03:03:47 - utils.document_loader - INFO -   üóÑÔ∏è Schema definitions: 0 files
2025-10-06 03:03:47 - utils.document_loader - INFO -   üìä Reference data: 0 files
2025-10-06 03:03:47 - utils.document_loader - INFO - ============================================================

2025-10-06 03:03:47 - main - INFO - ü§ñ Predicting mappings with AI (flexible mode)...
2025-10-06 03:03:59 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 03:04:19 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 03:04:30 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 03:04:49 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 03:05:11 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 03:05:22 - loaders.snowflake_loader - INFO - ‚úÖ Connected to Snowflake: INSURANCE.ETL_MAPPER with role ACCOUNTADMIN
2025-10-06 03:05:25 - etl.executor - INFO - ‚úÖ Required tables ensured
2025-10-06 03:05:58 - utils.database_helper - INFO - Loaded 166 approved mappings
2025-10-06 03:05:58 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 03:05:58 - main - INFO - üíæ Saving results...
2025-10-06 03:05:58 - main - INFO - ‚úÖ Saved 66 mappings to output/mappings_CP001_20251006_030558.csv
2025-10-06 03:05:58 - main - INFO - ‚úÖ Pipeline completed successfully!
2025-10-06 03:05:58 - utils.decorators - INFO - run completed in 171.65s
2025-10-06 03:06:12 - loaders.snowflake_loader - INFO - ‚úÖ Connected to Snowflake: INSURANCE.ETL_MAPPER with role ACCOUNTADMIN
2025-10-06 03:06:13 - etl.executor - INFO - ‚úÖ Required tables ensured
2025-10-06 03:06:13 - utils.decorators - INFO - Starting run...
2025-10-06 03:06:13 - main - INFO - üîç Auto-detecting product type...
2025-10-06 03:06:13 - utils.product_detector - INFO - ‚úÖ Detected product: CP001 with 36.8% confidence
2025-10-06 03:06:13 - main - INFO - ‚úÖ Detected: CP001 with 36.8% confidence
2025-10-06 03:06:13 - main - INFO - üìä Extracting XML metadata...
2025-10-06 03:06:13 - main - INFO - ‚úÖ Extracted 331 XML nodes
2025-10-06 03:06:13 - main - INFO - ‚òÅÔ∏è Loading to Snowflake stage layer...
2025-10-06 03:06:15 - loaders.snowflake_loader - INFO - ‚úÖ Loaded XML data to ETL_MAPPER.STAGE_XML_CP001
2025-10-06 03:06:15 - main - INFO - ‚úÖ Loaded to ETL_MAPPER.STAGE_XML_CP001
2025-10-06 03:06:15 - main - INFO - üóÑÔ∏è Fetching Silver layer schema from Snowflake...
2025-10-06 03:06:15 - utils.schema_manager - INFO - Fetching schema from INSURANCE.SILVER
2025-10-06 03:06:16 - utils.schema_manager - INFO - ‚úÖ Fetched 137 columns from 7 tables
2025-10-06 03:06:16 - main - INFO - ‚úÖ Fetched 137 columns from 7 tables
2025-10-06 03:06:16 - main - INFO - üìö Finding and loading reference data with AI...
2025-10-06 03:06:16 - utils.document_loader - INFO - üîç Found 9 potential reference files
2025-10-06 03:06:18 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 03:06:18 - utils.document_loader - INFO - üìÑ historical_mappings_personal_auto.xlsx: historical_mapping (relevance: 85%)
2025-10-06 03:06:19 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 03:06:19 - utils.document_loader - INFO - üìÑ historical_mappings_commercial.xlsx: historical_mapping (relevance: 85%)
2025-10-06 03:06:22 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 03:06:22 - utils.document_loader - INFO - üìÑ old_mappings.csv: historical_mapping (relevance: 85%)
2025-10-06 03:06:23 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 03:06:23 - utils.document_loader - INFO - üìÑ historical_mappings_homeowners.xlsx: historical_mapping (relevance: 85%)
2025-10-06 03:06:25 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 03:06:25 - utils.document_loader - INFO - üìÑ old_mappings_homeowners.csv: historical_mapping (relevance: 85%)
2025-10-06 03:06:26 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 03:06:26 - utils.document_loader - INFO - üìÑ old_mappings_personal_auto.csv: historical_mapping (relevance: 85%)
2025-10-06 03:06:27 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 03:06:27 - utils.document_loader - INFO - üìÑ old_mappings_commercial.csv: historical_mapping (relevance: 80%)
2025-10-06 03:06:30 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 03:06:30 - utils.document_loader - INFO - üìÑ data_dictionary.csv: data_dictionary (relevance: 90%)
2025-10-06 03:06:30 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 03:06:30 - utils.document_loader - INFO - üìÑ data_dictionary_complete.xlsx: data_dictionary (relevance: 85%)
2025-10-06 03:06:30 - utils.document_loader - INFO - Loading file: reference_data/data_dictionary.csv (type: .csv)
2025-10-06 03:06:32 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 03:06:32 - utils.document_loader - ERROR - Error loading reference_data/data_dictionary.csv: name 'true' is not defined
2025-10-06 03:06:32 - utils.document_loader - INFO - Loading file: reference_data/historical_mappings_personal_auto.xlsx (type: .xlsx)
2025-10-06 03:06:32 - utils.document_loader - INFO - Found 2 sheets: ['Mappings', 'Metadata']
2025-10-06 03:06:35 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 03:06:35 - utils.document_loader - INFO - AI understands this as: historical_mappings
2025-10-06 03:06:35 - utils.document_loader - INFO - Loading file: reference_data/historical_mappings_commercial.xlsx (type: .xlsx)
2025-10-06 03:06:35 - utils.document_loader - INFO - Found 1 sheets: ['Mappings']
2025-10-06 03:06:39 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 03:06:39 - utils.document_loader - INFO - AI understands this as: historical_mappings
2025-10-06 03:06:39 - utils.document_loader - INFO - Loading file: reference_data/old_mappings.csv (type: .csv)
2025-10-06 03:06:42 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 03:06:42 - utils.document_loader - ERROR - Error loading reference_data/old_mappings.csv: name 'true' is not defined
2025-10-06 03:06:42 - utils.document_loader - INFO - Loading file: reference_data/historical_mappings_homeowners.xlsx (type: .xlsx)
2025-10-06 03:06:42 - utils.document_loader - INFO - Found 1 sheets: ['Mappings']
2025-10-06 03:06:44 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 03:06:44 - utils.document_loader - INFO - AI understands this as: historical_mappings
2025-10-06 03:06:44 - utils.document_loader - INFO - Loading file: reference_data/data_dictionary_complete.xlsx (type: .xlsx)
2025-10-06 03:06:44 - utils.document_loader - INFO - Found 3 sheets: ['DataDictionary', 'TableSummary', 'Metadata']
2025-10-06 03:06:47 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 03:06:47 - utils.document_loader - INFO - AI understands this as: data_dictionary
2025-10-06 03:06:47 - utils.document_loader - INFO - 
============================================================
2025-10-06 03:06:47 - utils.document_loader - INFO - ‚úÖ LOADED REFERENCE DATA SUMMARY:
2025-10-06 03:06:47 - utils.document_loader - INFO - ============================================================
2025-10-06 03:06:47 - utils.document_loader - INFO -   üìö Historical mappings: 3 files
2025-10-06 03:06:47 - utils.document_loader - INFO -      - historical_mappings_personal_auto.xlsx (51 rows)
2025-10-06 03:06:47 - utils.document_loader - INFO -      - historical_mappings_commercial.xlsx (9 rows)
2025-10-06 03:06:47 - utils.document_loader - INFO -      - historical_mappings_homeowners.xlsx (14 rows)
2025-10-06 03:06:47 - utils.document_loader - INFO -   üìñ Data dictionaries: 1 files
2025-10-06 03:06:47 - utils.document_loader - INFO -      - data_dictionary_complete.xlsx (104 rows)
2025-10-06 03:06:47 - utils.document_loader - INFO -   üóÑÔ∏è Schema definitions: 0 files
2025-10-06 03:06:47 - utils.document_loader - INFO -   üìä Reference data: 0 files
2025-10-06 03:06:47 - utils.document_loader - INFO - ============================================================

2025-10-06 03:06:47 - main - INFO - ü§ñ Predicting mappings with AI (flexible mode)...
2025-10-06 03:07:04 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 03:07:24 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 03:07:33 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 03:07:55 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 03:08:21 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 03:08:49 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 03:08:49 - main - INFO - üíæ Saving results...
2025-10-06 03:08:49 - main - INFO - ‚úÖ Saved 65 mappings to output/mappings_CP001_20251006_030849.csv
2025-10-06 03:08:49 - main - INFO - ‚úÖ Pipeline completed successfully!
2025-10-06 03:08:49 - utils.decorators - INFO - run completed in 156.30s
2025-10-06 03:08:52 - utils.database_helper - ERROR - Error loading XML: 002014 (22000): SQL compilation error:
Invalid expression [PARSE_JSON('{"TransactionInfo": {"TransactionID": "TXN-POL-20251005-003", "TransactionType": "NewBusiness", "TransactionDate": "2025-10-05T16:45:00", "TransactionStatus": "Success", "SourceSystem": "DuckCreek", "SourceVersion": "7.5.2", "ProcessedBy": "DCPOLICY_ENGINE"}, "Data": {"PolicyData": {"ID": "POL-CP-2025-00456", "Number": "CP-2025-00456", "Version": "1", "LineOfBusiness": "Commercial Property", "StatusCode": "Active", "StatusDescription": "In Force", "ProductDetails": {"ProdCode": "CP001", "ProdDescription": "Commercial Property Insurance - Building and Contents", "ProdVersion": "2024.5", "LOB": "Commercial Lines", "Category": "Property", "SubCategory": "Building"}, "PolicyDates": {"InceptionDate": "2025-11-15", "TerminationDate": "2026-11-15", "BindDate": "2025-10-05", "QuoteDate": "2025-10-01"}, "TermLength": "12", "TermLengthUnit": "Months", "PremiumInfo": {"BasePremium": "8500.00", "AnnualPremium": "9250.00", "MinimumPremium": "5000.00", "DepositPremium": "2312.50", "TaxAmount": "647.50", "SurchargeAmount": "750.00", "DiscountAmount": "0.00", "FeeAmount": "100.00", "TotalPremium": "9997.50", "CoveredAmount": "2500000"}, "UnderwritingInfo": {"Carrier": "ABC Commercial Insurance", "UnderwritingCompany": "ABC Commercial Underwriters LLC", "UnderwritingState": "IL", "RiskTier": "Preferred", "UnderwriterID": "UW-COM-089", "UnderwriterName": "Jennifer Lee", "UnderwriterAuthority": "Senior", "InspectionRequired": "true", "InspectionDate": "2025-10-20"}, "SalesChannel": {"ChannelName": "Broker", "SubChannel": "Commercial Broker", "Region": "Midwest", "Territory": "IL-COOK-COMM-001"}}, "AccountData": {"AccountIdentifier": "ACC-COMM-2025-789", "AccountNumber": "COMM-789", "AccountName": "TechStart Solutions LLC", "AccountType": "Commercial", "AccountStatus": "Active", "BusinessInfo": {"LegalName": "TechStart Solutions LLC", "DBAName": "TechStart", "BusinessType": "Technology Services", "IndustryCode": "NAICS-541512", "IndustryDescription": "Computer Systems Design Services", "YearsInBusiness": "5", "NumberOfEmployees": "45", "AnnualRevenue": "8500000", "FederalTaxID": "**-***7890", "EntityType": "LLC", "StateOfIncorporation": "IL", "IncorporationDate": "2020-03-15"}, "PrimaryContact": {"ContactName": "David Chen", "Title": "CEO", "DateOfBirth": "1978-11-10", "Email": "dchen@techstart.com", "Phone": {"PhoneType": "Business", "PhoneNumber": "312-555-2000", "Extension": "101"}}, "BusinessAddress": {"AddressType": "Principal", "AddressLine1": "500 Technology Plaza", "AddressLine2": "Suite 300", "City": "Chicago", "State": "IL", "ZipCode": "60611", "County": "Cook", "Country": "USA"}, "MailingAddress": {"IsSameAsBusiness": "false", "AddressLine1": "PO Box 12345", "City": "Chicago", "State": "IL", "ZipCode": "60690"}}, "BrokerData": {"BrokerID": "BRK-COMM-050", "BrokerName": "Jennifer Wilson", "BrokerType": "Commercial Lines Broker", "BrokerageFirm": "Wilson Commercial Insurance Brokers", "BrokerageCode": "WCSB-IL-050", "BrokerEmail": "jwilson@wilsonbrokers.com", "BrokerPhone": "312-555-9000", "CommissionRate": "12.0", "CommissionAmount": "1199.70", "LicenseNumber": "IL-BRK-11223344", "LicenseState": "IL", "AppointedDate": "2018-05-01"}, "QuoteData": {"QuoteIdentifier": "Q-CP-2025-00299", "QuoteNumber": "QT-CP-00299", "QuoteDate": "2025-10-01", "QuoteExpiryDate": "2025-10-31", "ConversionDate": "2025-10-05", "QuoteStatus": "Bound"}, "RiskData": {"RiskIdentifier": "RSK-CP-001", "RiskSequence": "1", "RiskClass": "Building", "RiskSummary": "Office Building - 5 Story Mixed Use", "LocationDetails": {"LocationNumber": "001", "LocationName": "TechStart HQ Building", "AddressLine1": "500 Technology Plaza", "AddressLine2": "Suite 300", "City": "Chicago", "State": "IL", "ZipCode": "60611", "County": "Cook", "Country": "USA", "Latitude": "41.8915", "Longitude": "-87.6195", "FloodZone": "X", "WindZone": "Zone 2", "EarthquakeZone": "Low", "TerrorismRiskZone": "Tier 1"}, "BuildingDetails": {"BuildingNumber": "1", "BuildingType": "Office", "ConstructionClass": "1", "ConstructionType": "Fire Resistive", "ConstructionMaterial": "Steel and Concrete", "YearBuilt": "2015", "YearRenovated": "2022", "NumberOfStories": "5", "TotalSquareFootage": "50000", "OccupiedSquareFootage": "45000", "VacantSquareFootage": "5000", "RoofType": "Built-Up", "RoofMaterial": "Membrane", "RoofAge": "3", "RoofCondition": "Excellent", "ExteriorWalls": "Curtain Wall Glass", "HasBasement": "true", "BasementLevels": "1", "ElevatorCount": "2", "ParkingType": "Underground Garage", "ParkingSpaces": "100"}, "OccupancyInfo": {"PrimaryOccupancy": "Office - Professional", "OccupancyCode": "OCC-431", "SecondaryOccupancy": "Retail - Ground Floor", "TenantCount": "8", "OwnerOccupiedPercent": "60", "HasRestaurant": "true", "HasRetail": "true", "HasResidential": "false", "HasHazardousMaterials": "false", "AverageOccupancyHours": "0800-1800", "WeekendOccupancy": "Limited"}, "ValuationInfo": {"BuildingValue": "2000000", "ContentsValue": "500000", "BusinessPersonalProperty": "500000", "TenantImprovements": "250000", "LandValue": "800000", "TotalInsurableValue": "2500000", "ReplacementCost": "2200000", "ActualCashValue": "1800000", "AppraisalDate": "2025-09-15", "AppraisalCompany": "ABC Appraisals Inc"}, "ProtectionInfo": {"FireProtectionClass": "3", "FireHydrantDistance": "200", "FireStationDistance": "1.5", "HasSprinklerSystem": "true", "SprinklerType": "Wet Pipe", "SprinklerCoverage": "100", "HasFireAlarm": "true", "FireAlarmType": "Central Station", "HasBurglarAlarm": "true", "BurglarAlarmType": "Central Station", "HasSecurityGuard": "true", "SecurityGuardHours": "24/7", "HasCCTV": "true", "HasAccessControl": "true", "MonitoringCompany": "SecureCom Commercial"}, "MechanicalSystems": {"HVACType": "Central", "HVACAge": "3", "HeatingType": "Gas", "CoolingType": "Electric", "ElectricalCapacity": "2000", "HasBackupGenerator": "true", "GeneratorCapacity": "500", "PlumbingType": "Copper", "WaterHeaterType": "Commercial Gas", "WaterHeaterAge": "3"}, "MortgageInfo": {"IsMortgaged": "true", "MortgageHolder": "First Commercial Bank", "LoanNumber": "COMM-MTG-9876543", "OutstandingBalance": "1500000", "LoanToValue": "60", "MortgageAddress": {"AddressLine1": "1000 Banking Center", "City": "Chicago", "State": "IL", "ZipCode": "60603"}}, "LossHistory": {"HasPriorLosses": "true", "Loss": {"LossDate": "2023-12-10", "LossType": "Water Damage", "LossCause": "Pipe Burst", "LossAmount": "45000", "LossDescription": "Frozen pipe burst on 3rd floor", "ClaimNumber": "CLM-2023-98765", "ClaimStatus": "Closed", "ClaimPaid": "42000"}}, "ComplianceInfo": {"BuildingCodeCompliant": "true", "FireCodeCompliant": "true", "ADACompliant": "true", "EnvironmentalCompliant": "true", "LastInspectionDate": "2025-08-15", "InspectionAgency": "City of Chicago Building Department", "ViolationsOutstanding": "0"}}, "CoverageData": {"CoverageRecord": [{"CoverageIdentifier": "COV-CP-001", "RiskIdentifier": "RSK-CP-001", "CoverageSymbol": "BLD", "CoverageDescription": "Building Coverage", "CoverageClass": "Property", "MaxLimit": "2000000", "CoverageDeductible": "10000", "CoverageBasis": "Replacement Cost", "CoinsurancePercent": "90", "CoveragePremium": "5200.00", "CoverageStartDate": "2025-11-15", "CoverageEndDate": "2026-11-15", "PerilsCovered": "All Risk", "IsMandatory": "true"}, {"CoverageIdentifier": "COV-CP-002", "RiskIdentifier": "RSK-CP-001", "CoverageSymbol": "BPP", "CoverageDescription": "Business Personal Property", "CoverageClass": "Property", "MaxLimit": "500000", "CoverageDeductible": "5000", "CoverageBasis": "Replacement Cost", "CoinsurancePercent": "90", "CoveragePremium": "1800.00", "CoverageStartDate": "2025-11-15", "CoverageEndDate": "2026-11-15", "PerilsCovered": "All Risk", "IsMandatory": "true"}, {"CoverageIdentifier": "COV-CP-003", "RiskIdentifier": "RSK-CP-001", "CoverageSymbol": "BI", "CoverageDescription": "Business Interruption", "CoverageClass": "Income", "MaxLimit": "1000000", "CoverageDeductible": "72", "DeductibleUnit": "Hours", "IndemnityPeriod": "12", "IndemnityPeriodUnit": "Months", "CoveragePremium": "1250.00", "CoverageStartDate": "2025-11-15", "CoverageEndDate": "2026-11-15", "IsMandatory": "false"}, {"CoverageIdentifier": "COV-CP-004", "RiskIdentifier": "RSK-CP-001", "CoverageSymbol": "EQ", "CoverageDescription": "Equipment Breakdown", "CoverageClass": "Property", "MaxLimit": "250000", "CoverageDeductible": "2500", "CoveragePremium": "500.00", "CoverageStartDate": "2025-11-15", "CoverageEndDate": "2026-11-15", "CoveredEquipment": "HVAC, Elevators, Electrical", "IsMandatory": "false"}]}, "PaymentData": {"PaymentIdentifier": "PAY-CP-001", "PaymentNumber": "PAY-CP-001-001", "TransactionType": "New Business Deposit", "PaymentMode": "Wire Transfer", "StatusDescription": "Pending", "ScheduledDate": "2025-11-15", "TransactionAmount": "2312.50", "BillingPlan": "Quarterly", "TotalInstallments": "4", "InstallmentAmount": "2499.38", "PaymentAccountInfo": {"NameOnAccount": "TechStart Solutions LLC", "FinancialInstitution": "First Commercial Bank", "AccountNumber": "****9876", "RoutingNumber": "987654321", "AccountType": "Business Checking"}}, "SystemData": {"EnteredBy": "jwilson", "EntryTimestamp": "2025-10-05T16:45:00", "UpdatedBy": "underwriter.system", "UpdateTimestamp": "2025-10-05T17:30:00", "IssuedBy": "policy.system", "IssuedTimestamp": "2025-10-05T17:35:00", "WorkflowStatus": "Issued", "ApprovalRequired": "true", "ApprovalStatus": "Approved", "ApprovedBy": "UW-COM-089", "ApprovedDate": "2025-10-05T17:00:00"}}}')] in VALUES clause
2025-10-06 03:08:56 - utils.database_helper - INFO - Loaded 166 approved mappings
2025-10-06 03:13:51 - utils.logging_config - INFO - Logging configured at INFO level
2025-10-06 03:13:51 - etl.executor - INFO - ETL Executor initialized. Log file: logs/etl_executor_20251006.log
2025-10-06 03:13:53 - loaders.snowflake_loader - INFO - ‚úÖ Connected to Snowflake: INSURANCE.ETL_MAPPER with role ACCOUNTADMIN
2025-10-06 03:13:56 - etl.executor - INFO - ‚úÖ Required tables ensured
2025-10-06 03:13:57 - utils.database_helper - INFO - Loaded 166 approved mappings
2025-10-06 03:14:02 - loaders.snowflake_loader - INFO - ‚úÖ Connected to Snowflake: INSURANCE.ETL_MAPPER with role ACCOUNTADMIN
2025-10-06 03:14:03 - etl.executor - INFO - ‚úÖ Required tables ensured
2025-10-06 03:14:03 - utils.decorators - INFO - Starting run...
2025-10-06 03:14:03 - main - INFO - üîç Auto-detecting product type...
2025-10-06 03:14:03 - utils.product_detector - INFO - ‚úÖ Detected product: CP001 with 36.8% confidence
2025-10-06 03:14:03 - main - INFO - ‚úÖ Detected: CP001 with 36.8% confidence
2025-10-06 03:14:03 - main - INFO - üìä Extracting XML metadata...
2025-10-06 03:14:03 - main - INFO - ‚úÖ Extracted 331 XML nodes
2025-10-06 03:14:03 - main - INFO - ‚òÅÔ∏è Loading to Snowflake stage layer...
2025-10-06 03:14:03 - loaders.snowflake_loader - INFO - ‚úÖ Loaded XML data to ETL_MAPPER.STAGE_XML_CP001
2025-10-06 03:14:03 - main - INFO - ‚úÖ Loaded to ETL_MAPPER.STAGE_XML_CP001
2025-10-06 03:14:03 - main - INFO - üóÑÔ∏è Fetching Silver layer schema from Snowflake...
2025-10-06 03:14:03 - utils.schema_manager - INFO - Fetching schema from INSURANCE.SILVER
2025-10-06 03:14:04 - utils.schema_manager - INFO - ‚úÖ Fetched 137 columns from 7 tables
2025-10-06 03:14:04 - main - INFO - ‚úÖ Fetched 137 columns from 7 tables
2025-10-06 03:14:04 - main - INFO - üìö Finding and loading reference data with AI...
2025-10-06 03:14:04 - utils.document_loader - INFO - üîç Found 9 potential reference files
2025-10-06 03:14:07 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 03:14:07 - utils.document_loader - INFO - üìÑ historical_mappings_personal_auto.xlsx: historical_mapping (relevance: 85%)
2025-10-06 03:14:08 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 03:14:08 - utils.document_loader - INFO - üìÑ historical_mappings_commercial.xlsx: historical_mapping (relevance: 85%)
2025-10-06 03:14:10 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 03:14:10 - utils.document_loader - INFO - üìÑ old_mappings.csv: historical_mapping (relevance: 85%)
2025-10-06 03:14:11 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 03:14:11 - utils.document_loader - INFO - üìÑ historical_mappings_homeowners.xlsx: historical_mapping (relevance: 85%)
2025-10-06 03:14:12 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 03:14:12 - utils.document_loader - INFO - üìÑ old_mappings_homeowners.csv: historical_mapping (relevance: 85%)
2025-10-06 03:14:13 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 03:14:13 - utils.document_loader - INFO - üìÑ old_mappings_personal_auto.csv: historical_mapping (relevance: 85%)
2025-10-06 03:14:14 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 03:14:14 - utils.document_loader - INFO - üìÑ old_mappings_commercial.csv: historical_mapping (relevance: 85%)
2025-10-06 03:14:16 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 03:14:16 - utils.document_loader - INFO - üìÑ data_dictionary.csv: data_dictionary (relevance: 90%)
2025-10-06 03:14:17 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 03:14:17 - utils.document_loader - INFO - üìÑ data_dictionary_complete.xlsx: data_dictionary (relevance: 90%)
2025-10-06 03:14:17 - utils.document_loader - INFO - Loading file: reference_data/data_dictionary.csv (type: .csv)
2025-10-06 03:14:18 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 03:14:18 - utils.document_loader - ERROR - Error loading reference_data/data_dictionary.csv: name 'true' is not defined
2025-10-06 03:14:18 - utils.document_loader - INFO - Loading file: reference_data/data_dictionary_complete.xlsx (type: .xlsx)
2025-10-06 03:14:18 - utils.document_loader - INFO - Found 3 sheets: ['DataDictionary', 'TableSummary', 'Metadata']
2025-10-06 03:14:21 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 03:14:21 - utils.document_loader - INFO - AI understands this as: data_dictionary
2025-10-06 03:14:21 - utils.document_loader - INFO - Loading file: reference_data/historical_mappings_personal_auto.xlsx (type: .xlsx)
2025-10-06 03:14:21 - utils.document_loader - INFO - Found 2 sheets: ['Mappings', 'Metadata']
2025-10-06 03:14:24 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 03:14:24 - utils.document_loader - INFO - AI understands this as: historical_mappings
2025-10-06 03:14:24 - utils.document_loader - INFO - Loading file: reference_data/historical_mappings_commercial.xlsx (type: .xlsx)
2025-10-06 03:14:24 - utils.document_loader - INFO - Found 1 sheets: ['Mappings']
2025-10-06 03:14:26 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 03:14:26 - utils.document_loader - INFO - AI understands this as: historical_mappings
2025-10-06 03:14:26 - utils.document_loader - INFO - Loading file: reference_data/old_mappings.csv (type: .csv)
2025-10-06 03:14:29 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 03:14:29 - utils.document_loader - ERROR - Error loading reference_data/old_mappings.csv: name 'true' is not defined
2025-10-06 03:14:29 - utils.document_loader - INFO - Loading file: reference_data/historical_mappings_homeowners.xlsx (type: .xlsx)
2025-10-06 03:14:29 - utils.document_loader - INFO - Found 1 sheets: ['Mappings']
2025-10-06 03:14:30 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 03:14:30 - utils.document_loader - INFO - AI understands this as: historical_mappings
2025-10-06 03:14:30 - utils.document_loader - INFO - 
============================================================
2025-10-06 03:14:30 - utils.document_loader - INFO - ‚úÖ LOADED REFERENCE DATA SUMMARY:
2025-10-06 03:14:30 - utils.document_loader - INFO - ============================================================
2025-10-06 03:14:30 - utils.document_loader - INFO -   üìö Historical mappings: 3 files
2025-10-06 03:14:30 - utils.document_loader - INFO -      - historical_mappings_personal_auto.xlsx (51 rows)
2025-10-06 03:14:30 - utils.document_loader - INFO -      - historical_mappings_commercial.xlsx (9 rows)
2025-10-06 03:14:30 - utils.document_loader - INFO -      - historical_mappings_homeowners.xlsx (14 rows)
2025-10-06 03:14:30 - utils.document_loader - INFO -   üìñ Data dictionaries: 1 files
2025-10-06 03:14:30 - utils.document_loader - INFO -      - data_dictionary_complete.xlsx (104 rows)
2025-10-06 03:14:30 - utils.document_loader - INFO -   üóÑÔ∏è Schema definitions: 0 files
2025-10-06 03:14:30 - utils.document_loader - INFO -   üìä Reference data: 0 files
2025-10-06 03:14:30 - utils.document_loader - INFO - ============================================================

2025-10-06 03:14:30 - main - INFO - ü§ñ Predicting mappings with AI (flexible mode)...
2025-10-06 03:14:54 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 03:15:15 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 03:15:22 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 03:15:42 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 03:16:05 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 03:16:41 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 03:16:41 - main - INFO - üíæ Saving results...
2025-10-06 03:16:41 - main - INFO - ‚úÖ Saved 78 mappings to output/mappings_CP001_20251006_031641.csv
2025-10-06 03:16:41 - main - INFO - ‚úÖ Pipeline completed successfully!
2025-10-06 03:16:41 - utils.decorators - INFO - run completed in 158.30s
2025-10-06 03:16:46 - utils.database_helper - INFO - Loaded 166 approved mappings
2025-10-06 03:19:49 - utils.logging_config - INFO - Logging configured at INFO level
2025-10-06 03:19:49 - etl.executor - INFO - ETL Executor initialized. Log file: logs/etl_executor_20251006.log
2025-10-06 03:19:52 - loaders.snowflake_loader - INFO - ‚úÖ Connected to Snowflake: INSURANCE.ETL_MAPPER with role ACCOUNTADMIN
2025-10-06 03:19:55 - etl.executor - INFO - ‚úÖ Required tables ensured
2025-10-06 03:19:55 - utils.database_helper - INFO - Loaded 166 approved mappings
2025-10-06 03:20:07 - loaders.snowflake_loader - INFO - ‚úÖ Connected to Snowflake: INSURANCE.ETL_MAPPER with role ACCOUNTADMIN
2025-10-06 03:20:07 - etl.executor - INFO - ‚úÖ Required tables ensured
2025-10-06 03:20:07 - utils.decorators - INFO - Starting run...
2025-10-06 03:20:07 - main - INFO - üîç Auto-detecting product type...
2025-10-06 03:20:07 - utils.product_detector - INFO - ‚úÖ Detected product: CP001 with 36.8% confidence
2025-10-06 03:20:07 - main - INFO - ‚úÖ Detected: CP001 with 36.8% confidence
2025-10-06 03:20:07 - main - INFO - üìä Extracting XML metadata...
2025-10-06 03:20:07 - main - INFO - ‚úÖ Extracted 331 XML nodes
2025-10-06 03:20:07 - main - INFO - ‚òÅÔ∏è Loading to Snowflake stage layer...
2025-10-06 03:20:09 - loaders.snowflake_loader - INFO - ‚úÖ Loaded XML data to ETL_MAPPER.STAGE_XML_CP001
2025-10-06 03:20:09 - main - INFO - ‚úÖ Loaded to ETL_MAPPER.STAGE_XML_CP001
2025-10-06 03:20:09 - main - INFO - üóÑÔ∏è Fetching Silver layer schema from Snowflake...
2025-10-06 03:20:09 - utils.schema_manager - INFO - Fetching schema from INSURANCE.SILVER
2025-10-06 03:20:10 - utils.schema_manager - INFO - ‚úÖ Fetched 137 columns from 7 tables
2025-10-06 03:20:10 - main - INFO - ‚úÖ Fetched 137 columns from 7 tables
2025-10-06 03:20:10 - main - INFO - üìö Finding and loading reference data with AI...
2025-10-06 03:20:10 - utils.document_loader - INFO - üîç Found 9 potential reference files
2025-10-06 03:20:12 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 03:20:12 - utils.document_loader - INFO - üìÑ historical_mappings_personal_auto.xlsx: historical_mapping (relevance: 85%)
2025-10-06 03:20:15 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 03:20:15 - utils.document_loader - INFO - üìÑ historical_mappings_commercial.xlsx: historical_mapping (relevance: 85%)
2025-10-06 03:20:16 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 03:20:16 - utils.document_loader - INFO - üìÑ old_mappings.csv: historical_mapping (relevance: 85%)
2025-10-06 03:20:19 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 03:20:19 - utils.document_loader - INFO - üìÑ historical_mappings_homeowners.xlsx: historical_mapping (relevance: 85%)
2025-10-06 03:20:21 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 03:20:21 - utils.document_loader - INFO - üìÑ old_mappings_homeowners.csv: historical_mapping (relevance: 85%)
2025-10-06 03:20:23 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 03:20:23 - utils.document_loader - INFO - üìÑ old_mappings_personal_auto.csv: historical_mapping (relevance: 85%)
2025-10-06 03:20:29 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 03:20:29 - utils.document_loader - INFO - üìÑ old_mappings_commercial.csv: historical_mapping (relevance: 85%)
2025-10-06 03:20:30 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 03:20:30 - utils.document_loader - INFO - üìÑ data_dictionary.csv: data_dictionary (relevance: 90%)
2025-10-06 03:20:35 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 03:20:35 - utils.document_loader - INFO - üìÑ data_dictionary_complete.xlsx: data_dictionary (relevance: 85%)
2025-10-06 03:20:35 - utils.document_loader - INFO - Loading file: reference_data/data_dictionary.csv (type: .csv)
2025-10-06 03:20:37 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 03:20:37 - utils.document_loader - ERROR - Error loading reference_data/data_dictionary.csv: name 'true' is not defined
2025-10-06 03:20:37 - utils.document_loader - INFO - Loading file: reference_data/historical_mappings_personal_auto.xlsx (type: .xlsx)
2025-10-06 03:20:37 - utils.document_loader - INFO - Found 2 sheets: ['Mappings', 'Metadata']
2025-10-06 03:20:40 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 03:20:40 - utils.document_loader - INFO - AI understands this as: historical_mappings
2025-10-06 03:20:40 - utils.document_loader - INFO - Loading file: reference_data/historical_mappings_commercial.xlsx (type: .xlsx)
2025-10-06 03:20:40 - utils.document_loader - INFO - Found 1 sheets: ['Mappings']
2025-10-06 03:20:42 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 03:20:42 - utils.document_loader - INFO - AI understands this as: historical_mappings
2025-10-06 03:20:42 - utils.document_loader - INFO - Loading file: reference_data/old_mappings.csv (type: .csv)
2025-10-06 03:20:44 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 03:20:44 - utils.document_loader - ERROR - Error loading reference_data/old_mappings.csv: name 'true' is not defined
2025-10-06 03:20:44 - utils.document_loader - INFO - Loading file: reference_data/historical_mappings_homeowners.xlsx (type: .xlsx)
2025-10-06 03:20:44 - utils.document_loader - INFO - Found 1 sheets: ['Mappings']
2025-10-06 03:20:49 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 03:20:49 - utils.document_loader - INFO - AI understands this as: historical_mappings
2025-10-06 03:20:49 - utils.document_loader - INFO - Loading file: reference_data/data_dictionary_complete.xlsx (type: .xlsx)
2025-10-06 03:20:49 - utils.document_loader - INFO - Found 3 sheets: ['DataDictionary', 'TableSummary', 'Metadata']
2025-10-06 03:20:52 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 03:20:52 - utils.document_loader - INFO - AI understands this as: data_dictionary
2025-10-06 03:20:52 - utils.document_loader - INFO - 
============================================================
2025-10-06 03:20:52 - utils.document_loader - INFO - ‚úÖ LOADED REFERENCE DATA SUMMARY:
2025-10-06 03:20:52 - utils.document_loader - INFO - ============================================================
2025-10-06 03:20:52 - utils.document_loader - INFO -   üìö Historical mappings: 3 files
2025-10-06 03:20:52 - utils.document_loader - INFO -      - historical_mappings_personal_auto.xlsx (51 rows)
2025-10-06 03:20:52 - utils.document_loader - INFO -      - historical_mappings_commercial.xlsx (9 rows)
2025-10-06 03:20:52 - utils.document_loader - INFO -      - historical_mappings_homeowners.xlsx (14 rows)
2025-10-06 03:20:52 - utils.document_loader - INFO -   üìñ Data dictionaries: 1 files
2025-10-06 03:20:52 - utils.document_loader - INFO -      - data_dictionary_complete.xlsx (104 rows)
2025-10-06 03:20:52 - utils.document_loader - INFO -   üóÑÔ∏è Schema definitions: 0 files
2025-10-06 03:20:52 - utils.document_loader - INFO -   üìä Reference data: 0 files
2025-10-06 03:20:52 - utils.document_loader - INFO - ============================================================

2025-10-06 03:20:52 - main - INFO - ü§ñ Predicting mappings with AI (flexible mode)...
2025-10-06 03:21:11 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 03:21:31 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 03:21:41 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 03:21:59 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 03:22:24 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 03:22:57 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 03:22:57 - main - INFO - üíæ Saving results...
2025-10-06 03:22:57 - main - INFO - ‚úÖ Saved 73 mappings to output/mappings_CP001_20251006_032257.csv
2025-10-06 03:22:57 - main - INFO - ‚úÖ Pipeline completed successfully!
2025-10-06 03:22:57 - utils.decorators - INFO - run completed in 169.29s
2025-10-06 03:23:00 - utils.database_helper - INFO - ‚úÖ Loaded 1 row(s) of XML into staging for XML-20251006032259
2025-10-06 03:23:00 - utils.database_helper - ERROR - Error loading XML: name 'os' is not defined
2025-10-06 03:23:00 - utils.database_helper - ERROR - Traceback (most recent call last):
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/utils/database_helper.py", line 403, in save_xml_to_stage_with_copy
    """, (xml_id, os.path.basename(xml_file_path), xml_file_path, product_code, uploaded_by))
                  ^^
NameError: name 'os' is not defined. Did you forget to import 'os'?

2025-10-06 03:23:04 - utils.database_helper - INFO - Loaded 166 approved mappings
2025-10-06 03:27:49 - utils.logging_config - INFO - Logging configured at INFO level
2025-10-06 03:27:49 - etl.executor - INFO - ETL Executor initialized. Log file: logs/etl_executor_20251006.log
2025-10-06 03:27:52 - loaders.snowflake_loader - INFO - ‚úÖ Connected to Snowflake: INSURANCE.ETL_MAPPER with role ACCOUNTADMIN
2025-10-06 03:27:54 - etl.executor - INFO - ‚úÖ Required tables ensured
2025-10-06 03:27:55 - utils.database_helper - INFO - Loaded 166 approved mappings
2025-10-06 03:27:59 - loaders.snowflake_loader - INFO - ‚úÖ Connected to Snowflake: INSURANCE.ETL_MAPPER with role ACCOUNTADMIN
2025-10-06 03:28:00 - etl.executor - INFO - ‚úÖ Required tables ensured
2025-10-06 03:28:00 - utils.decorators - INFO - Starting run...
2025-10-06 03:28:00 - main - INFO - üîç Auto-detecting product type...
2025-10-06 03:28:00 - utils.product_detector - INFO - ‚úÖ Detected product: CP001 with 36.8% confidence
2025-10-06 03:28:00 - main - INFO - ‚úÖ Detected: CP001 with 36.8% confidence
2025-10-06 03:28:00 - main - INFO - üìä Extracting XML metadata...
2025-10-06 03:28:00 - main - INFO - ‚úÖ Extracted 331 XML nodes
2025-10-06 03:28:00 - main - INFO - ‚òÅÔ∏è Loading to Snowflake stage layer...
2025-10-06 03:28:02 - loaders.snowflake_loader - INFO - ‚úÖ Loaded XML data to ETL_MAPPER.STAGE_XML_CP001
2025-10-06 03:28:02 - main - INFO - ‚úÖ Loaded to ETL_MAPPER.STAGE_XML_CP001
2025-10-06 03:28:02 - main - INFO - üóÑÔ∏è Fetching Silver layer schema from Snowflake...
2025-10-06 03:28:02 - utils.schema_manager - INFO - Fetching schema from INSURANCE.SILVER
2025-10-06 03:28:03 - utils.schema_manager - INFO - ‚úÖ Fetched 137 columns from 7 tables
2025-10-06 03:28:03 - main - INFO - ‚úÖ Fetched 137 columns from 7 tables
2025-10-06 03:28:03 - main - INFO - üìö Finding and loading reference data with AI...
2025-10-06 03:28:03 - utils.document_loader - INFO - üîç Found 9 potential reference files
2025-10-06 03:28:05 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 03:28:05 - utils.document_loader - INFO - üìÑ historical_mappings_personal_auto.xlsx: historical_mapping (relevance: 85%)
2025-10-06 03:28:06 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 03:28:06 - utils.document_loader - INFO - üìÑ historical_mappings_commercial.xlsx: historical_mapping (relevance: 85%)
2025-10-06 03:28:07 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 03:28:07 - utils.document_loader - INFO - üìÑ old_mappings.csv: historical_mapping (relevance: 85%)
2025-10-06 03:28:09 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 03:28:09 - utils.document_loader - INFO - üìÑ historical_mappings_homeowners.xlsx: historical_mapping (relevance: 85%)
2025-10-06 03:28:11 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 03:28:11 - utils.document_loader - INFO - üìÑ old_mappings_homeowners.csv: historical_mapping (relevance: 85%)
2025-10-06 03:28:13 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 03:28:13 - utils.document_loader - INFO - üìÑ old_mappings_personal_auto.csv: historical_mapping (relevance: 85%)
2025-10-06 03:28:14 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 03:28:14 - utils.document_loader - INFO - üìÑ old_mappings_commercial.csv: historical_mapping (relevance: 85%)
2025-10-06 03:28:15 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 03:28:15 - utils.document_loader - INFO - üìÑ data_dictionary.csv: data_dictionary (relevance: 90%)
2025-10-06 03:28:16 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 03:28:16 - utils.document_loader - INFO - üìÑ data_dictionary_complete.xlsx: data_dictionary (relevance: 90%)
2025-10-06 03:28:16 - utils.document_loader - INFO - Loading file: reference_data/data_dictionary.csv (type: .csv)
2025-10-06 03:28:18 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 03:28:18 - utils.document_loader - ERROR - Error loading reference_data/data_dictionary.csv: name 'true' is not defined
2025-10-06 03:28:18 - utils.document_loader - INFO - Loading file: reference_data/data_dictionary_complete.xlsx (type: .xlsx)
2025-10-06 03:28:18 - utils.document_loader - INFO - Found 3 sheets: ['DataDictionary', 'TableSummary', 'Metadata']
2025-10-06 03:28:20 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 03:28:20 - utils.document_loader - INFO - AI understands this as: data_dictionary
2025-10-06 03:28:20 - utils.document_loader - INFO - Loading file: reference_data/historical_mappings_personal_auto.xlsx (type: .xlsx)
2025-10-06 03:28:20 - utils.document_loader - INFO - Found 2 sheets: ['Mappings', 'Metadata']
2025-10-06 03:28:22 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 03:28:22 - utils.document_loader - INFO - AI understands this as: historical_mappings
2025-10-06 03:28:22 - utils.document_loader - INFO - Loading file: reference_data/historical_mappings_commercial.xlsx (type: .xlsx)
2025-10-06 03:28:22 - utils.document_loader - INFO - Found 1 sheets: ['Mappings']
2025-10-06 03:28:25 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 03:28:25 - utils.document_loader - INFO - AI understands this as: historical_mappings
2025-10-06 03:28:25 - utils.document_loader - INFO - Loading file: reference_data/old_mappings.csv (type: .csv)
2025-10-06 03:28:26 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 03:28:26 - utils.document_loader - ERROR - Error loading reference_data/old_mappings.csv: name 'true' is not defined
2025-10-06 03:28:26 - utils.document_loader - INFO - Loading file: reference_data/historical_mappings_homeowners.xlsx (type: .xlsx)
2025-10-06 03:28:26 - utils.document_loader - INFO - Found 1 sheets: ['Mappings']
2025-10-06 03:28:28 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 03:28:28 - utils.document_loader - INFO - AI understands this as: historical_mappings
2025-10-06 03:28:28 - utils.document_loader - INFO - 
============================================================
2025-10-06 03:28:28 - utils.document_loader - INFO - ‚úÖ LOADED REFERENCE DATA SUMMARY:
2025-10-06 03:28:28 - utils.document_loader - INFO - ============================================================
2025-10-06 03:28:28 - utils.document_loader - INFO -   üìö Historical mappings: 3 files
2025-10-06 03:28:28 - utils.document_loader - INFO -      - historical_mappings_personal_auto.xlsx (51 rows)
2025-10-06 03:28:28 - utils.document_loader - INFO -      - historical_mappings_commercial.xlsx (9 rows)
2025-10-06 03:28:28 - utils.document_loader - INFO -      - historical_mappings_homeowners.xlsx (14 rows)
2025-10-06 03:28:28 - utils.document_loader - INFO -   üìñ Data dictionaries: 1 files
2025-10-06 03:28:28 - utils.document_loader - INFO -      - data_dictionary_complete.xlsx (104 rows)
2025-10-06 03:28:28 - utils.document_loader - INFO -   üóÑÔ∏è Schema definitions: 0 files
2025-10-06 03:28:28 - utils.document_loader - INFO -   üìä Reference data: 0 files
2025-10-06 03:28:28 - utils.document_loader - INFO - ============================================================

2025-10-06 03:28:28 - main - INFO - ü§ñ Predicting mappings with AI (flexible mode)...
2025-10-06 03:28:42 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 03:29:06 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 03:29:16 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 03:29:34 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 03:30:05 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 03:30:13 - loaders.snowflake_loader - INFO - ‚úÖ Connected to Snowflake: INSURANCE.ETL_MAPPER with role ACCOUNTADMIN
2025-10-06 03:30:15 - etl.executor - INFO - ‚úÖ Required tables ensured
2025-10-06 03:30:20 - utils.database_helper - INFO - Loaded 166 approved mappings
2025-10-06 03:30:29 - loaders.snowflake_loader - INFO - ‚úÖ Connected to Snowflake: INSURANCE.ETL_MAPPER with role ACCOUNTADMIN
2025-10-06 03:30:30 - etl.executor - INFO - ‚úÖ Required tables ensured
2025-10-06 03:30:30 - utils.decorators - INFO - Starting run...
2025-10-06 03:30:30 - main - INFO - üîç Auto-detecting product type...
2025-10-06 03:30:30 - utils.product_detector - INFO - ‚úÖ Detected product: CP001 with 36.8% confidence
2025-10-06 03:30:30 - main - INFO - ‚úÖ Detected: CP001 with 36.8% confidence
2025-10-06 03:30:30 - main - INFO - üìä Extracting XML metadata...
2025-10-06 03:30:30 - main - INFO - ‚úÖ Extracted 331 XML nodes
2025-10-06 03:30:30 - main - INFO - ‚òÅÔ∏è Loading to Snowflake stage layer...
2025-10-06 03:30:31 - loaders.snowflake_loader - INFO - ‚úÖ Loaded XML data to ETL_MAPPER.STAGE_XML_CP001
2025-10-06 03:30:31 - main - INFO - ‚úÖ Loaded to ETL_MAPPER.STAGE_XML_CP001
2025-10-06 03:30:31 - main - INFO - üóÑÔ∏è Fetching Silver layer schema from Snowflake...
2025-10-06 03:30:31 - utils.schema_manager - INFO - Fetching schema from INSURANCE.SILVER
2025-10-06 03:30:31 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 03:30:31 - main - INFO - üíæ Saving results...
2025-10-06 03:30:31 - main - INFO - ‚úÖ Saved 64 mappings to output/mappings_CP001_20251006_033031.csv
2025-10-06 03:30:31 - main - INFO - ‚úÖ Pipeline completed successfully!
2025-10-06 03:30:31 - utils.decorators - INFO - run completed in 151.13s
2025-10-06 03:30:33 - utils.schema_manager - INFO - ‚úÖ Fetched 137 columns from 7 tables
2025-10-06 03:30:33 - main - INFO - ‚úÖ Fetched 137 columns from 7 tables
2025-10-06 03:30:33 - main - INFO - üìö Finding and loading reference data with AI...
2025-10-06 03:30:33 - utils.document_loader - INFO - üîç Found 9 potential reference files
2025-10-06 03:30:35 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 03:30:35 - utils.document_loader - INFO - üìÑ historical_mappings_personal_auto.xlsx: historical_mapping (relevance: 85%)
2025-10-06 03:30:39 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 03:30:39 - utils.document_loader - INFO - üìÑ historical_mappings_commercial.xlsx: historical_mapping (relevance: 85%)
2025-10-06 03:30:40 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 03:30:40 - utils.document_loader - INFO - üìÑ old_mappings.csv: historical_mapping (relevance: 85%)
2025-10-06 03:30:43 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 03:30:43 - utils.document_loader - INFO - üìÑ historical_mappings_homeowners.xlsx: historical_mapping (relevance: 85%)
2025-10-06 03:30:45 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 03:30:45 - utils.document_loader - INFO - üìÑ old_mappings_homeowners.csv: historical_mapping (relevance: 85%)
2025-10-06 03:30:46 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 03:30:46 - utils.document_loader - INFO - üìÑ old_mappings_personal_auto.csv: historical_mapping (relevance: 85%)
2025-10-06 03:30:52 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 03:30:52 - utils.document_loader - INFO - üìÑ old_mappings_commercial.csv: historical_mapping (relevance: 85%)
2025-10-06 03:30:53 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 03:30:53 - utils.document_loader - INFO - üìÑ data_dictionary.csv: data_dictionary (relevance: 90%)
2025-10-06 03:30:59 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 03:30:59 - utils.document_loader - INFO - üìÑ data_dictionary_complete.xlsx: data_dictionary (relevance: 85%)
2025-10-06 03:30:59 - utils.document_loader - INFO - Loading file: reference_data/data_dictionary.csv (type: .csv)
2025-10-06 03:31:01 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 03:31:01 - utils.document_loader - ERROR - Error loading reference_data/data_dictionary.csv: name 'true' is not defined
2025-10-06 03:31:01 - utils.document_loader - INFO - Loading file: reference_data/historical_mappings_personal_auto.xlsx (type: .xlsx)
2025-10-06 03:31:01 - utils.document_loader - INFO - Found 2 sheets: ['Mappings', 'Metadata']
2025-10-06 03:31:03 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 03:31:03 - utils.document_loader - INFO - AI understands this as: historical_mappings
2025-10-06 03:31:03 - utils.document_loader - INFO - Loading file: reference_data/historical_mappings_commercial.xlsx (type: .xlsx)
2025-10-06 03:31:03 - utils.document_loader - INFO - Found 1 sheets: ['Mappings']
2025-10-06 03:31:06 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 03:31:06 - utils.document_loader - INFO - AI understands this as: historical_mappings
2025-10-06 03:31:06 - utils.document_loader - INFO - Loading file: reference_data/old_mappings.csv (type: .csv)
2025-10-06 03:31:08 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 03:31:08 - utils.document_loader - ERROR - Error loading reference_data/old_mappings.csv: name 'true' is not defined
2025-10-06 03:31:08 - utils.document_loader - INFO - Loading file: reference_data/historical_mappings_homeowners.xlsx (type: .xlsx)
2025-10-06 03:31:08 - utils.document_loader - INFO - Found 1 sheets: ['Mappings']
2025-10-06 03:31:14 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 03:31:14 - utils.document_loader - INFO - AI understands this as: historical_mappings
2025-10-06 03:31:14 - utils.document_loader - INFO - Loading file: reference_data/data_dictionary_complete.xlsx (type: .xlsx)
2025-10-06 03:31:14 - utils.document_loader - INFO - Found 3 sheets: ['DataDictionary', 'TableSummary', 'Metadata']
2025-10-06 03:31:16 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 03:31:16 - utils.document_loader - INFO - AI understands this as: data_dictionary
2025-10-06 03:31:16 - utils.document_loader - INFO - 
============================================================
2025-10-06 03:31:16 - utils.document_loader - INFO - ‚úÖ LOADED REFERENCE DATA SUMMARY:
2025-10-06 03:31:16 - utils.document_loader - INFO - ============================================================
2025-10-06 03:31:16 - utils.document_loader - INFO -   üìö Historical mappings: 3 files
2025-10-06 03:31:16 - utils.document_loader - INFO -      - historical_mappings_personal_auto.xlsx (51 rows)
2025-10-06 03:31:16 - utils.document_loader - INFO -      - historical_mappings_commercial.xlsx (9 rows)
2025-10-06 03:31:16 - utils.document_loader - INFO -      - historical_mappings_homeowners.xlsx (14 rows)
2025-10-06 03:31:16 - utils.document_loader - INFO -   üìñ Data dictionaries: 1 files
2025-10-06 03:31:16 - utils.document_loader - INFO -      - data_dictionary_complete.xlsx (104 rows)
2025-10-06 03:31:16 - utils.document_loader - INFO -   üóÑÔ∏è Schema definitions: 0 files
2025-10-06 03:31:16 - utils.document_loader - INFO -   üìä Reference data: 0 files
2025-10-06 03:31:16 - utils.document_loader - INFO - ============================================================

2025-10-06 03:31:16 - main - INFO - ü§ñ Predicting mappings with AI (flexible mode)...
2025-10-06 03:31:39 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 03:32:09 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 03:32:19 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 03:32:35 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 03:33:02 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 03:33:28 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 03:33:28 - main - INFO - üíæ Saving results...
2025-10-06 03:33:28 - main - INFO - ‚úÖ Saved 66 mappings to output/mappings_CP001_20251006_033328.csv
2025-10-06 03:33:28 - main - INFO - ‚úÖ Pipeline completed successfully!
2025-10-06 03:33:28 - utils.decorators - INFO - run completed in 177.20s
2025-10-06 03:33:31 - utils.database_helper - INFO - ‚úÖ Loaded 1 row(s) of XML into staging for XML-20251006033330
2025-10-06 03:33:31 - utils.database_helper - INFO - ‚úÖ XML metadata saved for XML-20251006033330
2025-10-06 03:33:57 - utils.database_helper - INFO - ‚úÖ Saved 66 mappings
2025-10-06 03:34:02 - utils.database_helper - INFO - Loaded 166 approved mappings
2025-10-06 03:34:16 - loaders.snowflake_loader - INFO - ‚úÖ Connected to Snowflake: INSURANCE.ETL_MAPPER with role ACCOUNTADMIN
2025-10-06 03:34:17 - etl.executor - INFO - ‚úÖ Required tables ensured
2025-10-06 03:34:20 - loaders.snowflake_loader - INFO - ‚úÖ Connected to Snowflake: INSURANCE.ETL_MAPPER with role ACCOUNTADMIN
2025-10-06 03:34:21 - etl.executor - INFO - ‚úÖ Required tables ensured
2025-10-06 03:35:12 - loaders.snowflake_loader - INFO - ‚úÖ Connected to Snowflake: INSURANCE.ETL_MAPPER with role ACCOUNTADMIN
2025-10-06 03:35:15 - etl.executor - INFO - ‚úÖ Required tables ensured
2025-10-06 03:35:19 - utils.database_helper - INFO - Loaded 232 approved mappings
2025-10-06 03:35:38 - loaders.snowflake_loader - INFO - ‚úÖ Connected to Snowflake: INSURANCE.ETL_MAPPER with role ACCOUNTADMIN
2025-10-06 03:35:41 - etl.executor - INFO - ‚úÖ Required tables ensured
2025-10-06 03:35:41 - loaders.snowflake_loader - INFO - ‚úÖ Connected to Snowflake: INSURANCE.ETL_MAPPER with role ACCOUNTADMIN
2025-10-06 03:35:42 - etl.executor - INFO - ‚úÖ Required tables ensured
2025-10-06 03:35:43 - utils.database_helper - INFO - Loaded 232 approved mappings
2025-10-06 03:35:49 - loaders.snowflake_loader - INFO - ‚úÖ Connected to Snowflake: INSURANCE.ETL_MAPPER with role ACCOUNTADMIN
2025-10-06 03:35:50 - etl.executor - INFO - ‚úÖ Required tables ensured
2025-10-06 03:35:51 - utils.database_helper - INFO - Loaded 232 approved mappings
2025-10-06 03:36:06 - loaders.snowflake_loader - INFO - ‚úÖ Connected to Snowflake: INSURANCE.ETL_MAPPER with role ACCOUNTADMIN
2025-10-06 03:36:09 - etl.executor - INFO - ‚úÖ Required tables ensured
2025-10-06 03:36:10 - utils.database_helper - INFO - Loaded 232 approved mappings
2025-10-06 03:36:25 - loaders.snowflake_loader - INFO - ‚úÖ Connected to Snowflake: INSURANCE.ETL_MAPPER with role ACCOUNTADMIN
2025-10-06 03:36:26 - etl.executor - INFO - ‚úÖ Required tables ensured
2025-10-06 03:36:26 - utils.database_helper - INFO - Loaded 232 approved mappings
2025-10-06 03:36:28 - etl.executor - INFO - Processing 5 tables for xml_id: XML-20251006033330
2025-10-06 03:36:28 - etl.executor - INFO - Processing table: SILVER.POLICY with 22 mappings
2025-10-06 03:36:28 - etl.executor - INFO - Found 1 rows in XML_STAGING, 0 already processed
2025-10-06 03:36:28 - etl.executor - INFO - Using staging table: INSURANCE.ETL_MAPPER.XML_STAGING
2025-10-06 03:36:28 - etl.executor - INFO - Executing INSERT for SILVER.POLICY
2025-10-06 03:36:28 - etl.executor - ERROR - Insert failed for SILVER.POLICY: 002025 (42S21): SQL compilation error:
duplicate column name 'EFFECTIVE_DATE'
2025-10-06 03:36:28 - etl.executor - ERROR - SQL was: 
        INSERT INTO SILVER.POLICY (CANCELLATION_DATE, POLICY_NUMBER, EXPIRATION_DATE, EFFECTIVE_DATE, POLICY_ID, POLICY_TYPE, EFFECTIVE_DATE, POLICY_STATUS, DISTRIBUTION_CHANNEL, ACCOUNT_ID, CREATED_BY, PRODUCT_CODE, POLICY_STATUS, PRODUCT_NAME, PRODUCT_CODE, POLICY_TYPE, POLICY_ID, RENEWAL_DATE, POLICY_TERM_MONTHS, UNDERWRITING_COMPANY, PREMIUM_AMOUNT, TOTAL_INSURED_VALUE)
        SELECT stg.xml_data:BindDate::STRING AS CANCELLATION_DATE, stg.xml_data:Number::STRING AS POLICY_NUMBER, stg.xml_data:TerminationDate::STRING AS EXPIRATION_DATE, stg.xml_data:InceptionDate::STRING AS EFFECTIVE_DATE, stg.xml_data:TransactionID::STRING AS POLICY_ID, stg.xml_data:TransactionType::STRING AS POLICY_TYPE, stg.xml_data:TransactionDate::STRING AS EFFECTIVE_DATE, stg.xml_data:TransactionStatus::STRING AS POLICY_STATUS, stg.xml_data:SourceSystem::STRING AS DISTRIBUTION_CHANNEL, stg.xml_data:BrokerID::STRING AS ACCOUNT_ID, stg.xml_data:BrokerName::STRING AS CREATED_BY, stg.xml_data:BrokerType::STRING AS PRODUCT_CODE, stg.xml_data:StatusCode::STRING AS POLICY_STATUS, stg.xml_data:ProdDescription::STRING AS PRODUCT_NAME, stg.xml_data:ProdCode::STRING AS PRODUCT_CODE, stg.xml_data:Version::STRING AS POLICY_TYPE, stg.xml_data:ID::STRING AS POLICY_ID, stg.xml_data:QuoteDate::STRING AS RENEWAL_DATE, stg.xml_data:TermLength::STRING AS POLICY_TERM_MONTHS, stg.xml_data:BrokerageFirm::STRING AS UNDERWRITING_COMPANY, stg.xml_data:CommissionRate::STRING AS PREMIUM_AMOUNT, stg.xml_data:CommissionAmount::STRING AS TOTAL_INSURED_VALUE
        FROM INSURANCE.ETL_MAPPER.XML_STAGING stg
        WHERE stg.xml_id = 'XML-20251006033330' AND stg.processed = FALSE
        
2025-10-06 03:36:28 - etl.executor - ERROR - ‚ùå Failed to process SILVER.POLICY: 002025 (42S21): SQL compilation error:
duplicate column name 'EFFECTIVE_DATE'
2025-10-06 03:36:28 - etl.executor - ERROR - Traceback (most recent call last):
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 124, in execute_mappings
    rows_inserted = self._insert_to_silver(
        cursor, xml_id, table, table_mappings
    )
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 260, in _insert_to_silver
    cursor.execute(insert_sql)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/.venv/lib/python3.13/site-packages/snowflake/connector/cursor.py", line 1134, in execute
    Error.errorhandler_wrapper(self.connection, self, error_class, errvalue)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/.venv/lib/python3.13/site-packages/snowflake/connector/errors.py", line 286, in errorhandler_wrapper
    handed_over = Error.hand_to_other_handler(
        connection,
    ...<2 lines>...
        error_value,
    )
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/.venv/lib/python3.13/site-packages/snowflake/connector/errors.py", line 341, in hand_to_other_handler
    cursor.errorhandler(connection, cursor, error_class, error_value)
    ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/.venv/lib/python3.13/site-packages/snowflake/connector/errors.py", line 217, in default_errorhandler
    raise error_class(
    ...<10 lines>...
    )
snowflake.connector.errors.ProgrammingError: 002025 (42S21): SQL compilation error:
duplicate column name 'EFFECTIVE_DATE'

2025-10-06 03:36:28 - etl.executor - INFO - Processing table: SILVER.PAYMENT with 14 mappings
2025-10-06 03:36:28 - etl.executor - INFO - Found 1 rows in XML_STAGING, 0 already processed
2025-10-06 03:36:28 - etl.executor - INFO - Using staging table: INSURANCE.ETL_MAPPER.XML_STAGING
2025-10-06 03:36:28 - etl.executor - INFO - Executing INSERT for SILVER.PAYMENT
2025-10-06 03:36:34 - etl.executor - ERROR - Insert failed for SILVER.PAYMENT: 100072 (22000): DML operation to table SILVER.PAYMENT failed on column PAYMENT_ID with error: NULL result in a non-nullable column
2025-10-06 03:36:34 - etl.executor - ERROR - SQL was: 
        INSERT INTO SILVER.PAYMENT (PAYMENT_ID, PAYMENT_NUMBER, PAYMENT_TYPE, PAYMENT_METHOD, PAYMENT_STATUS, PAYMENT_DATE, PAYMENT_AMOUNT, PAYMENT_TERM, TOTAL_INSTALLMENTS, ACCOUNT_HOLDER_NAME, BANK_NAME, ACCOUNT_NUMBER, ROUTING_NUMBER, CARD_TYPE)
        SELECT stg.xml_data:PaymentIdentifier::STRING AS PAYMENT_ID, stg.xml_data:PaymentNumber::STRING AS PAYMENT_NUMBER, stg.xml_data:TransactionType::STRING AS PAYMENT_TYPE, stg.xml_data:PaymentMode::STRING AS PAYMENT_METHOD, stg.xml_data:StatusDescription::STRING AS PAYMENT_STATUS, stg.xml_data:ScheduledDate::STRING AS PAYMENT_DATE, stg.xml_data:TransactionAmount::STRING AS PAYMENT_AMOUNT, stg.xml_data:BillingPlan::STRING AS PAYMENT_TERM, stg.xml_data:TotalInstallments::STRING AS TOTAL_INSTALLMENTS, stg.xml_data:NameOnAccount::STRING AS ACCOUNT_HOLDER_NAME, stg.xml_data:FinancialInstitution::STRING AS BANK_NAME, stg.xml_data:AccountNumber::STRING AS ACCOUNT_NUMBER, stg.xml_data:RoutingNumber::STRING AS ROUTING_NUMBER, stg.xml_data:AccountType::STRING AS CARD_TYPE
        FROM INSURANCE.ETL_MAPPER.XML_STAGING stg
        WHERE stg.xml_id = 'XML-20251006033330' AND stg.processed = FALSE
        
2025-10-06 03:36:34 - etl.executor - ERROR - ‚ùå Failed to process SILVER.PAYMENT: 100072 (22000): DML operation to table SILVER.PAYMENT failed on column PAYMENT_ID with error: NULL result in a non-nullable column
2025-10-06 03:36:34 - etl.executor - ERROR - Traceback (most recent call last):
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 124, in execute_mappings
    rows_inserted = self._insert_to_silver(
        cursor, xml_id, table, table_mappings
    )
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 260, in _insert_to_silver
    cursor.execute(insert_sql)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/.venv/lib/python3.13/site-packages/snowflake/connector/cursor.py", line 1134, in execute
    Error.errorhandler_wrapper(self.connection, self, error_class, errvalue)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/.venv/lib/python3.13/site-packages/snowflake/connector/errors.py", line 286, in errorhandler_wrapper
    handed_over = Error.hand_to_other_handler(
        connection,
    ...<2 lines>...
        error_value,
    )
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/.venv/lib/python3.13/site-packages/snowflake/connector/errors.py", line 341, in hand_to_other_handler
    cursor.errorhandler(connection, cursor, error_class, error_value)
    ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/.venv/lib/python3.13/site-packages/snowflake/connector/errors.py", line 217, in default_errorhandler
    raise error_class(
    ...<10 lines>...
    )
snowflake.connector.errors.IntegrityError: 100072 (22000): DML operation to table SILVER.PAYMENT failed on column PAYMENT_ID with error: NULL result in a non-nullable column

2025-10-06 03:36:35 - etl.executor - INFO - Processing table: SILVER.RISK with 11 mappings
2025-10-06 03:36:35 - etl.executor - INFO - Found 1 rows in XML_STAGING, 0 already processed
2025-10-06 03:36:35 - etl.executor - INFO - Using staging table: INSURANCE.ETL_MAPPER.XML_STAGING
2025-10-06 03:36:35 - etl.executor - INFO - Executing INSERT for SILVER.RISK
2025-10-06 03:36:35 - etl.executor - ERROR - Insert failed for SILVER.RISK: 002025 (42S21): SQL compilation error:
duplicate column name 'RISK_NUMBER'
2025-10-06 03:36:35 - etl.executor - ERROR - SQL was: 
        INSERT INTO SILVER.RISK (RISK_STATE, RISK_CITY, RISK_ADDRESS_LINE2, RISK_ADDRESS_LINE1, RISK_NUMBER, RISK_DESCRIPTION, RISK_TYPE, RISK_NUMBER, RISK_ID, RISK_ZIP, RISK_COUNTRY)
        SELECT stg.xml_data:State::STRING AS RISK_STATE, stg.xml_data:City::STRING AS RISK_CITY, stg.xml_data:AddressLine2::STRING AS RISK_ADDRESS_LINE2, stg.xml_data:AddressLine1::STRING AS RISK_ADDRESS_LINE1, stg.xml_data:LocationNumber::STRING AS RISK_NUMBER, stg.xml_data:RiskSummary::STRING AS RISK_DESCRIPTION, stg.xml_data:RiskClass::STRING AS RISK_TYPE, stg.xml_data:RiskSequence::STRING AS RISK_NUMBER, stg.xml_data:RiskIdentifier::STRING AS RISK_ID, stg.xml_data:ZipCode::STRING AS RISK_ZIP, stg.xml_data:Country::STRING AS RISK_COUNTRY
        FROM INSURANCE.ETL_MAPPER.XML_STAGING stg
        WHERE stg.xml_id = 'XML-20251006033330' AND stg.processed = FALSE
        
2025-10-06 03:36:35 - etl.executor - ERROR - ‚ùå Failed to process SILVER.RISK: 002025 (42S21): SQL compilation error:
duplicate column name 'RISK_NUMBER'
2025-10-06 03:36:35 - etl.executor - ERROR - Traceback (most recent call last):
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 124, in execute_mappings
    rows_inserted = self._insert_to_silver(
        cursor, xml_id, table, table_mappings
    )
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 260, in _insert_to_silver
    cursor.execute(insert_sql)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/.venv/lib/python3.13/site-packages/snowflake/connector/cursor.py", line 1134, in execute
    Error.errorhandler_wrapper(self.connection, self, error_class, errvalue)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/.venv/lib/python3.13/site-packages/snowflake/connector/errors.py", line 286, in errorhandler_wrapper
    handed_over = Error.hand_to_other_handler(
        connection,
    ...<2 lines>...
        error_value,
    )
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/.venv/lib/python3.13/site-packages/snowflake/connector/errors.py", line 341, in hand_to_other_handler
    cursor.errorhandler(connection, cursor, error_class, error_value)
    ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/.venv/lib/python3.13/site-packages/snowflake/connector/errors.py", line 217, in default_errorhandler
    raise error_class(
    ...<10 lines>...
    )
snowflake.connector.errors.ProgrammingError: 002025 (42S21): SQL compilation error:
duplicate column name 'RISK_NUMBER'

2025-10-06 03:36:36 - etl.executor - INFO - Processing table: SILVER.QUOTE with 6 mappings
2025-10-06 03:36:36 - etl.executor - INFO - Found 1 rows in XML_STAGING, 0 already processed
2025-10-06 03:36:36 - etl.executor - INFO - Using staging table: INSURANCE.ETL_MAPPER.XML_STAGING
2025-10-06 03:36:36 - etl.executor - INFO - Executing INSERT for SILVER.QUOTE
2025-10-06 03:36:37 - etl.executor - ERROR - Insert failed for SILVER.QUOTE: 100072 (22000): DML operation to table SILVER.QUOTE failed on column QUOTE_ID with error: NULL result in a non-nullable column
2025-10-06 03:36:37 - etl.executor - ERROR - SQL was: 
        INSERT INTO SILVER.QUOTE (EFFECTIVE_DATE, EXPIRY_DATE, QUOTE_DATE, QUOTE_STATUS, QUOTE_ID, QUOTE_NUMBER)
        SELECT stg.xml_data:ConversionDate::STRING AS EFFECTIVE_DATE, stg.xml_data:QuoteExpiryDate::STRING AS EXPIRY_DATE, stg.xml_data:QuoteDate::STRING AS QUOTE_DATE, stg.xml_data:QuoteStatus::STRING AS QUOTE_STATUS, stg.xml_data:QuoteIdentifier::STRING AS QUOTE_ID, stg.xml_data:QuoteNumber::STRING AS QUOTE_NUMBER
        FROM INSURANCE.ETL_MAPPER.XML_STAGING stg
        WHERE stg.xml_id = 'XML-20251006033330' AND stg.processed = FALSE
        
2025-10-06 03:36:37 - etl.executor - ERROR - ‚ùå Failed to process SILVER.QUOTE: 100072 (22000): DML operation to table SILVER.QUOTE failed on column QUOTE_ID with error: NULL result in a non-nullable column
2025-10-06 03:36:37 - etl.executor - ERROR - Traceback (most recent call last):
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 124, in execute_mappings
    rows_inserted = self._insert_to_silver(
        cursor, xml_id, table, table_mappings
    )
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 260, in _insert_to_silver
    cursor.execute(insert_sql)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/.venv/lib/python3.13/site-packages/snowflake/connector/cursor.py", line 1134, in execute
    Error.errorhandler_wrapper(self.connection, self, error_class, errvalue)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/.venv/lib/python3.13/site-packages/snowflake/connector/errors.py", line 286, in errorhandler_wrapper
    handed_over = Error.hand_to_other_handler(
        connection,
    ...<2 lines>...
        error_value,
    )
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/.venv/lib/python3.13/site-packages/snowflake/connector/errors.py", line 341, in hand_to_other_handler
    cursor.errorhandler(connection, cursor, error_class, error_value)
    ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/.venv/lib/python3.13/site-packages/snowflake/connector/errors.py", line 217, in default_errorhandler
    raise error_class(
    ...<10 lines>...
    )
snowflake.connector.errors.IntegrityError: 100072 (22000): DML operation to table SILVER.QUOTE failed on column QUOTE_ID with error: NULL result in a non-nullable column

2025-10-06 03:36:37 - etl.executor - INFO - Processing table: SILVER.COVERAGE with 13 mappings
2025-10-06 03:36:37 - etl.executor - INFO - Found 1 rows in XML_STAGING, 0 already processed
2025-10-06 03:36:37 - etl.executor - INFO - Using staging table: INSURANCE.ETL_MAPPER.XML_STAGING
2025-10-06 03:36:37 - etl.executor - INFO - Executing INSERT for SILVER.COVERAGE
2025-10-06 03:36:41 - etl.executor - ERROR - Insert failed for SILVER.COVERAGE: 100072 (22000): DML operation to table SILVER.COVERAGE failed on column COVERAGE_ID with error: NULL result in a non-nullable column
2025-10-06 03:36:41 - etl.executor - ERROR - SQL was: 
        INSERT INTO SILVER.COVERAGE (IS_MANDATORY, EXPIRATION_DATE, EFFECTIVE_DATE, COVERAGE_PREMIUM, COINSURANCE_PERCENTAGE, COVERAGE_BASIS, COVERAGE_DEDUCTIBLE, COVERAGE_LIMIT, COVERAGE_TYPE, COVERAGE_NAME, COVERAGE_CODE, RISK_ID, COVERAGE_ID)
        SELECT stg.xml_data:IsMandatory::STRING AS IS_MANDATORY, stg.xml_data:CoverageEndDate::STRING AS EXPIRATION_DATE, stg.xml_data:CoverageStartDate::STRING AS EFFECTIVE_DATE, stg.xml_data:CoveragePremium::STRING AS COVERAGE_PREMIUM, stg.xml_data:CoinsurancePercent::STRING AS COINSURANCE_PERCENTAGE, stg.xml_data:CoverageBasis::STRING AS COVERAGE_BASIS, stg.xml_data:CoverageDeductible::STRING AS COVERAGE_DEDUCTIBLE, stg.xml_data:MaxLimit::STRING AS COVERAGE_LIMIT, stg.xml_data:CoverageClass::STRING AS COVERAGE_TYPE, stg.xml_data:CoverageDescription::STRING AS COVERAGE_NAME, stg.xml_data:CoverageSymbol::STRING AS COVERAGE_CODE, stg.xml_data:RiskIdentifier::STRING AS RISK_ID, stg.xml_data:CoverageIdentifier::STRING AS COVERAGE_ID
        FROM INSURANCE.ETL_MAPPER.XML_STAGING stg
        WHERE stg.xml_id = 'XML-20251006033330' AND stg.processed = FALSE
        
2025-10-06 03:36:41 - etl.executor - ERROR - ‚ùå Failed to process SILVER.COVERAGE: 100072 (22000): DML operation to table SILVER.COVERAGE failed on column COVERAGE_ID with error: NULL result in a non-nullable column
2025-10-06 03:36:41 - etl.executor - ERROR - Traceback (most recent call last):
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 124, in execute_mappings
    rows_inserted = self._insert_to_silver(
        cursor, xml_id, table, table_mappings
    )
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 260, in _insert_to_silver
    cursor.execute(insert_sql)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/.venv/lib/python3.13/site-packages/snowflake/connector/cursor.py", line 1134, in execute
    Error.errorhandler_wrapper(self.connection, self, error_class, errvalue)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/.venv/lib/python3.13/site-packages/snowflake/connector/errors.py", line 286, in errorhandler_wrapper
    handed_over = Error.hand_to_other_handler(
        connection,
    ...<2 lines>...
        error_value,
    )
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/.venv/lib/python3.13/site-packages/snowflake/connector/errors.py", line 341, in hand_to_other_handler
    cursor.errorhandler(connection, cursor, error_class, error_value)
    ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/.venv/lib/python3.13/site-packages/snowflake/connector/errors.py", line 217, in default_errorhandler
    raise error_class(
    ...<10 lines>...
    )
snowflake.connector.errors.IntegrityError: 100072 (22000): DML operation to table SILVER.COVERAGE failed on column COVERAGE_ID with error: NULL result in a non-nullable column

2025-10-06 03:41:58 - utils.logging_config - INFO - Logging configured at INFO level
2025-10-06 03:41:58 - etl.executor - INFO - ETL Executor initialized. Log file: logs/etl_executor_20251006.log
2025-10-06 03:41:58 - loaders.snowflake_loader - INFO - ‚úÖ Connected to Snowflake: INSURANCE.ETL_MAPPER with role ACCOUNTADMIN
2025-10-06 03:41:59 - etl.executor - INFO - ‚úÖ Required tables ensured
2025-10-06 03:42:00 - utils.database_helper - INFO - Loaded 232 approved mappings
2025-10-06 03:42:01 - etl.executor - INFO - Processing 5 tables for xml_id: XML-20251006033330
2025-10-06 03:42:01 - etl.executor - INFO - Processing table: SILVER.POLICY with 22 mappings
2025-10-06 03:42:01 - etl.executor - INFO - Found 1 rows in XML_STAGING, 0 already processed
2025-10-06 03:42:01 - etl.executor - INFO - Using staging table: INSURANCE.ETL_MAPPER.XML_STAGING
2025-10-06 03:42:01 - etl.executor - WARNING - ‚ö†Ô∏è Skipping duplicate column: EFFECTIVE_DATE
2025-10-06 03:42:01 - etl.executor - WARNING - ‚ö†Ô∏è Skipping duplicate column: POLICY_STATUS
2025-10-06 03:42:01 - etl.executor - WARNING - ‚ö†Ô∏è Skipping duplicate column: PRODUCT_CODE
2025-10-06 03:42:01 - etl.executor - WARNING - ‚ö†Ô∏è Skipping duplicate column: POLICY_TYPE
2025-10-06 03:42:01 - etl.executor - WARNING - ‚ö†Ô∏è Skipping duplicate column: POLICY_ID
2025-10-06 03:42:01 - etl.executor - INFO - Executing INSERT for SILVER.POLICY
2025-10-06 03:42:01 - etl.executor - ERROR - Insert failed for SILVER.POLICY: 001003 (42000): SQL compilation error:
syntax error line 2 at position 38 unexpected 'Session'.
syntax error line 2 at position 45 unexpected ':'.
2025-10-06 03:42:01 - etl.executor - ERROR - Full SQL: 
        INSERT INTO SILVER.POLICY (CANCELLATION_DATE, POLICY_NUMBER, EXPIRATION_DATE, EFFECTIVE_DATE, POLICY_ID, POLICY_TYPE, POLICY_STATUS, DISTRIBUTION_CHANNEL, ACCOUNT_ID, CREATED_BY, PRODUCT_CODE, PRODUCT_NAME, RENEWAL_DATE, POLICY_TERM_MONTHS, UNDERWRITING_COMPANY, PREMIUM_AMOUNT, TOTAL_INSURED_VALUE)
        SELECT COALESCE(stg.xml_data::Session:Data:PolicyData:PolicyDates:BindDate::STRING, '') AS CANCELLATION_DATE, COALESCE(stg.xml_data::Session:Data:PolicyData:Number::STRING, '') AS POLICY_NUMBER, COALESCE(stg.xml_data::Session:Data:PolicyData:PolicyDates:TerminationDate::STRING, '') AS EXPIRATION_DATE, COALESCE(stg.xml_data::Session:Data:PolicyData:PolicyDates:InceptionDate::STRING, '') AS EFFECTIVE_DATE, COALESCE(stg.xml_data::Session:TransactionInfo:TransactionID::STRING, '') AS POLICY_ID, COALESCE(stg.xml_data::Session:TransactionInfo:TransactionType::STRING, '') AS POLICY_TYPE, COALESCE(stg.xml_data::Session:TransactionInfo:TransactionStatus::STRING, '') AS POLICY_STATUS, COALESCE(stg.xml_data::Session:TransactionInfo:SourceSystem::STRING, '') AS DISTRIBUTION_CHANNEL, COALESCE(stg.xml_data::Session:Data:BrokerData:BrokerID::STRING, '') AS ACCOUNT_ID, COALESCE(stg.xml_data::Session:Data:BrokerData:BrokerName::STRING, '') AS CREATED_BY, COALESCE(stg.xml_data::Session:Data:BrokerData:BrokerType::STRING, '') AS PRODUCT_CODE, COALESCE(stg.xml_data::Session:Data:PolicyData:ProductDetails:ProdDescription::STRING, '') AS PRODUCT_NAME, COALESCE(stg.xml_data::Session:Data:PolicyData:PolicyDates:QuoteDate::STRING, '') AS RENEWAL_DATE, COALESCE(stg.xml_data::Session:Data:PolicyData:TermLength::STRING, '') AS POLICY_TERM_MONTHS, COALESCE(stg.xml_data::Session:Data:BrokerData:BrokerageFirm::STRING, '') AS UNDERWRITING_COMPANY, COALESCE(stg.xml_data::Session:Data:BrokerData:CommissionRate::STRING, '') AS PREMIUM_AMOUNT, COALESCE(stg.xml_data::Session:Data:BrokerData:CommissionAmount::STRING, '') AS TOTAL_INSURED_VALUE
        FROM INSURANCE.ETL_MAPPER.XML_STAGING stg
        WHERE stg.xml_id = 'XML-20251006033330' AND stg.processed = FALSE
        
2025-10-06 03:42:01 - etl.executor - ERROR - ‚ùå Failed to process SILVER.POLICY: 001003 (42000): SQL compilation error:
syntax error line 2 at position 38 unexpected 'Session'.
syntax error line 2 at position 45 unexpected ':'.
2025-10-06 03:42:01 - etl.executor - ERROR - Traceback (most recent call last):
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 124, in execute_mappings
    rows_inserted = self._insert_to_silver(
        cursor, xml_id, table, table_mappings
    )
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 289, in _insert_to_silver
    cursor.execute(insert_sql)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/.venv/lib/python3.13/site-packages/snowflake/connector/cursor.py", line 1134, in execute
    Error.errorhandler_wrapper(self.connection, self, error_class, errvalue)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/.venv/lib/python3.13/site-packages/snowflake/connector/errors.py", line 286, in errorhandler_wrapper
    handed_over = Error.hand_to_other_handler(
        connection,
    ...<2 lines>...
        error_value,
    )
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/.venv/lib/python3.13/site-packages/snowflake/connector/errors.py", line 341, in hand_to_other_handler
    cursor.errorhandler(connection, cursor, error_class, error_value)
    ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/.venv/lib/python3.13/site-packages/snowflake/connector/errors.py", line 217, in default_errorhandler
    raise error_class(
    ...<10 lines>...
    )
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 2 at position 38 unexpected 'Session'.
syntax error line 2 at position 45 unexpected ':'.

2025-10-06 03:42:02 - etl.executor - INFO - Processing table: SILVER.PAYMENT with 14 mappings
2025-10-06 03:42:02 - etl.executor - INFO - Found 1 rows in XML_STAGING, 0 already processed
2025-10-06 03:42:02 - etl.executor - INFO - Using staging table: INSURANCE.ETL_MAPPER.XML_STAGING
2025-10-06 03:42:02 - etl.executor - INFO - Executing INSERT for SILVER.PAYMENT
2025-10-06 03:42:02 - etl.executor - ERROR - Insert failed for SILVER.PAYMENT: 001003 (42000): SQL compilation error:
syntax error line 2 at position 38 unexpected 'Session'.
syntax error line 2 at position 45 unexpected ':'.
2025-10-06 03:42:02 - etl.executor - ERROR - Full SQL: 
        INSERT INTO SILVER.PAYMENT (PAYMENT_ID, PAYMENT_NUMBER, PAYMENT_TYPE, PAYMENT_METHOD, PAYMENT_STATUS, PAYMENT_DATE, PAYMENT_AMOUNT, PAYMENT_TERM, TOTAL_INSTALLMENTS, ACCOUNT_HOLDER_NAME, BANK_NAME, ACCOUNT_NUMBER, ROUTING_NUMBER, CARD_TYPE)
        SELECT COALESCE(stg.xml_data::Session:Data:PaymentData:PaymentIdentifier::STRING, '') AS PAYMENT_ID, COALESCE(stg.xml_data::Session:Data:PaymentData:PaymentNumber::STRING, '') AS PAYMENT_NUMBER, COALESCE(stg.xml_data::Session:Data:PaymentData:TransactionType::STRING, '') AS PAYMENT_TYPE, COALESCE(stg.xml_data::Session:Data:PaymentData:PaymentMode::STRING, '') AS PAYMENT_METHOD, COALESCE(stg.xml_data::Session:Data:PaymentData:StatusDescription::STRING, '') AS PAYMENT_STATUS, COALESCE(stg.xml_data::Session:Data:PaymentData:ScheduledDate::STRING, '') AS PAYMENT_DATE, COALESCE(stg.xml_data::Session:Data:PaymentData:TransactionAmount::STRING, '') AS PAYMENT_AMOUNT, COALESCE(stg.xml_data::Session:Data:PaymentData:BillingPlan::STRING, '') AS PAYMENT_TERM, COALESCE(stg.xml_data::Session:Data:PaymentData:TotalInstallments::STRING, '') AS TOTAL_INSTALLMENTS, COALESCE(stg.xml_data::Session:Data:PaymentData:PaymentAccountInfo:NameOnAccount::STRING, '') AS ACCOUNT_HOLDER_NAME, COALESCE(stg.xml_data::Session:Data:PaymentData:PaymentAccountInfo:FinancialInstitution::STRING, '') AS BANK_NAME, COALESCE(stg.xml_data::Session:Data:PaymentData:PaymentAccountInfo:AccountNumber::STRING, '') AS ACCOUNT_NUMBER, COALESCE(stg.xml_data::Session:Data:PaymentData:PaymentAccountInfo:RoutingNumber::STRING, '') AS ROUTING_NUMBER, COALESCE(stg.xml_data::Session:Data:PaymentData:PaymentAccountInfo:AccountType::STRING, '') AS CARD_TYPE
        FROM INSURANCE.ETL_MAPPER.XML_STAGING stg
        WHERE stg.xml_id = 'XML-20251006033330' AND stg.processed = FALSE
        
2025-10-06 03:42:02 - etl.executor - ERROR - ‚ùå Failed to process SILVER.PAYMENT: 001003 (42000): SQL compilation error:
syntax error line 2 at position 38 unexpected 'Session'.
syntax error line 2 at position 45 unexpected ':'.
2025-10-06 03:42:02 - etl.executor - ERROR - Traceback (most recent call last):
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 124, in execute_mappings
    rows_inserted = self._insert_to_silver(
        cursor, xml_id, table, table_mappings
    )
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 289, in _insert_to_silver
    cursor.execute(insert_sql)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/.venv/lib/python3.13/site-packages/snowflake/connector/cursor.py", line 1134, in execute
    Error.errorhandler_wrapper(self.connection, self, error_class, errvalue)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/.venv/lib/python3.13/site-packages/snowflake/connector/errors.py", line 286, in errorhandler_wrapper
    handed_over = Error.hand_to_other_handler(
        connection,
    ...<2 lines>...
        error_value,
    )
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/.venv/lib/python3.13/site-packages/snowflake/connector/errors.py", line 341, in hand_to_other_handler
    cursor.errorhandler(connection, cursor, error_class, error_value)
    ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/.venv/lib/python3.13/site-packages/snowflake/connector/errors.py", line 217, in default_errorhandler
    raise error_class(
    ...<10 lines>...
    )
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 2 at position 38 unexpected 'Session'.
syntax error line 2 at position 45 unexpected ':'.

2025-10-06 03:42:03 - etl.executor - INFO - Processing table: SILVER.RISK with 11 mappings
2025-10-06 03:42:03 - etl.executor - INFO - Found 1 rows in XML_STAGING, 0 already processed
2025-10-06 03:42:03 - etl.executor - INFO - Using staging table: INSURANCE.ETL_MAPPER.XML_STAGING
2025-10-06 03:42:03 - etl.executor - WARNING - ‚ö†Ô∏è Skipping duplicate column: RISK_NUMBER
2025-10-06 03:42:03 - etl.executor - INFO - Executing INSERT for SILVER.RISK
2025-10-06 03:42:03 - etl.executor - ERROR - Insert failed for SILVER.RISK: 001003 (42000): SQL compilation error:
syntax error line 2 at position 38 unexpected 'Session'.
syntax error line 2 at position 45 unexpected ':'.
2025-10-06 03:42:03 - etl.executor - ERROR - Full SQL: 
        INSERT INTO SILVER.RISK (RISK_STATE, RISK_CITY, RISK_ADDRESS_LINE2, RISK_ADDRESS_LINE1, RISK_NUMBER, RISK_DESCRIPTION, RISK_TYPE, RISK_ID, RISK_ZIP, RISK_COUNTRY)
        SELECT COALESCE(stg.xml_data::Session:Data:RiskData:LocationDetails:State::STRING, '') AS RISK_STATE, COALESCE(stg.xml_data::Session:Data:RiskData:LocationDetails:City::STRING, '') AS RISK_CITY, COALESCE(stg.xml_data::Session:Data:RiskData:LocationDetails:AddressLine2::STRING, '') AS RISK_ADDRESS_LINE2, COALESCE(stg.xml_data::Session:Data:RiskData:LocationDetails:AddressLine1::STRING, '') AS RISK_ADDRESS_LINE1, COALESCE(stg.xml_data::Session:Data:RiskData:LocationDetails:LocationNumber::STRING, '') AS RISK_NUMBER, COALESCE(stg.xml_data::Session:Data:RiskData:RiskSummary::STRING, '') AS RISK_DESCRIPTION, COALESCE(stg.xml_data::Session:Data:RiskData:RiskClass::STRING, '') AS RISK_TYPE, COALESCE(stg.xml_data::Session:Data:RiskData:RiskIdentifier::STRING, '') AS RISK_ID, COALESCE(stg.xml_data::Session:Data:RiskData:LocationDetails:ZipCode::STRING, '') AS RISK_ZIP, COALESCE(stg.xml_data::Session:Data:RiskData:LocationDetails:Country::STRING, '') AS RISK_COUNTRY
        FROM INSURANCE.ETL_MAPPER.XML_STAGING stg
        WHERE stg.xml_id = 'XML-20251006033330' AND stg.processed = FALSE
        
2025-10-06 03:42:03 - etl.executor - ERROR - ‚ùå Failed to process SILVER.RISK: 001003 (42000): SQL compilation error:
syntax error line 2 at position 38 unexpected 'Session'.
syntax error line 2 at position 45 unexpected ':'.
2025-10-06 03:42:03 - etl.executor - ERROR - Traceback (most recent call last):
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 124, in execute_mappings
    rows_inserted = self._insert_to_silver(
        cursor, xml_id, table, table_mappings
    )
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 289, in _insert_to_silver
    cursor.execute(insert_sql)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/.venv/lib/python3.13/site-packages/snowflake/connector/cursor.py", line 1134, in execute
    Error.errorhandler_wrapper(self.connection, self, error_class, errvalue)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/.venv/lib/python3.13/site-packages/snowflake/connector/errors.py", line 286, in errorhandler_wrapper
    handed_over = Error.hand_to_other_handler(
        connection,
    ...<2 lines>...
        error_value,
    )
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/.venv/lib/python3.13/site-packages/snowflake/connector/errors.py", line 341, in hand_to_other_handler
    cursor.errorhandler(connection, cursor, error_class, error_value)
    ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/.venv/lib/python3.13/site-packages/snowflake/connector/errors.py", line 217, in default_errorhandler
    raise error_class(
    ...<10 lines>...
    )
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 2 at position 38 unexpected 'Session'.
syntax error line 2 at position 45 unexpected ':'.

2025-10-06 03:42:03 - etl.executor - INFO - Processing table: SILVER.QUOTE with 6 mappings
2025-10-06 03:42:03 - etl.executor - INFO - Found 1 rows in XML_STAGING, 0 already processed
2025-10-06 03:42:03 - etl.executor - INFO - Using staging table: INSURANCE.ETL_MAPPER.XML_STAGING
2025-10-06 03:42:03 - etl.executor - INFO - Executing INSERT for SILVER.QUOTE
2025-10-06 03:42:04 - etl.executor - ERROR - Insert failed for SILVER.QUOTE: 001003 (42000): SQL compilation error:
syntax error line 2 at position 38 unexpected 'Session'.
syntax error line 2 at position 45 unexpected ':'.
2025-10-06 03:42:04 - etl.executor - ERROR - Full SQL: 
        INSERT INTO SILVER.QUOTE (EFFECTIVE_DATE, EXPIRY_DATE, QUOTE_DATE, QUOTE_STATUS, QUOTE_ID, QUOTE_NUMBER)
        SELECT COALESCE(stg.xml_data::Session:Data:QuoteData:ConversionDate::STRING, '') AS EFFECTIVE_DATE, COALESCE(stg.xml_data::Session:Data:QuoteData:QuoteExpiryDate::STRING, '') AS EXPIRY_DATE, COALESCE(stg.xml_data::Session:Data:QuoteData:QuoteDate::STRING, '') AS QUOTE_DATE, COALESCE(stg.xml_data::Session:Data:QuoteData:QuoteStatus::STRING, '') AS QUOTE_STATUS, COALESCE(stg.xml_data::Session:Data:QuoteData:QuoteIdentifier::STRING, '') AS QUOTE_ID, COALESCE(stg.xml_data::Session:Data:QuoteData:QuoteNumber::STRING, '') AS QUOTE_NUMBER
        FROM INSURANCE.ETL_MAPPER.XML_STAGING stg
        WHERE stg.xml_id = 'XML-20251006033330' AND stg.processed = FALSE
        
2025-10-06 03:42:04 - etl.executor - ERROR - ‚ùå Failed to process SILVER.QUOTE: 001003 (42000): SQL compilation error:
syntax error line 2 at position 38 unexpected 'Session'.
syntax error line 2 at position 45 unexpected ':'.
2025-10-06 03:42:04 - etl.executor - ERROR - Traceback (most recent call last):
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 124, in execute_mappings
    rows_inserted = self._insert_to_silver(
        cursor, xml_id, table, table_mappings
    )
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 289, in _insert_to_silver
    cursor.execute(insert_sql)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/.venv/lib/python3.13/site-packages/snowflake/connector/cursor.py", line 1134, in execute
    Error.errorhandler_wrapper(self.connection, self, error_class, errvalue)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/.venv/lib/python3.13/site-packages/snowflake/connector/errors.py", line 286, in errorhandler_wrapper
    handed_over = Error.hand_to_other_handler(
        connection,
    ...<2 lines>...
        error_value,
    )
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/.venv/lib/python3.13/site-packages/snowflake/connector/errors.py", line 341, in hand_to_other_handler
    cursor.errorhandler(connection, cursor, error_class, error_value)
    ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/.venv/lib/python3.13/site-packages/snowflake/connector/errors.py", line 217, in default_errorhandler
    raise error_class(
    ...<10 lines>...
    )
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 2 at position 38 unexpected 'Session'.
syntax error line 2 at position 45 unexpected ':'.

2025-10-06 03:42:04 - etl.executor - INFO - Processing table: SILVER.COVERAGE with 13 mappings
2025-10-06 03:42:04 - etl.executor - INFO - Found 1 rows in XML_STAGING, 0 already processed
2025-10-06 03:42:04 - etl.executor - INFO - Using staging table: INSURANCE.ETL_MAPPER.XML_STAGING
2025-10-06 03:42:04 - etl.executor - INFO - Executing INSERT for SILVER.COVERAGE
2025-10-06 03:42:04 - etl.executor - ERROR - Insert failed for SILVER.COVERAGE: 001003 (42000): SQL compilation error:
syntax error line 2 at position 38 unexpected 'Session'.
syntax error line 2 at position 45 unexpected ':'.
2025-10-06 03:42:04 - etl.executor - ERROR - Full SQL: 
        INSERT INTO SILVER.COVERAGE (IS_MANDATORY, EXPIRATION_DATE, EFFECTIVE_DATE, COVERAGE_PREMIUM, COINSURANCE_PERCENTAGE, COVERAGE_BASIS, COVERAGE_DEDUCTIBLE, COVERAGE_LIMIT, COVERAGE_TYPE, COVERAGE_NAME, COVERAGE_CODE, RISK_ID, COVERAGE_ID)
        SELECT COALESCE(stg.xml_data::Session:Data:CoverageData:CoverageRecord:IsMandatory::STRING, '') AS IS_MANDATORY, COALESCE(stg.xml_data::Session:Data:CoverageData:CoverageRecord:CoverageEndDate::STRING, '') AS EXPIRATION_DATE, COALESCE(stg.xml_data::Session:Data:CoverageData:CoverageRecord:CoverageStartDate::STRING, '') AS EFFECTIVE_DATE, COALESCE(stg.xml_data::Session:Data:CoverageData:CoverageRecord:CoveragePremium::STRING, '') AS COVERAGE_PREMIUM, COALESCE(stg.xml_data::Session:Data:CoverageData:CoverageRecord:CoinsurancePercent::STRING, '') AS COINSURANCE_PERCENTAGE, COALESCE(stg.xml_data::Session:Data:CoverageData:CoverageRecord:CoverageBasis::STRING, '') AS COVERAGE_BASIS, COALESCE(stg.xml_data::Session:Data:CoverageData:CoverageRecord:CoverageDeductible::STRING, '') AS COVERAGE_DEDUCTIBLE, COALESCE(stg.xml_data::Session:Data:CoverageData:CoverageRecord:MaxLimit::STRING, '') AS COVERAGE_LIMIT, COALESCE(stg.xml_data::Session:Data:CoverageData:CoverageRecord:CoverageClass::STRING, '') AS COVERAGE_TYPE, COALESCE(stg.xml_data::Session:Data:CoverageData:CoverageRecord:CoverageDescription::STRING, '') AS COVERAGE_NAME, COALESCE(stg.xml_data::Session:Data:CoverageData:CoverageRecord:CoverageSymbol::STRING, '') AS COVERAGE_CODE, COALESCE(stg.xml_data::Session:Data:CoverageData:CoverageRecord:RiskIdentifier::STRING, '') AS RISK_ID, COALESCE(stg.xml_data::Session:Data:CoverageData:CoverageRecord:CoverageIdentifier::STRING, '') AS COVERAGE_ID
        FROM INSURANCE.ETL_MAPPER.XML_STAGING stg
        WHERE stg.xml_id = 'XML-20251006033330' AND stg.processed = FALSE
        
2025-10-06 03:42:04 - etl.executor - ERROR - ‚ùå Failed to process SILVER.COVERAGE: 001003 (42000): SQL compilation error:
syntax error line 2 at position 38 unexpected 'Session'.
syntax error line 2 at position 45 unexpected ':'.
2025-10-06 03:42:04 - etl.executor - ERROR - Traceback (most recent call last):
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 124, in execute_mappings
    rows_inserted = self._insert_to_silver(
        cursor, xml_id, table, table_mappings
    )
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 289, in _insert_to_silver
    cursor.execute(insert_sql)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/.venv/lib/python3.13/site-packages/snowflake/connector/cursor.py", line 1134, in execute
    Error.errorhandler_wrapper(self.connection, self, error_class, errvalue)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/.venv/lib/python3.13/site-packages/snowflake/connector/errors.py", line 286, in errorhandler_wrapper
    handed_over = Error.hand_to_other_handler(
        connection,
    ...<2 lines>...
        error_value,
    )
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/.venv/lib/python3.13/site-packages/snowflake/connector/errors.py", line 341, in hand_to_other_handler
    cursor.errorhandler(connection, cursor, error_class, error_value)
    ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/.venv/lib/python3.13/site-packages/snowflake/connector/errors.py", line 217, in default_errorhandler
    raise error_class(
    ...<10 lines>...
    )
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 2 at position 38 unexpected 'Session'.
syntax error line 2 at position 45 unexpected ':'.

2025-10-06 03:42:56 - loaders.snowflake_loader - INFO - ‚úÖ Connected to Snowflake: INSURANCE.ETL_MAPPER with role ACCOUNTADMIN
2025-10-06 03:42:59 - etl.executor - INFO - ‚úÖ Required tables ensured
2025-10-06 03:43:00 - utils.database_helper - INFO - Loaded 232 approved mappings
2025-10-06 03:43:06 - loaders.snowflake_loader - INFO - ‚úÖ Connected to Snowflake: INSURANCE.ETL_MAPPER with role ACCOUNTADMIN
2025-10-06 03:43:06 - etl.executor - INFO - ‚úÖ Required tables ensured
2025-10-06 03:43:07 - utils.database_helper - INFO - Loaded 232 approved mappings
2025-10-06 03:43:08 - etl.executor - INFO - Processing 5 tables for xml_id: XML-20251006020005
2025-10-06 03:43:08 - etl.executor - INFO - Processing table: SILVER.QUOTE with 6 mappings
2025-10-06 03:43:08 - etl.executor - ERROR - ‚ùå Failed to process SILVER.QUOTE: No staging data found for xml_id: XML-20251006020005
2025-10-06 03:43:08 - etl.executor - ERROR - Traceback (most recent call last):
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 124, in execute_mappings
    rows_inserted = self._insert_to_silver(
        cursor, xml_id, table, table_mappings
    )
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 219, in _insert_to_silver
    staging_table, has_processed_flag = self._get_staging_data_info(cursor, xml_id)
                                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 212, in _get_staging_data_info
    raise Exception(f"No staging data found for xml_id: {xml_id}")
Exception: No staging data found for xml_id: XML-20251006020005

2025-10-06 03:43:08 - etl.executor - INFO - Processing table: SILVER.POLICY with 21 mappings
2025-10-06 03:43:08 - etl.executor - ERROR - ‚ùå Failed to process SILVER.POLICY: No staging data found for xml_id: XML-20251006020005
2025-10-06 03:43:08 - etl.executor - ERROR - Traceback (most recent call last):
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 124, in execute_mappings
    rows_inserted = self._insert_to_silver(
        cursor, xml_id, table, table_mappings
    )
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 219, in _insert_to_silver
    staging_table, has_processed_flag = self._get_staging_data_info(cursor, xml_id)
                                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 212, in _get_staging_data_info
    raise Exception(f"No staging data found for xml_id: {xml_id}")
Exception: No staging data found for xml_id: XML-20251006020005

2025-10-06 03:43:09 - etl.executor - INFO - Processing table: SILVER.RISK with 11 mappings
2025-10-06 03:43:09 - etl.executor - ERROR - ‚ùå Failed to process SILVER.RISK: No staging data found for xml_id: XML-20251006020005
2025-10-06 03:43:09 - etl.executor - ERROR - Traceback (most recent call last):
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 124, in execute_mappings
    rows_inserted = self._insert_to_silver(
        cursor, xml_id, table, table_mappings
    )
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 219, in _insert_to_silver
    staging_table, has_processed_flag = self._get_staging_data_info(cursor, xml_id)
                                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 212, in _get_staging_data_info
    raise Exception(f"No staging data found for xml_id: {xml_id}")
Exception: No staging data found for xml_id: XML-20251006020005

2025-10-06 03:43:09 - etl.executor - INFO - Processing table: SILVER.COVERAGE with 13 mappings
2025-10-06 03:43:10 - etl.executor - ERROR - ‚ùå Failed to process SILVER.COVERAGE: No staging data found for xml_id: XML-20251006020005
2025-10-06 03:43:10 - etl.executor - ERROR - Traceback (most recent call last):
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 124, in execute_mappings
    rows_inserted = self._insert_to_silver(
        cursor, xml_id, table, table_mappings
    )
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 219, in _insert_to_silver
    staging_table, has_processed_flag = self._get_staging_data_info(cursor, xml_id)
                                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 212, in _get_staging_data_info
    raise Exception(f"No staging data found for xml_id: {xml_id}")
Exception: No staging data found for xml_id: XML-20251006020005

2025-10-06 03:43:10 - etl.executor - INFO - Processing table: SILVER.PAYMENT with 14 mappings
2025-10-06 03:43:10 - etl.executor - ERROR - ‚ùå Failed to process SILVER.PAYMENT: No staging data found for xml_id: XML-20251006020005
2025-10-06 03:43:10 - etl.executor - ERROR - Traceback (most recent call last):
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 124, in execute_mappings
    rows_inserted = self._insert_to_silver(
        cursor, xml_id, table, table_mappings
    )
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 219, in _insert_to_silver
    staging_table, has_processed_flag = self._get_staging_data_info(cursor, xml_id)
                                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 212, in _get_staging_data_info
    raise Exception(f"No staging data found for xml_id: {xml_id}")
Exception: No staging data found for xml_id: XML-20251006020005

2025-10-06 03:44:28 - loaders.snowflake_loader - INFO - ‚úÖ Connected to Snowflake: INSURANCE.ETL_MAPPER with role ACCOUNTADMIN
2025-10-06 03:44:30 - etl.executor - INFO - ‚úÖ Required tables ensured
2025-10-06 03:44:31 - utils.database_helper - INFO - Loaded 232 approved mappings
2025-10-06 03:44:35 - loaders.snowflake_loader - INFO - ‚úÖ Connected to Snowflake: INSURANCE.ETL_MAPPER with role ACCOUNTADMIN
2025-10-06 03:44:35 - etl.executor - INFO - ‚úÖ Required tables ensured
2025-10-06 03:44:37 - utils.database_helper - INFO - Loaded 232 approved mappings
2025-10-06 03:44:37 - etl.executor - INFO - Processing 5 tables for xml_id: XML-20251006033330
2025-10-06 03:44:37 - etl.executor - INFO - Processing table: SILVER.POLICY with 22 mappings
2025-10-06 03:44:37 - etl.executor - INFO - Found 1 rows in XML_STAGING, 0 already processed
2025-10-06 03:44:37 - etl.executor - INFO - Using staging table: INSURANCE.ETL_MAPPER.XML_STAGING
2025-10-06 03:44:37 - etl.executor - WARNING - ‚ö†Ô∏è Skipping duplicate column: EFFECTIVE_DATE
2025-10-06 03:44:37 - etl.executor - WARNING - ‚ö†Ô∏è Skipping duplicate column: POLICY_STATUS
2025-10-06 03:44:37 - etl.executor - WARNING - ‚ö†Ô∏è Skipping duplicate column: PRODUCT_CODE
2025-10-06 03:44:37 - etl.executor - WARNING - ‚ö†Ô∏è Skipping duplicate column: POLICY_TYPE
2025-10-06 03:44:37 - etl.executor - WARNING - ‚ö†Ô∏è Skipping duplicate column: POLICY_ID
2025-10-06 03:44:37 - etl.executor - INFO - Executing INSERT for SILVER.POLICY
2025-10-06 03:44:37 - etl.executor - ERROR - Insert failed for SILVER.POLICY: 001003 (42000): SQL compilation error:
syntax error line 2 at position 38 unexpected 'Session'.
syntax error line 2 at position 45 unexpected ':'.
2025-10-06 03:44:37 - etl.executor - ERROR - Full SQL: 
        INSERT INTO SILVER.POLICY (CANCELLATION_DATE, POLICY_NUMBER, EXPIRATION_DATE, EFFECTIVE_DATE, POLICY_ID, POLICY_TYPE, POLICY_STATUS, DISTRIBUTION_CHANNEL, ACCOUNT_ID, CREATED_BY, PRODUCT_CODE, PRODUCT_NAME, RENEWAL_DATE, POLICY_TERM_MONTHS, UNDERWRITING_COMPANY, PREMIUM_AMOUNT, TOTAL_INSURED_VALUE)
        SELECT COALESCE(stg.xml_data::Session:Data:PolicyData:PolicyDates:BindDate::STRING, '') AS CANCELLATION_DATE, COALESCE(stg.xml_data::Session:Data:PolicyData:Number::STRING, '') AS POLICY_NUMBER, COALESCE(stg.xml_data::Session:Data:PolicyData:PolicyDates:TerminationDate::STRING, '') AS EXPIRATION_DATE, COALESCE(stg.xml_data::Session:Data:PolicyData:PolicyDates:InceptionDate::STRING, '') AS EFFECTIVE_DATE, COALESCE(stg.xml_data::Session:TransactionInfo:TransactionID::STRING, '') AS POLICY_ID, COALESCE(stg.xml_data::Session:TransactionInfo:TransactionType::STRING, '') AS POLICY_TYPE, COALESCE(stg.xml_data::Session:TransactionInfo:TransactionStatus::STRING, '') AS POLICY_STATUS, COALESCE(stg.xml_data::Session:TransactionInfo:SourceSystem::STRING, '') AS DISTRIBUTION_CHANNEL, COALESCE(stg.xml_data::Session:Data:BrokerData:BrokerID::STRING, '') AS ACCOUNT_ID, COALESCE(stg.xml_data::Session:Data:BrokerData:BrokerName::STRING, '') AS CREATED_BY, COALESCE(stg.xml_data::Session:Data:BrokerData:BrokerType::STRING, '') AS PRODUCT_CODE, COALESCE(stg.xml_data::Session:Data:PolicyData:ProductDetails:ProdDescription::STRING, '') AS PRODUCT_NAME, COALESCE(stg.xml_data::Session:Data:PolicyData:PolicyDates:QuoteDate::STRING, '') AS RENEWAL_DATE, COALESCE(stg.xml_data::Session:Data:PolicyData:TermLength::STRING, '') AS POLICY_TERM_MONTHS, COALESCE(stg.xml_data::Session:Data:BrokerData:BrokerageFirm::STRING, '') AS UNDERWRITING_COMPANY, COALESCE(stg.xml_data::Session:Data:BrokerData:CommissionRate::STRING, '') AS PREMIUM_AMOUNT, COALESCE(stg.xml_data::Session:Data:BrokerData:CommissionAmount::STRING, '') AS TOTAL_INSURED_VALUE
        FROM INSURANCE.ETL_MAPPER.XML_STAGING stg
        WHERE stg.xml_id = 'XML-20251006033330' AND stg.processed = FALSE
        
2025-10-06 03:44:37 - etl.executor - ERROR - ‚ùå Failed to process SILVER.POLICY: 001003 (42000): SQL compilation error:
syntax error line 2 at position 38 unexpected 'Session'.
syntax error line 2 at position 45 unexpected ':'.
2025-10-06 03:44:37 - etl.executor - ERROR - Traceback (most recent call last):
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 124, in execute_mappings
    rows_inserted = self._insert_to_silver(
        cursor, xml_id, table, table_mappings
    )
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 289, in _insert_to_silver
    cursor.execute(insert_sql)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/.venv/lib/python3.13/site-packages/snowflake/connector/cursor.py", line 1134, in execute
    Error.errorhandler_wrapper(self.connection, self, error_class, errvalue)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/.venv/lib/python3.13/site-packages/snowflake/connector/errors.py", line 286, in errorhandler_wrapper
    handed_over = Error.hand_to_other_handler(
        connection,
    ...<2 lines>...
        error_value,
    )
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/.venv/lib/python3.13/site-packages/snowflake/connector/errors.py", line 341, in hand_to_other_handler
    cursor.errorhandler(connection, cursor, error_class, error_value)
    ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/.venv/lib/python3.13/site-packages/snowflake/connector/errors.py", line 217, in default_errorhandler
    raise error_class(
    ...<10 lines>...
    )
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 2 at position 38 unexpected 'Session'.
syntax error line 2 at position 45 unexpected ':'.

2025-10-06 03:44:38 - etl.executor - INFO - Processing table: SILVER.PAYMENT with 14 mappings
2025-10-06 03:44:38 - etl.executor - INFO - Found 1 rows in XML_STAGING, 0 already processed
2025-10-06 03:44:38 - etl.executor - INFO - Using staging table: INSURANCE.ETL_MAPPER.XML_STAGING
2025-10-06 03:44:38 - etl.executor - INFO - Executing INSERT for SILVER.PAYMENT
2025-10-06 03:44:38 - etl.executor - ERROR - Insert failed for SILVER.PAYMENT: 001003 (42000): SQL compilation error:
syntax error line 2 at position 38 unexpected 'Session'.
syntax error line 2 at position 45 unexpected ':'.
2025-10-06 03:44:38 - etl.executor - ERROR - Full SQL: 
        INSERT INTO SILVER.PAYMENT (PAYMENT_ID, PAYMENT_NUMBER, PAYMENT_TYPE, PAYMENT_METHOD, PAYMENT_STATUS, PAYMENT_DATE, PAYMENT_AMOUNT, PAYMENT_TERM, TOTAL_INSTALLMENTS, ACCOUNT_HOLDER_NAME, BANK_NAME, ACCOUNT_NUMBER, ROUTING_NUMBER, CARD_TYPE)
        SELECT COALESCE(stg.xml_data::Session:Data:PaymentData:PaymentIdentifier::STRING, '') AS PAYMENT_ID, COALESCE(stg.xml_data::Session:Data:PaymentData:PaymentNumber::STRING, '') AS PAYMENT_NUMBER, COALESCE(stg.xml_data::Session:Data:PaymentData:TransactionType::STRING, '') AS PAYMENT_TYPE, COALESCE(stg.xml_data::Session:Data:PaymentData:PaymentMode::STRING, '') AS PAYMENT_METHOD, COALESCE(stg.xml_data::Session:Data:PaymentData:StatusDescription::STRING, '') AS PAYMENT_STATUS, COALESCE(stg.xml_data::Session:Data:PaymentData:ScheduledDate::STRING, '') AS PAYMENT_DATE, COALESCE(stg.xml_data::Session:Data:PaymentData:TransactionAmount::STRING, '') AS PAYMENT_AMOUNT, COALESCE(stg.xml_data::Session:Data:PaymentData:BillingPlan::STRING, '') AS PAYMENT_TERM, COALESCE(stg.xml_data::Session:Data:PaymentData:TotalInstallments::STRING, '') AS TOTAL_INSTALLMENTS, COALESCE(stg.xml_data::Session:Data:PaymentData:PaymentAccountInfo:NameOnAccount::STRING, '') AS ACCOUNT_HOLDER_NAME, COALESCE(stg.xml_data::Session:Data:PaymentData:PaymentAccountInfo:FinancialInstitution::STRING, '') AS BANK_NAME, COALESCE(stg.xml_data::Session:Data:PaymentData:PaymentAccountInfo:AccountNumber::STRING, '') AS ACCOUNT_NUMBER, COALESCE(stg.xml_data::Session:Data:PaymentData:PaymentAccountInfo:RoutingNumber::STRING, '') AS ROUTING_NUMBER, COALESCE(stg.xml_data::Session:Data:PaymentData:PaymentAccountInfo:AccountType::STRING, '') AS CARD_TYPE
        FROM INSURANCE.ETL_MAPPER.XML_STAGING stg
        WHERE stg.xml_id = 'XML-20251006033330' AND stg.processed = FALSE
        
2025-10-06 03:44:38 - etl.executor - ERROR - ‚ùå Failed to process SILVER.PAYMENT: 001003 (42000): SQL compilation error:
syntax error line 2 at position 38 unexpected 'Session'.
syntax error line 2 at position 45 unexpected ':'.
2025-10-06 03:44:38 - etl.executor - ERROR - Traceback (most recent call last):
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 124, in execute_mappings
    rows_inserted = self._insert_to_silver(
        cursor, xml_id, table, table_mappings
    )
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 289, in _insert_to_silver
    cursor.execute(insert_sql)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/.venv/lib/python3.13/site-packages/snowflake/connector/cursor.py", line 1134, in execute
    Error.errorhandler_wrapper(self.connection, self, error_class, errvalue)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/.venv/lib/python3.13/site-packages/snowflake/connector/errors.py", line 286, in errorhandler_wrapper
    handed_over = Error.hand_to_other_handler(
        connection,
    ...<2 lines>...
        error_value,
    )
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/.venv/lib/python3.13/site-packages/snowflake/connector/errors.py", line 341, in hand_to_other_handler
    cursor.errorhandler(connection, cursor, error_class, error_value)
    ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/.venv/lib/python3.13/site-packages/snowflake/connector/errors.py", line 217, in default_errorhandler
    raise error_class(
    ...<10 lines>...
    )
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 2 at position 38 unexpected 'Session'.
syntax error line 2 at position 45 unexpected ':'.

2025-10-06 03:44:38 - etl.executor - INFO - Processing table: SILVER.RISK with 11 mappings
2025-10-06 03:44:39 - etl.executor - INFO - Found 1 rows in XML_STAGING, 0 already processed
2025-10-06 03:44:39 - etl.executor - INFO - Using staging table: INSURANCE.ETL_MAPPER.XML_STAGING
2025-10-06 03:44:39 - etl.executor - WARNING - ‚ö†Ô∏è Skipping duplicate column: RISK_NUMBER
2025-10-06 03:44:39 - etl.executor - INFO - Executing INSERT for SILVER.RISK
2025-10-06 03:44:39 - etl.executor - ERROR - Insert failed for SILVER.RISK: 001003 (42000): SQL compilation error:
syntax error line 2 at position 38 unexpected 'Session'.
syntax error line 2 at position 45 unexpected ':'.
2025-10-06 03:44:39 - etl.executor - ERROR - Full SQL: 
        INSERT INTO SILVER.RISK (RISK_STATE, RISK_CITY, RISK_ADDRESS_LINE2, RISK_ADDRESS_LINE1, RISK_NUMBER, RISK_DESCRIPTION, RISK_TYPE, RISK_ID, RISK_ZIP, RISK_COUNTRY)
        SELECT COALESCE(stg.xml_data::Session:Data:RiskData:LocationDetails:State::STRING, '') AS RISK_STATE, COALESCE(stg.xml_data::Session:Data:RiskData:LocationDetails:City::STRING, '') AS RISK_CITY, COALESCE(stg.xml_data::Session:Data:RiskData:LocationDetails:AddressLine2::STRING, '') AS RISK_ADDRESS_LINE2, COALESCE(stg.xml_data::Session:Data:RiskData:LocationDetails:AddressLine1::STRING, '') AS RISK_ADDRESS_LINE1, COALESCE(stg.xml_data::Session:Data:RiskData:LocationDetails:LocationNumber::STRING, '') AS RISK_NUMBER, COALESCE(stg.xml_data::Session:Data:RiskData:RiskSummary::STRING, '') AS RISK_DESCRIPTION, COALESCE(stg.xml_data::Session:Data:RiskData:RiskClass::STRING, '') AS RISK_TYPE, COALESCE(stg.xml_data::Session:Data:RiskData:RiskIdentifier::STRING, '') AS RISK_ID, COALESCE(stg.xml_data::Session:Data:RiskData:LocationDetails:ZipCode::STRING, '') AS RISK_ZIP, COALESCE(stg.xml_data::Session:Data:RiskData:LocationDetails:Country::STRING, '') AS RISK_COUNTRY
        FROM INSURANCE.ETL_MAPPER.XML_STAGING stg
        WHERE stg.xml_id = 'XML-20251006033330' AND stg.processed = FALSE
        
2025-10-06 03:44:39 - etl.executor - ERROR - ‚ùå Failed to process SILVER.RISK: 001003 (42000): SQL compilation error:
syntax error line 2 at position 38 unexpected 'Session'.
syntax error line 2 at position 45 unexpected ':'.
2025-10-06 03:44:39 - etl.executor - ERROR - Traceback (most recent call last):
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 124, in execute_mappings
    rows_inserted = self._insert_to_silver(
        cursor, xml_id, table, table_mappings
    )
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 289, in _insert_to_silver
    cursor.execute(insert_sql)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/.venv/lib/python3.13/site-packages/snowflake/connector/cursor.py", line 1134, in execute
    Error.errorhandler_wrapper(self.connection, self, error_class, errvalue)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/.venv/lib/python3.13/site-packages/snowflake/connector/errors.py", line 286, in errorhandler_wrapper
    handed_over = Error.hand_to_other_handler(
        connection,
    ...<2 lines>...
        error_value,
    )
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/.venv/lib/python3.13/site-packages/snowflake/connector/errors.py", line 341, in hand_to_other_handler
    cursor.errorhandler(connection, cursor, error_class, error_value)
    ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/.venv/lib/python3.13/site-packages/snowflake/connector/errors.py", line 217, in default_errorhandler
    raise error_class(
    ...<10 lines>...
    )
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 2 at position 38 unexpected 'Session'.
syntax error line 2 at position 45 unexpected ':'.

2025-10-06 03:44:39 - etl.executor - INFO - Processing table: SILVER.QUOTE with 6 mappings
2025-10-06 03:44:39 - etl.executor - INFO - Found 1 rows in XML_STAGING, 0 already processed
2025-10-06 03:44:39 - etl.executor - INFO - Using staging table: INSURANCE.ETL_MAPPER.XML_STAGING
2025-10-06 03:44:39 - etl.executor - INFO - Executing INSERT for SILVER.QUOTE
2025-10-06 03:44:39 - etl.executor - ERROR - Insert failed for SILVER.QUOTE: 001003 (42000): SQL compilation error:
syntax error line 2 at position 38 unexpected 'Session'.
syntax error line 2 at position 45 unexpected ':'.
2025-10-06 03:44:39 - etl.executor - ERROR - Full SQL: 
        INSERT INTO SILVER.QUOTE (EFFECTIVE_DATE, EXPIRY_DATE, QUOTE_DATE, QUOTE_STATUS, QUOTE_ID, QUOTE_NUMBER)
        SELECT COALESCE(stg.xml_data::Session:Data:QuoteData:ConversionDate::STRING, '') AS EFFECTIVE_DATE, COALESCE(stg.xml_data::Session:Data:QuoteData:QuoteExpiryDate::STRING, '') AS EXPIRY_DATE, COALESCE(stg.xml_data::Session:Data:QuoteData:QuoteDate::STRING, '') AS QUOTE_DATE, COALESCE(stg.xml_data::Session:Data:QuoteData:QuoteStatus::STRING, '') AS QUOTE_STATUS, COALESCE(stg.xml_data::Session:Data:QuoteData:QuoteIdentifier::STRING, '') AS QUOTE_ID, COALESCE(stg.xml_data::Session:Data:QuoteData:QuoteNumber::STRING, '') AS QUOTE_NUMBER
        FROM INSURANCE.ETL_MAPPER.XML_STAGING stg
        WHERE stg.xml_id = 'XML-20251006033330' AND stg.processed = FALSE
        
2025-10-06 03:44:39 - etl.executor - ERROR - ‚ùå Failed to process SILVER.QUOTE: 001003 (42000): SQL compilation error:
syntax error line 2 at position 38 unexpected 'Session'.
syntax error line 2 at position 45 unexpected ':'.
2025-10-06 03:44:39 - etl.executor - ERROR - Traceback (most recent call last):
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 124, in execute_mappings
    rows_inserted = self._insert_to_silver(
        cursor, xml_id, table, table_mappings
    )
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 289, in _insert_to_silver
    cursor.execute(insert_sql)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/.venv/lib/python3.13/site-packages/snowflake/connector/cursor.py", line 1134, in execute
    Error.errorhandler_wrapper(self.connection, self, error_class, errvalue)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/.venv/lib/python3.13/site-packages/snowflake/connector/errors.py", line 286, in errorhandler_wrapper
    handed_over = Error.hand_to_other_handler(
        connection,
    ...<2 lines>...
        error_value,
    )
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/.venv/lib/python3.13/site-packages/snowflake/connector/errors.py", line 341, in hand_to_other_handler
    cursor.errorhandler(connection, cursor, error_class, error_value)
    ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/.venv/lib/python3.13/site-packages/snowflake/connector/errors.py", line 217, in default_errorhandler
    raise error_class(
    ...<10 lines>...
    )
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 2 at position 38 unexpected 'Session'.
syntax error line 2 at position 45 unexpected ':'.

2025-10-06 03:44:40 - etl.executor - INFO - Processing table: SILVER.COVERAGE with 13 mappings
2025-10-06 03:44:40 - etl.executor - INFO - Found 1 rows in XML_STAGING, 0 already processed
2025-10-06 03:44:40 - etl.executor - INFO - Using staging table: INSURANCE.ETL_MAPPER.XML_STAGING
2025-10-06 03:44:40 - etl.executor - INFO - Executing INSERT for SILVER.COVERAGE
2025-10-06 03:44:40 - etl.executor - ERROR - Insert failed for SILVER.COVERAGE: 001003 (42000): SQL compilation error:
syntax error line 2 at position 38 unexpected 'Session'.
syntax error line 2 at position 45 unexpected ':'.
2025-10-06 03:44:40 - etl.executor - ERROR - Full SQL: 
        INSERT INTO SILVER.COVERAGE (IS_MANDATORY, EXPIRATION_DATE, EFFECTIVE_DATE, COVERAGE_PREMIUM, COINSURANCE_PERCENTAGE, COVERAGE_BASIS, COVERAGE_DEDUCTIBLE, COVERAGE_LIMIT, COVERAGE_TYPE, COVERAGE_NAME, COVERAGE_CODE, RISK_ID, COVERAGE_ID)
        SELECT COALESCE(stg.xml_data::Session:Data:CoverageData:CoverageRecord:IsMandatory::STRING, '') AS IS_MANDATORY, COALESCE(stg.xml_data::Session:Data:CoverageData:CoverageRecord:CoverageEndDate::STRING, '') AS EXPIRATION_DATE, COALESCE(stg.xml_data::Session:Data:CoverageData:CoverageRecord:CoverageStartDate::STRING, '') AS EFFECTIVE_DATE, COALESCE(stg.xml_data::Session:Data:CoverageData:CoverageRecord:CoveragePremium::STRING, '') AS COVERAGE_PREMIUM, COALESCE(stg.xml_data::Session:Data:CoverageData:CoverageRecord:CoinsurancePercent::STRING, '') AS COINSURANCE_PERCENTAGE, COALESCE(stg.xml_data::Session:Data:CoverageData:CoverageRecord:CoverageBasis::STRING, '') AS COVERAGE_BASIS, COALESCE(stg.xml_data::Session:Data:CoverageData:CoverageRecord:CoverageDeductible::STRING, '') AS COVERAGE_DEDUCTIBLE, COALESCE(stg.xml_data::Session:Data:CoverageData:CoverageRecord:MaxLimit::STRING, '') AS COVERAGE_LIMIT, COALESCE(stg.xml_data::Session:Data:CoverageData:CoverageRecord:CoverageClass::STRING, '') AS COVERAGE_TYPE, COALESCE(stg.xml_data::Session:Data:CoverageData:CoverageRecord:CoverageDescription::STRING, '') AS COVERAGE_NAME, COALESCE(stg.xml_data::Session:Data:CoverageData:CoverageRecord:CoverageSymbol::STRING, '') AS COVERAGE_CODE, COALESCE(stg.xml_data::Session:Data:CoverageData:CoverageRecord:RiskIdentifier::STRING, '') AS RISK_ID, COALESCE(stg.xml_data::Session:Data:CoverageData:CoverageRecord:CoverageIdentifier::STRING, '') AS COVERAGE_ID
        FROM INSURANCE.ETL_MAPPER.XML_STAGING stg
        WHERE stg.xml_id = 'XML-20251006033330' AND stg.processed = FALSE
        
2025-10-06 03:44:40 - etl.executor - ERROR - ‚ùå Failed to process SILVER.COVERAGE: 001003 (42000): SQL compilation error:
syntax error line 2 at position 38 unexpected 'Session'.
syntax error line 2 at position 45 unexpected ':'.
2025-10-06 03:44:40 - etl.executor - ERROR - Traceback (most recent call last):
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 124, in execute_mappings
    rows_inserted = self._insert_to_silver(
        cursor, xml_id, table, table_mappings
    )
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 289, in _insert_to_silver
    cursor.execute(insert_sql)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/.venv/lib/python3.13/site-packages/snowflake/connector/cursor.py", line 1134, in execute
    Error.errorhandler_wrapper(self.connection, self, error_class, errvalue)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/.venv/lib/python3.13/site-packages/snowflake/connector/errors.py", line 286, in errorhandler_wrapper
    handed_over = Error.hand_to_other_handler(
        connection,
    ...<2 lines>...
        error_value,
    )
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/.venv/lib/python3.13/site-packages/snowflake/connector/errors.py", line 341, in hand_to_other_handler
    cursor.errorhandler(connection, cursor, error_class, error_value)
    ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/.venv/lib/python3.13/site-packages/snowflake/connector/errors.py", line 217, in default_errorhandler
    raise error_class(
    ...<10 lines>...
    )
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 2 at position 38 unexpected 'Session'.
syntax error line 2 at position 45 unexpected ':'.

2025-10-06 03:46:15 - utils.logging_config - INFO - Logging configured at INFO level
2025-10-06 03:46:15 - etl.executor - INFO - ETL Executor initialized. Log file: logs/etl_executor_20251006.log
2025-10-06 03:46:18 - loaders.snowflake_loader - INFO - ‚úÖ Connected to Snowflake: INSURANCE.ETL_MAPPER with role ACCOUNTADMIN
2025-10-06 03:46:21 - etl.executor - INFO - ‚úÖ Required tables ensured
2025-10-06 03:46:22 - utils.database_helper - INFO - Loaded 232 approved mappings
2025-10-06 03:46:28 - loaders.snowflake_loader - INFO - ‚úÖ Connected to Snowflake: INSURANCE.ETL_MAPPER with role ACCOUNTADMIN
2025-10-06 03:46:29 - etl.executor - INFO - ‚úÖ Required tables ensured
2025-10-06 03:46:30 - utils.database_helper - INFO - Loaded 232 approved mappings
2025-10-06 03:46:37 - loaders.snowflake_loader - INFO - ‚úÖ Connected to Snowflake: INSURANCE.ETL_MAPPER with role ACCOUNTADMIN
2025-10-06 03:46:38 - etl.executor - INFO - ‚úÖ Required tables ensured
2025-10-06 03:46:38 - utils.decorators - INFO - Starting run...
2025-10-06 03:46:38 - main - INFO - üîç Auto-detecting product type...
2025-10-06 03:46:38 - utils.product_detector - INFO - ‚úÖ Detected product: HO003 with 67.3% confidence
2025-10-06 03:46:38 - main - INFO - ‚úÖ Detected: HO003 with 67.3% confidence
2025-10-06 03:46:38 - main - INFO - üìä Extracting XML metadata...
2025-10-06 03:46:38 - main - INFO - ‚úÖ Extracted 319 XML nodes
2025-10-06 03:46:38 - main - INFO - ‚òÅÔ∏è Loading to Snowflake stage layer...
2025-10-06 03:46:38 - loaders.snowflake_loader - INFO - ‚úÖ Loaded XML data to ETL_MAPPER.STAGE_XML_HO003
2025-10-06 03:46:38 - main - INFO - ‚úÖ Loaded to ETL_MAPPER.STAGE_XML_HO003
2025-10-06 03:46:38 - main - INFO - üóÑÔ∏è Fetching Silver layer schema from Snowflake...
2025-10-06 03:46:38 - utils.schema_manager - INFO - Fetching schema from INSURANCE.SILVER
2025-10-06 03:46:39 - utils.schema_manager - INFO - ‚úÖ Fetched 137 columns from 7 tables
2025-10-06 03:46:39 - main - INFO - ‚úÖ Fetched 137 columns from 7 tables
2025-10-06 03:46:39 - main - INFO - üìö Finding and loading reference data with AI...
2025-10-06 03:46:39 - utils.document_loader - INFO - üîç Found 9 potential reference files
2025-10-06 03:46:41 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 03:46:41 - utils.document_loader - INFO - üìÑ historical_mappings_personal_auto.xlsx: historical_mapping (relevance: 85%)
2025-10-06 03:46:44 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 03:46:44 - utils.document_loader - INFO - üìÑ historical_mappings_commercial.xlsx: historical_mapping (relevance: 85%)
2025-10-06 03:46:46 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 03:46:46 - utils.document_loader - INFO - üìÑ old_mappings.csv: historical_mapping (relevance: 85%)
2025-10-06 03:46:48 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 03:46:48 - utils.document_loader - INFO - üìÑ historical_mappings_homeowners.xlsx: historical_mapping (relevance: 85%)
2025-10-06 03:46:50 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 03:46:50 - utils.document_loader - INFO - üìÑ old_mappings_homeowners.csv: historical_mapping (relevance: 85%)
2025-10-06 03:46:52 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 03:46:52 - utils.document_loader - INFO - üìÑ old_mappings_personal_auto.csv: historical_mapping (relevance: 85%)
2025-10-06 03:46:54 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 03:46:54 - utils.document_loader - INFO - üìÑ old_mappings_commercial.csv: historical_mapping (relevance: 85%)
2025-10-06 03:46:55 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 03:46:55 - utils.document_loader - INFO - üìÑ data_dictionary.csv: data_dictionary (relevance: 90%)
2025-10-06 03:46:57 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 03:46:57 - utils.document_loader - INFO - üìÑ data_dictionary_complete.xlsx: data_dictionary (relevance: 85%)
2025-10-06 03:46:57 - utils.document_loader - INFO - Loading file: reference_data/data_dictionary.csv (type: .csv)
2025-10-06 03:46:58 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 03:46:58 - utils.document_loader - ERROR - Error loading reference_data/data_dictionary.csv: name 'true' is not defined
2025-10-06 03:46:58 - utils.document_loader - INFO - Loading file: reference_data/historical_mappings_personal_auto.xlsx (type: .xlsx)
2025-10-06 03:46:58 - utils.document_loader - INFO - Found 2 sheets: ['Mappings', 'Metadata']
2025-10-06 03:47:01 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 03:47:01 - utils.document_loader - INFO - AI understands this as: historical_mappings
2025-10-06 03:47:01 - utils.document_loader - INFO - Loading file: reference_data/historical_mappings_commercial.xlsx (type: .xlsx)
2025-10-06 03:47:01 - utils.document_loader - INFO - Found 1 sheets: ['Mappings']
2025-10-06 03:47:03 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 03:47:03 - utils.document_loader - INFO - AI understands this as: historical_mappings
2025-10-06 03:47:03 - utils.document_loader - INFO - Loading file: reference_data/old_mappings.csv (type: .csv)
2025-10-06 03:47:06 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 03:47:06 - utils.document_loader - ERROR - Error loading reference_data/old_mappings.csv: name 'true' is not defined
2025-10-06 03:47:06 - utils.document_loader - INFO - Loading file: reference_data/historical_mappings_homeowners.xlsx (type: .xlsx)
2025-10-06 03:47:06 - utils.document_loader - INFO - Found 1 sheets: ['Mappings']
2025-10-06 03:47:08 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 03:47:08 - utils.document_loader - INFO - AI understands this as: historical_mappings
2025-10-06 03:47:08 - utils.document_loader - INFO - Loading file: reference_data/data_dictionary_complete.xlsx (type: .xlsx)
2025-10-06 03:47:08 - utils.document_loader - INFO - Found 3 sheets: ['DataDictionary', 'TableSummary', 'Metadata']
2025-10-06 03:47:10 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 03:47:10 - utils.document_loader - INFO - AI understands this as: data_dictionary
2025-10-06 03:47:10 - utils.document_loader - INFO - 
============================================================
2025-10-06 03:47:10 - utils.document_loader - INFO - ‚úÖ LOADED REFERENCE DATA SUMMARY:
2025-10-06 03:47:10 - utils.document_loader - INFO - ============================================================
2025-10-06 03:47:10 - utils.document_loader - INFO -   üìö Historical mappings: 3 files
2025-10-06 03:47:10 - utils.document_loader - INFO -      - historical_mappings_personal_auto.xlsx (51 rows)
2025-10-06 03:47:10 - utils.document_loader - INFO -      - historical_mappings_commercial.xlsx (9 rows)
2025-10-06 03:47:10 - utils.document_loader - INFO -      - historical_mappings_homeowners.xlsx (14 rows)
2025-10-06 03:47:10 - utils.document_loader - INFO -   üìñ Data dictionaries: 1 files
2025-10-06 03:47:10 - utils.document_loader - INFO -      - data_dictionary_complete.xlsx (104 rows)
2025-10-06 03:47:10 - utils.document_loader - INFO -   üóÑÔ∏è Schema definitions: 0 files
2025-10-06 03:47:10 - utils.document_loader - INFO -   üìä Reference data: 0 files
2025-10-06 03:47:10 - utils.document_loader - INFO - ============================================================

2025-10-06 03:47:10 - main - INFO - ü§ñ Predicting mappings with AI (flexible mode)...
2025-10-06 03:47:34 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 03:47:55 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 03:48:20 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 03:48:46 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 03:49:20 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 03:49:51 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 03:50:23 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-06 03:50:23 - main - INFO - üíæ Saving results...
2025-10-06 03:50:23 - main - INFO - ‚úÖ Saved 101 mappings to output/mappings_HO003_20251006_035023.csv
2025-10-06 03:50:23 - main - INFO - ‚úÖ Pipeline completed successfully!
2025-10-06 03:50:23 - utils.decorators - INFO - run completed in 225.18s
2025-10-06 03:50:28 - utils.database_helper - INFO - ‚úÖ Loaded 1 row(s) of XML into staging for XML-20251006035025
2025-10-06 03:50:28 - utils.database_helper - INFO - ‚úÖ XML metadata saved for XML-20251006035025
2025-10-06 03:51:16 - utils.database_helper - INFO - ‚úÖ Saved 101 mappings
2025-10-06 03:51:18 - utils.database_helper - INFO - Loaded 232 approved mappings
2025-10-06 03:51:33 - loaders.snowflake_loader - INFO - ‚úÖ Connected to Snowflake: INSURANCE.ETL_MAPPER with role ACCOUNTADMIN
2025-10-06 03:51:34 - etl.executor - INFO - ‚úÖ Required tables ensured
2025-10-06 03:52:08 - loaders.snowflake_loader - INFO - ‚úÖ Connected to Snowflake: INSURANCE.ETL_MAPPER with role ACCOUNTADMIN
2025-10-06 03:52:10 - etl.executor - INFO - ‚úÖ Required tables ensured
2025-10-06 03:53:01 - loaders.snowflake_loader - INFO - ‚úÖ Connected to Snowflake: INSURANCE.ETL_MAPPER with role ACCOUNTADMIN
2025-10-06 03:53:03 - etl.executor - INFO - ‚úÖ Required tables ensured
2025-10-06 03:53:05 - utils.database_helper - INFO - Loaded 333 approved mappings
2025-10-06 03:53:38 - loaders.snowflake_loader - INFO - ‚úÖ Connected to Snowflake: INSURANCE.ETL_MAPPER with role ACCOUNTADMIN
2025-10-06 03:53:40 - etl.executor - INFO - ‚úÖ Required tables ensured
2025-10-06 03:53:41 - utils.database_helper - INFO - Loaded 333 approved mappings
2025-10-06 03:54:28 - loaders.snowflake_loader - INFO - ‚úÖ Connected to Snowflake: INSURANCE.ETL_MAPPER with role ACCOUNTADMIN
2025-10-06 03:54:31 - etl.executor - INFO - ‚úÖ Required tables ensured
2025-10-06 03:54:31 - utils.database_helper - INFO - Loaded 333 approved mappings
2025-10-06 03:54:32 - etl.executor - INFO - Processing 5 tables for xml_id: XML-20251006035025
2025-10-06 03:54:32 - etl.executor - INFO - Processing table: SILVER.POLICY with 40 mappings
2025-10-06 03:54:32 - etl.executor - INFO - Found 1 rows in XML_STAGING, 0 already processed
2025-10-06 03:54:32 - etl.executor - INFO - Using staging table: INSURANCE.ETL_MAPPER.XML_STAGING
2025-10-06 03:54:32 - etl.executor - WARNING - ‚ö†Ô∏è Skipping duplicate column: POLICY_ID
2025-10-06 03:54:32 - etl.executor - WARNING - ‚ö†Ô∏è Skipping duplicate column: POLICY_TYPE
2025-10-06 03:54:32 - etl.executor - WARNING - ‚ö†Ô∏è Skipping duplicate column: EFFECTIVE_DATE
2025-10-06 03:54:32 - etl.executor - WARNING - ‚ö†Ô∏è Skipping duplicate column: POLICY_STATUS
2025-10-06 03:54:32 - etl.executor - WARNING - ‚ö†Ô∏è Skipping duplicate column: CREATED_BY
2025-10-06 03:54:32 - etl.executor - WARNING - ‚ö†Ô∏è Skipping duplicate column: POLICY_STATUS
2025-10-06 03:54:32 - etl.executor - WARNING - ‚ö†Ô∏è Skipping duplicate column: POLICY_ID
2025-10-06 03:54:32 - etl.executor - WARNING - ‚ö†Ô∏è Skipping duplicate column: POLICY_NUMBER
2025-10-06 03:54:32 - etl.executor - WARNING - ‚ö†Ô∏è Skipping duplicate column: POLICY_TYPE
2025-10-06 03:54:32 - etl.executor - WARNING - ‚ö†Ô∏è Skipping duplicate column: PRODUCT_CODE
2025-10-06 03:54:32 - etl.executor - WARNING - ‚ö†Ô∏è Skipping duplicate column: PRODUCT_NAME
2025-10-06 03:54:32 - etl.executor - WARNING - ‚ö†Ô∏è Skipping duplicate column: EFFECTIVE_DATE
2025-10-06 03:54:32 - etl.executor - WARNING - ‚ö†Ô∏è Skipping duplicate column: EXPIRATION_DATE
2025-10-06 03:54:32 - etl.executor - WARNING - ‚ö†Ô∏è Skipping duplicate column: POLICY_TERM_MONTHS
2025-10-06 03:54:32 - etl.executor - WARNING - ‚ö†Ô∏è Skipping duplicate column: PREMIUM_AMOUNT
2025-10-06 03:54:32 - etl.executor - WARNING - ‚ö†Ô∏è Skipping duplicate column: TOTAL_INSURED_VALUE
2025-10-06 03:54:32 - etl.executor - WARNING - ‚ö†Ô∏è Skipping duplicate column: UNDERWRITING_COMPANY
2025-10-06 03:54:32 - etl.executor - WARNING - ‚ö†Ô∏è Skipping duplicate column: DISTRIBUTION_CHANNEL
2025-10-06 03:54:32 - etl.executor - WARNING - ‚ö†Ô∏è Skipping duplicate column: RENEWAL_DATE
2025-10-06 03:54:32 - etl.executor - WARNING - ‚ö†Ô∏è Skipping duplicate column: ACCOUNT_ID
2025-10-06 03:54:32 - etl.executor - INFO - Executing INSERT for SILVER.POLICY
2025-10-06 03:54:33 - etl.executor - ERROR - Insert failed for SILVER.POLICY: 001003 (42000): SQL compilation error:
syntax error line 2 at position 38 unexpected 'Session'.
syntax error line 2 at position 45 unexpected ':'.
2025-10-06 03:54:33 - etl.executor - ERROR - Full SQL: 
        INSERT INTO SILVER.POLICY (POLICY_ID, POLICY_TYPE, POLICY_NUMBER, TOTAL_INSURED_VALUE, PREMIUM_AMOUNT, ACCOUNT_ID, CREATED_BY, DISTRIBUTION_CHANNEL, POLICY_STATUS, EFFECTIVE_DATE, PRODUCT_NAME, PRODUCT_CODE, POLICY_TERM_MONTHS, UNDERWRITING_COMPANY, EXPIRATION_DATE, CREATED_DATE, MODIFIED_DATE, RENEWAL_DATE, QUOTE_ID, CANCELLATION_DATE)
        SELECT COALESCE(stg.xml_data::Session:TransactionInfo:TransactionID::STRING, '') AS POLICY_ID, COALESCE(stg.xml_data::Session:Data:Policy:PolicyType::STRING, '') AS POLICY_TYPE, COALESCE(stg.xml_data::Session:Data:Policy:PolicyNumber::STRING, '') AS POLICY_NUMBER, COALESCE(stg.xml_data::Session:Data:Agent:CommissionAmount::STRING, '') AS TOTAL_INSURED_VALUE, COALESCE(stg.xml_data::Session:Data:Agent:CommissionRate::STRING, '') AS PREMIUM_AMOUNT, COALESCE(stg.xml_data::Session:Data:Agent:AgentCode::STRING, '') AS ACCOUNT_ID, COALESCE(stg.xml_data::Session:TransactionInfo:ProcessedBy::STRING, '') AS CREATED_BY, COALESCE(stg.xml_data::Session:TransactionInfo:SourceSystem::STRING, '') AS DISTRIBUTION_CHANNEL, COALESCE(stg.xml_data::Session:TransactionInfo:TransactionStatus::STRING, '') AS POLICY_STATUS, COALESCE(stg.xml_data::Session:TransactionInfo:TransactionDate::STRING, '') AS EFFECTIVE_DATE, COALESCE(stg.xml_data::Session:Data:Policy:Product:ProductName::STRING, '') AS PRODUCT_NAME, COALESCE(stg.xml_data::Session:Data:Policy:Product:ProductCode::STRING, '') AS PRODUCT_CODE, COALESCE(stg.xml_data::Session:Data:Policy:PolicyTerm::STRING, '') AS POLICY_TERM_MONTHS, COALESCE(stg.xml_data::Session:Data:Agent:AgentName::STRING, '') AS UNDERWRITING_COMPANY, COALESCE(stg.xml_data::Session:Data:Policy:Dates:ExpirationDate::STRING, '') AS EXPIRATION_DATE, COALESCE(stg.xml_data::Session:Data:PolicyAdmin:CreatedDate::STRING, '') AS CREATED_DATE, COALESCE(stg.xml_data::Session:Data:PolicyAdmin:ModifiedBy::STRING, '') AS MODIFIED_DATE, COALESCE(stg.xml_data::Session:Data:PolicyAdmin::STRING, '') AS RENEWAL_DATE, COALESCE(stg.xml_data::Session:Data:PolicyAdmin::STRING, '') AS QUOTE_ID, COALESCE(stg.xml_data::Session:Data:PolicyAdmin::STRING, '') AS CANCELLATION_DATE
        FROM INSURANCE.ETL_MAPPER.XML_STAGING stg
        WHERE stg.xml_id = 'XML-20251006035025' AND stg.processed = FALSE
        
2025-10-06 03:54:33 - etl.executor - ERROR - ‚ùå Failed to process SILVER.POLICY: 001003 (42000): SQL compilation error:
syntax error line 2 at position 38 unexpected 'Session'.
syntax error line 2 at position 45 unexpected ':'.
2025-10-06 03:54:33 - etl.executor - ERROR - Traceback (most recent call last):
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 124, in execute_mappings
    rows_inserted = self._insert_to_silver(
        cursor, xml_id, table, table_mappings
    )
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 289, in _insert_to_silver
    cursor.execute(insert_sql)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/.venv/lib/python3.13/site-packages/snowflake/connector/cursor.py", line 1134, in execute
    Error.errorhandler_wrapper(self.connection, self, error_class, errvalue)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/.venv/lib/python3.13/site-packages/snowflake/connector/errors.py", line 286, in errorhandler_wrapper
    handed_over = Error.hand_to_other_handler(
        connection,
    ...<2 lines>...
        error_value,
    )
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/.venv/lib/python3.13/site-packages/snowflake/connector/errors.py", line 341, in hand_to_other_handler
    cursor.errorhandler(connection, cursor, error_class, error_value)
    ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/.venv/lib/python3.13/site-packages/snowflake/connector/errors.py", line 217, in default_errorhandler
    raise error_class(
    ...<10 lines>...
    )
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 2 at position 38 unexpected 'Session'.
syntax error line 2 at position 45 unexpected ':'.

2025-10-06 03:54:33 - etl.executor - INFO - Processing table: SILVER.QUOTE with 20 mappings
2025-10-06 03:54:33 - etl.executor - INFO - Found 1 rows in XML_STAGING, 0 already processed
2025-10-06 03:54:33 - etl.executor - INFO - Using staging table: INSURANCE.ETL_MAPPER.XML_STAGING
2025-10-06 03:54:33 - etl.executor - ERROR - ‚ùå Failed to process SILVER.QUOTE: 'NoneType' object has no attribute 'split'
2025-10-06 03:54:33 - etl.executor - ERROR - Traceback (most recent call last):
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 124, in execute_mappings
    rows_inserted = self._insert_to_silver(
        cursor, xml_id, table, table_mappings
    )
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 257, in _insert_to_silver
    path_parts = source_node.split('/')
                 ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'split'

2025-10-06 03:54:34 - etl.executor - INFO - Processing table: SILVER.COVERAGE with 14 mappings
2025-10-06 03:54:34 - etl.executor - INFO - Found 1 rows in XML_STAGING, 0 already processed
2025-10-06 03:54:34 - etl.executor - INFO - Using staging table: INSURANCE.ETL_MAPPER.XML_STAGING
2025-10-06 03:54:34 - etl.executor - INFO - Executing INSERT for SILVER.COVERAGE
2025-10-06 03:54:34 - etl.executor - ERROR - Insert failed for SILVER.COVERAGE: 001003 (42000): SQL compilation error:
syntax error line 2 at position 38 unexpected 'Session'.
syntax error line 2 at position 45 unexpected ':'.
2025-10-06 03:54:34 - etl.executor - ERROR - Full SQL: 
        INSERT INTO SILVER.COVERAGE (COVERAGE_NAME, COVERAGE_ID, RISK_ID, COVERAGE_CODE, COVERAGE_TYPE, COVERAGE_CATEGORY, COVERAGE_LIMIT, COVERAGE_DEDUCTIBLE, EFFECTIVE_DATE, EXPIRATION_DATE, COVERAGE_BASIS, IS_MANDATORY, COINSURANCE_PERCENTAGE, COVERAGE_PREMIUM)
        SELECT COALESCE(stg.xml_data::Session:Data:Coverages:Coverage:CoverageName::STRING, '') AS COVERAGE_NAME, COALESCE(stg.xml_data::Session:Data:Coverages:Coverage:CoverageID::STRING, '') AS COVERAGE_ID, COALESCE(stg.xml_data::Session:Data:Coverages:Coverage:RiskID::STRING, '') AS RISK_ID, COALESCE(stg.xml_data::Session:Data:Coverages:Coverage:CoverageCode::STRING, '') AS COVERAGE_CODE, COALESCE(stg.xml_data::Session:Data:Coverages:Coverage:CoverageType::STRING, '') AS COVERAGE_TYPE, COALESCE(stg.xml_data::Session:Data:Coverages:Coverage:CoverageCategory::STRING, '') AS COVERAGE_CATEGORY, COALESCE(stg.xml_data::Session:Data:Coverages:Coverage:Limit::STRING, '') AS COVERAGE_LIMIT, COALESCE(stg.xml_data::Session:Data:Coverages:Coverage:Deductible::STRING, '') AS COVERAGE_DEDUCTIBLE, COALESCE(stg.xml_data::Session:Data:Coverages:Coverage:EffectiveDate::STRING, '') AS EFFECTIVE_DATE, COALESCE(stg.xml_data::Session:Data:Coverages:Coverage:ExpirationDate::STRING, '') AS EXPIRATION_DATE, COALESCE(stg.xml_data::Session:Data:Coverages:Coverage:CoverageBasis::STRING, '') AS COVERAGE_BASIS, COALESCE(stg.xml_data::Session:Data:Coverages:Coverage:IsMandatory::STRING, '') AS IS_MANDATORY, COALESCE(stg.xml_data::Session:Data:Coverages:Coverage:CoinsurancePercent::STRING, '') AS COINSURANCE_PERCENTAGE, COALESCE(stg.xml_data::Session:Data:Coverages:Coverage:Premium::STRING, '') AS COVERAGE_PREMIUM
        FROM INSURANCE.ETL_MAPPER.XML_STAGING stg
        WHERE stg.xml_id = 'XML-20251006035025' AND stg.processed = FALSE
        
2025-10-06 03:54:34 - etl.executor - ERROR - ‚ùå Failed to process SILVER.COVERAGE: 001003 (42000): SQL compilation error:
syntax error line 2 at position 38 unexpected 'Session'.
syntax error line 2 at position 45 unexpected ':'.
2025-10-06 03:54:34 - etl.executor - ERROR - Traceback (most recent call last):
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 124, in execute_mappings
    rows_inserted = self._insert_to_silver(
        cursor, xml_id, table, table_mappings
    )
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 289, in _insert_to_silver
    cursor.execute(insert_sql)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/.venv/lib/python3.13/site-packages/snowflake/connector/cursor.py", line 1134, in execute
    Error.errorhandler_wrapper(self.connection, self, error_class, errvalue)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/.venv/lib/python3.13/site-packages/snowflake/connector/errors.py", line 286, in errorhandler_wrapper
    handed_over = Error.hand_to_other_handler(
        connection,
    ...<2 lines>...
        error_value,
    )
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/.venv/lib/python3.13/site-packages/snowflake/connector/errors.py", line 341, in hand_to_other_handler
    cursor.errorhandler(connection, cursor, error_class, error_value)
    ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/.venv/lib/python3.13/site-packages/snowflake/connector/errors.py", line 217, in default_errorhandler
    raise error_class(
    ...<10 lines>...
    )
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 2 at position 38 unexpected 'Session'.
syntax error line 2 at position 45 unexpected ':'.

2025-10-06 03:54:35 - etl.executor - INFO - Processing table: SILVER.RISK with 11 mappings
2025-10-06 03:54:35 - etl.executor - INFO - Found 1 rows in XML_STAGING, 0 already processed
2025-10-06 03:54:35 - etl.executor - INFO - Using staging table: INSURANCE.ETL_MAPPER.XML_STAGING
2025-10-06 03:54:35 - etl.executor - INFO - Executing INSERT for SILVER.RISK
2025-10-06 03:54:35 - etl.executor - ERROR - Insert failed for SILVER.RISK: 001003 (42000): SQL compilation error:
syntax error line 2 at position 38 unexpected 'Session'.
syntax error line 2 at position 45 unexpected ':'.
2025-10-06 03:54:35 - etl.executor - ERROR - Full SQL: 
        INSERT INTO SILVER.RISK (RISK_NUMBER, RISK_TYPE, RISK_DESCRIPTION, RISK_ADDRESS_LINE1, RISK_ADDRESS_LINE2, RISK_CITY, RISK_STATE, RISK_ZIP, PROPERTY_VALUE, RISK_COUNTRY, RISK_ID)
        SELECT COALESCE(stg.xml_data::Session:Data:Risks:Risk:RiskNumber::STRING, '') AS RISK_NUMBER, COALESCE(stg.xml_data::Session:Data:Risks:Risk:RiskType::STRING, '') AS RISK_TYPE, COALESCE(stg.xml_data::Session:Data:Risks:Risk:RiskDescription::STRING, '') AS RISK_DESCRIPTION, COALESCE(stg.xml_data::Session:Data:Risks:Risk:Location:AddressLine1::STRING, '') AS RISK_ADDRESS_LINE1, COALESCE(stg.xml_data::Session:Data:Risks:Risk:Location:AddressLine2::STRING, '') AS RISK_ADDRESS_LINE2, COALESCE(stg.xml_data::Session:Data:Risks:Risk:Location:City::STRING, '') AS RISK_CITY, COALESCE(stg.xml_data::Session:Data:Risks:Risk:Location:State::STRING, '') AS RISK_STATE, COALESCE(stg.xml_data::Session:Data:Risks:Risk:Location:ZipCode::STRING, '') AS RISK_ZIP, COALESCE(stg.xml_data::Session:Data:Risks:Risk:PropertyDetails:PropertyType::STRING, '') AS PROPERTY_VALUE, COALESCE(stg.xml_data::Session:Data:Risks:Risk:Location:Country::STRING, '') AS RISK_COUNTRY, COALESCE(stg.xml_data::Session:Data:Risks:Risk:RiskID::STRING, '') AS RISK_ID
        FROM INSURANCE.ETL_MAPPER.XML_STAGING stg
        WHERE stg.xml_id = 'XML-20251006035025' AND stg.processed = FALSE
        
2025-10-06 03:54:35 - etl.executor - ERROR - ‚ùå Failed to process SILVER.RISK: 001003 (42000): SQL compilation error:
syntax error line 2 at position 38 unexpected 'Session'.
syntax error line 2 at position 45 unexpected ':'.
2025-10-06 03:54:35 - etl.executor - ERROR - Traceback (most recent call last):
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 124, in execute_mappings
    rows_inserted = self._insert_to_silver(
        cursor, xml_id, table, table_mappings
    )
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 289, in _insert_to_silver
    cursor.execute(insert_sql)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/.venv/lib/python3.13/site-packages/snowflake/connector/cursor.py", line 1134, in execute
    Error.errorhandler_wrapper(self.connection, self, error_class, errvalue)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/.venv/lib/python3.13/site-packages/snowflake/connector/errors.py", line 286, in errorhandler_wrapper
    handed_over = Error.hand_to_other_handler(
        connection,
    ...<2 lines>...
        error_value,
    )
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/.venv/lib/python3.13/site-packages/snowflake/connector/errors.py", line 341, in hand_to_other_handler
    cursor.errorhandler(connection, cursor, error_class, error_value)
    ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/.venv/lib/python3.13/site-packages/snowflake/connector/errors.py", line 217, in default_errorhandler
    raise error_class(
    ...<10 lines>...
    )
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 2 at position 38 unexpected 'Session'.
syntax error line 2 at position 45 unexpected ':'.

2025-10-06 03:54:35 - etl.executor - INFO - Processing table: SILVER.PAYMENT with 16 mappings
2025-10-06 03:54:35 - etl.executor - INFO - Found 1 rows in XML_STAGING, 0 already processed
2025-10-06 03:54:35 - etl.executor - INFO - Using staging table: INSURANCE.ETL_MAPPER.XML_STAGING
2025-10-06 03:54:35 - etl.executor - INFO - Executing INSERT for SILVER.PAYMENT
2025-10-06 03:54:36 - etl.executor - ERROR - Insert failed for SILVER.PAYMENT: 001003 (42000): SQL compilation error:
syntax error line 2 at position 38 unexpected 'Session'.
syntax error line 2 at position 45 unexpected ':'.
2025-10-06 03:54:36 - etl.executor - ERROR - Full SQL: 
        INSERT INTO SILVER.PAYMENT (OUTSTANDING_AMOUNT, PAYMENT_STATUS, ROUTING_NUMBER, ACCOUNT_NUMBER, BANK_NAME, ACCOUNT_HOLDER_NAME, PAYMENT_DATE, PAYMENT_AMOUNT, TOTAL_INSTALLMENTS, PAYMENT_FREQUENCY, PAYMENT_TERM, CARD_TYPE, PAYMENT_METHOD, PAYMENT_TYPE, PAYMENT_NUMBER, PAYMENT_ID)
        SELECT COALESCE(stg.xml_data::Session:Data:Payment:OutstandingAmount::STRING, '') AS OUTSTANDING_AMOUNT, COALESCE(stg.xml_data::Session:Data:Payment:PaymentStatus::STRING, '') AS PAYMENT_STATUS, COALESCE(stg.xml_data::Session:Data:Payment:BankDetails:RoutingNumber::STRING, '') AS ROUTING_NUMBER, COALESCE(stg.xml_data::Session:Data:Payment:BankDetails:AccountNumber::STRING, '') AS ACCOUNT_NUMBER, COALESCE(stg.xml_data::Session:Data:Payment:BankDetails:BankName::STRING, '') AS BANK_NAME, COALESCE(stg.xml_data::Session:Data:Payment:BankDetails:AccountHolderName::STRING, '') AS ACCOUNT_HOLDER_NAME, COALESCE(stg.xml_data::Session:Data:Payment:FirstPaymentDate::STRING, '') AS PAYMENT_DATE, COALESCE(stg.xml_data::Session:Data:Payment:InstallmentAmount::STRING, '') AS PAYMENT_AMOUNT, COALESCE(stg.xml_data::Session:Data:Payment:TotalInstallments::STRING, '') AS TOTAL_INSTALLMENTS, COALESCE(stg.xml_data::Session:Data:Payment:PaymentFrequency::STRING, '') AS PAYMENT_FREQUENCY, COALESCE(stg.xml_data::Session:Data:Payment:PaymentTerm::STRING, '') AS PAYMENT_TERM, COALESCE(stg.xml_data::Session:Data:Payment:BankDetails:AccountType::STRING, '') AS CARD_TYPE, COALESCE(stg.xml_data::Session:Data:Payment:PaymentMethod::STRING, '') AS PAYMENT_METHOD, COALESCE(stg.xml_data::Session:Data:Payment:PaymentType::STRING, '') AS PAYMENT_TYPE, COALESCE(stg.xml_data::Session:Data:Payment:PaymentNumber::STRING, '') AS PAYMENT_NUMBER, COALESCE(stg.xml_data::Session:Data:Payment:PaymentID::STRING, '') AS PAYMENT_ID
        FROM INSURANCE.ETL_MAPPER.XML_STAGING stg
        WHERE stg.xml_id = 'XML-20251006035025' AND stg.processed = FALSE
        
2025-10-06 03:54:36 - etl.executor - ERROR - ‚ùå Failed to process SILVER.PAYMENT: 001003 (42000): SQL compilation error:
syntax error line 2 at position 38 unexpected 'Session'.
syntax error line 2 at position 45 unexpected ':'.
2025-10-06 03:54:36 - etl.executor - ERROR - Traceback (most recent call last):
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 124, in execute_mappings
    rows_inserted = self._insert_to_silver(
        cursor, xml_id, table, table_mappings
    )
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 289, in _insert_to_silver
    cursor.execute(insert_sql)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/.venv/lib/python3.13/site-packages/snowflake/connector/cursor.py", line 1134, in execute
    Error.errorhandler_wrapper(self.connection, self, error_class, errvalue)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/.venv/lib/python3.13/site-packages/snowflake/connector/errors.py", line 286, in errorhandler_wrapper
    handed_over = Error.hand_to_other_handler(
        connection,
    ...<2 lines>...
        error_value,
    )
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/.venv/lib/python3.13/site-packages/snowflake/connector/errors.py", line 341, in hand_to_other_handler
    cursor.errorhandler(connection, cursor, error_class, error_value)
    ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/.venv/lib/python3.13/site-packages/snowflake/connector/errors.py", line 217, in default_errorhandler
    raise error_class(
    ...<10 lines>...
    )
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 2 at position 38 unexpected 'Session'.
syntax error line 2 at position 45 unexpected ':'.

2025-10-06 03:55:01 - loaders.snowflake_loader - INFO - ‚úÖ Connected to Snowflake: INSURANCE.ETL_MAPPER with role ACCOUNTADMIN
2025-10-06 03:55:04 - etl.executor - INFO - ‚úÖ Required tables ensured
2025-10-06 03:55:06 - utils.database_helper - INFO - Loaded 333 approved mappings
2025-10-06 03:55:23 - loaders.snowflake_loader - INFO - ‚úÖ Connected to Snowflake: INSURANCE.ETL_MAPPER with role ACCOUNTADMIN
2025-10-06 03:55:24 - etl.executor - INFO - ‚úÖ Required tables ensured
2025-10-06 03:55:30 - utils.database_helper - INFO - Loaded 333 approved mappings
2025-10-06 03:55:30 - etl.executor - INFO - Processing 5 tables for xml_id: XML-20251006012843
2025-10-06 03:55:30 - etl.executor - INFO - Processing table: SILVER.POLICY with 40 mappings
2025-10-06 03:55:30 - etl.executor - ERROR - ‚ùå Failed to process SILVER.POLICY: No staging data found for xml_id: XML-20251006012843
2025-10-06 03:55:30 - etl.executor - ERROR - Traceback (most recent call last):
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 124, in execute_mappings
    rows_inserted = self._insert_to_silver(
        cursor, xml_id, table, table_mappings
    )
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 219, in _insert_to_silver
    staging_table, has_processed_flag = self._get_staging_data_info(cursor, xml_id)
                                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 212, in _get_staging_data_info
    raise Exception(f"No staging data found for xml_id: {xml_id}")
Exception: No staging data found for xml_id: XML-20251006012843

2025-10-06 03:55:31 - etl.executor - INFO - Processing table: SILVER.QUOTE with 20 mappings
2025-10-06 03:55:31 - etl.executor - ERROR - ‚ùå Failed to process SILVER.QUOTE: No staging data found for xml_id: XML-20251006012843
2025-10-06 03:55:31 - etl.executor - ERROR - Traceback (most recent call last):
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 124, in execute_mappings
    rows_inserted = self._insert_to_silver(
        cursor, xml_id, table, table_mappings
    )
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 219, in _insert_to_silver
    staging_table, has_processed_flag = self._get_staging_data_info(cursor, xml_id)
                                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 212, in _get_staging_data_info
    raise Exception(f"No staging data found for xml_id: {xml_id}")
Exception: No staging data found for xml_id: XML-20251006012843

2025-10-06 03:55:32 - etl.executor - INFO - Processing table: SILVER.COVERAGE with 14 mappings
2025-10-06 03:55:32 - etl.executor - ERROR - ‚ùå Failed to process SILVER.COVERAGE: No staging data found for xml_id: XML-20251006012843
2025-10-06 03:55:32 - etl.executor - ERROR - Traceback (most recent call last):
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 124, in execute_mappings
    rows_inserted = self._insert_to_silver(
        cursor, xml_id, table, table_mappings
    )
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 219, in _insert_to_silver
    staging_table, has_processed_flag = self._get_staging_data_info(cursor, xml_id)
                                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 212, in _get_staging_data_info
    raise Exception(f"No staging data found for xml_id: {xml_id}")
Exception: No staging data found for xml_id: XML-20251006012843

2025-10-06 03:55:33 - etl.executor - INFO - Processing table: SILVER.PAYMENT with 16 mappings
2025-10-06 03:55:33 - etl.executor - ERROR - ‚ùå Failed to process SILVER.PAYMENT: No staging data found for xml_id: XML-20251006012843
2025-10-06 03:55:33 - etl.executor - ERROR - Traceback (most recent call last):
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 124, in execute_mappings
    rows_inserted = self._insert_to_silver(
        cursor, xml_id, table, table_mappings
    )
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 219, in _insert_to_silver
    staging_table, has_processed_flag = self._get_staging_data_info(cursor, xml_id)
                                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 212, in _get_staging_data_info
    raise Exception(f"No staging data found for xml_id: {xml_id}")
Exception: No staging data found for xml_id: XML-20251006012843

2025-10-06 03:55:34 - etl.executor - INFO - Processing table: SILVER.RISK with 11 mappings
2025-10-06 03:55:34 - etl.executor - ERROR - ‚ùå Failed to process SILVER.RISK: No staging data found for xml_id: XML-20251006012843
2025-10-06 03:55:34 - etl.executor - ERROR - Traceback (most recent call last):
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 124, in execute_mappings
    rows_inserted = self._insert_to_silver(
        cursor, xml_id, table, table_mappings
    )
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 219, in _insert_to_silver
    staging_table, has_processed_flag = self._get_staging_data_info(cursor, xml_id)
                                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^
  File "/Users/aashishsoni/codeNtest/MappingSheetGen/etl/executor.py", line 212, in _get_staging_data_info
    raise Exception(f"No staging data found for xml_id: {xml_id}")
Exception: No staging data found for xml_id: XML-20251006012843

